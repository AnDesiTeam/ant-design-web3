"use strict";(self.webpackChunk_ant_design_web3_docs=self.webpackChunk_ant_design_web3_docs||[]).push([[6532],{36532:function(b,c,_){var d;d={value:!0},c.SafeAppProvider=void 0;var L=_(21650);Object.defineProperty(c,"SafeAppProvider",{enumerable:!0,get:function(){return L.SafeAppProvider}})},21650:function(b,c,_){Object.defineProperty(c,"__esModule",{value:!0}),c.SafeAppProvider=void 0;const d=_(72100),L=_(62332);class C extends d.EventEmitter{constructor(v,l){super(),this.submittedTxs=new Map,this.safe=v,this.sdk=l}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(v){const{method:l,params:i=[]}=v;switch(l){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return`0x${this.chainId.toString(16)}`;case"personal_sign":{const[f,h]=i;if(this.safe.safeAddress.toLowerCase()!==h.toLowerCase())throw new Error("The address or message hash is invalid");const y=await this.sdk.txs.signMessage(f);return("signature"in y?y.signature:void 0)||"0x"}case"eth_sign":{const[f,h]=i;if(this.safe.safeAddress.toLowerCase()!==f.toLowerCase()||!h.startsWith("0x"))throw new Error("The address or message hash is invalid");const y=await this.sdk.txs.signMessage(h);return("signature"in y?y.signature:void 0)||"0x"}case"eth_signTypedData":case"eth_signTypedData_v4":{const[f,h]=i,y=typeof h=="string"?JSON.parse(h):h;if(this.safe.safeAddress.toLowerCase()!==f.toLowerCase())throw new Error("The address is invalid");const w=await this.sdk.txs.signTypedMessage(y);return("signature"in w?w.signature:void 0)||"0x"}case"eth_sendTransaction":const p=Object.assign(Object.assign({},i[0]),{value:i[0].value||"0",data:i[0].data||"0x"});typeof p.gas=="string"&&p.gas.startsWith("0x")&&(p.gas=parseInt(p.gas,16));const x=await this.sdk.txs.send({txs:[p],params:{safeTxGas:p.gas}});return this.submittedTxs.set(x.safeTxHash,{from:this.safe.safeAddress,hash:x.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:p.data,value:p.value,to:p.to,blockHash:null,blockNumber:null,transactionIndex:null}),x.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,L.getLowerCase)(i[0]),i[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,L.getLowerCase)(i[0]),i[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,L.getLowerCase)(i[0]),i[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,L.getLowerCase)(i[0]),i[1],i[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([i[0],i[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([i[0],i[1]]);case"eth_getTransactionByHash":let m=i[0];try{m=(await this.sdk.txs.getBySafeTxHash(m)).txHash||m}catch{}return this.submittedTxs.has(m)?this.submittedTxs.get(m):this.sdk.eth.getTransactionByHash([m]).then(f=>(f&&(f.hash=i[0]),f));case"eth_getTransactionReceipt":{let f=i[0];try{f=(await this.sdk.txs.getBySafeTxHash(f)).txHash||f}catch{}return this.sdk.eth.getTransactionReceipt([f]).then(h=>(h&&(h.transactionHash=i[0]),h))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(i[0]);case"eth_call":return this.sdk.eth.call([i[0],i[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([i[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();case"wallet_getPermissions":return this.sdk.wallet.getPermissions();case"wallet_requestPermissions":return this.sdk.wallet.requestPermissions(i[0]);case"safe_setSettings":return this.sdk.eth.setSafeSettings([i[0]]);default:throw Error(`"${v.method}" not implemented`)}}send(v,l){v||l("Undefined request"),this.request(v).then(i=>l(null,{jsonrpc:"2.0",id:v.id,result:i})).catch(i=>l(i,null))}}c.SafeAppProvider=C},62332:function(b,c){Object.defineProperty(c,"__esModule",{value:!0}),c.getLowerCase=void 0;function _(d){return d&&d.toLowerCase()}c.getLowerCase=_},72100:function(b){var c=typeof Reflect=="object"?Reflect:null,_=c&&typeof c.apply=="function"?c.apply:function(e,n,s){return Function.prototype.apply.call(e,n,s)},d;c&&typeof c.ownKeys=="function"?d=c.ownKeys:Object.getOwnPropertySymbols?d=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:d=function(e){return Object.getOwnPropertyNames(e)};function L(t){console&&console.warn&&console.warn(t)}var C=Number.isNaN||function(e){return e!==e};function a(){a.init.call(this)}b.exports=a,b.exports.once=T,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var v=10;function l(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return v},set:function(t){if(typeof t!="number"||t<0||C(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");v=t}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||C(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function i(t){return t._maxListeners===void 0?a.defaultMaxListeners:t._maxListeners}a.prototype.getMaxListeners=function(){return i(this)},a.prototype.emit=function(e){for(var n=[],s=1;s<arguments.length;s++)n.push(arguments[s]);var r=e==="error",u=this._events;if(u!==void 0)r=r&&u.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var g=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw g.context=o,g}var k=u[e];if(k===void 0)return!1;if(typeof k=="function")_(k,this,n);else for(var P=k.length,j=h(k,P),s=0;s<P;++s)_(j[s],this,n);return!0};function p(t,e,n,s){var r,u,o;if(l(n),u=t._events,u===void 0?(u=t._events=Object.create(null),t._eventsCount=0):(u.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),u=t._events),o=u[e]),o===void 0)o=u[e]=n,++t._eventsCount;else if(typeof o=="function"?o=u[e]=s?[n,o]:[o,n]:s?o.unshift(n):o.push(n),r=i(t),r>0&&o.length>r&&!o.warned){o.warned=!0;var g=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");g.name="MaxListenersExceededWarning",g.emitter=t,g.type=e,g.count=o.length,L(g)}return t}a.prototype.addListener=function(e,n){return p(this,e,n,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,n){return p(this,e,n,!0)};function x(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(t,e,n){var s={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=x.bind(s);return r.listener=n,s.wrapFn=r,r}a.prototype.once=function(e,n){return l(n),this.on(e,E(this,e,n)),this},a.prototype.prependOnceListener=function(e,n){return l(n),this.prependListener(e,E(this,e,n)),this},a.prototype.removeListener=function(e,n){var s,r,u,o,g;if(l(n),r=this._events,r===void 0)return this;if(s=r[e],s===void 0)return this;if(s===n||s.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,s.listener||n));else if(typeof s!="function"){for(u=-1,o=s.length-1;o>=0;o--)if(s[o]===n||s[o].listener===n){g=s[o].listener,u=o;break}if(u<0)return this;u===0?s.shift():y(s,u),s.length===1&&(r[e]=s[0]),r.removeListener!==void 0&&this.emit("removeListener",e,g||n)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var n,s,r;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var u=Object.keys(s),o;for(r=0;r<u.length;++r)o=u[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=s[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function m(t,e,n){var s=t._events;if(s===void 0)return[];var r=s[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?w(r):h(r,r.length)}a.prototype.listeners=function(e){return m(this,e,!0)},a.prototype.rawListeners=function(e){return m(this,e,!1)},a.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):f.call(t,e)},a.prototype.listenerCount=f;function f(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]};function h(t,e){for(var n=new Array(e),s=0;s<e;++s)n[s]=t[s];return n}function y(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function w(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function T(t,e){return new Promise(function(n,s){function r(o){t.removeListener(e,u),s(o)}function u(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}O(t,e,u,{once:!0}),e!=="error"&&A(t,r,{once:!0})})}function A(t,e,n){typeof t.on=="function"&&O(t,"error",e,n)}function O(t,e,n,s){if(typeof t.on=="function")s.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(u){s.once&&t.removeEventListener(e,r),n(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}}}]);
