(self.webpackChunk_ant_design_web3_docs=self.webpackChunk_ant_design_web3_docs||[]).push([[3664],{61326:function(Qt,ne,ie){"use strict";var Q;Q={value:!0},Q=Q=Q=ne.Xx=Q=Q=ne._w=ne.aP=ne.KS=Q=ne.jQ=void 0;const me=ie(54889),Ee=ie(21318),pt=ie(49644);ne.jQ=64,Q=32,ne.KS=64,ne.aP=32;function H(N){const q=new Float64Array(16);if(N)for(let O=0;O<N.length;O++)q[O]=N[O];return q}const _e=new Uint8Array(32);_e[0]=9;const Ne=H(),ae=H([1]),oe=H([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),te=H([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),je=H([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),se=H([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),xe=H([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ee(N,q){for(let O=0;O<16;O++)N[O]=q[O]|0}function We(N){let q=1;for(let O=0;O<16;O++){let l=N[O]+q+65535;q=Math.floor(l/65536),N[O]=l-q*65536}N[0]+=q-1+37*(q-1)}function Tt(N,q,O){const l=~(O-1);for(let E=0;E<16;E++){const fe=l&(N[E]^q[E]);N[E]^=fe,q[E]^=fe}}function at(N,q){const O=H(),l=H();for(let E=0;E<16;E++)l[E]=q[E];We(l),We(l),We(l);for(let E=0;E<2;E++){O[0]=l[0]-65517;for(let Se=1;Se<15;Se++)O[Se]=l[Se]-65535-(O[Se-1]>>16&1),O[Se-1]&=65535;O[15]=l[15]-32767-(O[14]>>16&1);const fe=O[15]>>16&1;O[14]&=65535,Tt(l,O,1-fe)}for(let E=0;E<16;E++)N[2*E]=l[E]&255,N[2*E+1]=l[E]>>8}function ct(N,q){let O=0;for(let l=0;l<32;l++)O|=N[l]^q[l];return(1&O-1>>>8)-1}function Zt(N,q){const O=new Uint8Array(32),l=new Uint8Array(32);return at(O,N),at(l,q),ct(O,l)}function sr(N){const q=new Uint8Array(32);return at(q,N),q[0]&1}function Or(N,q){for(let O=0;O<16;O++)N[O]=q[2*O]+(q[2*O+1]<<8);N[15]&=32767}function Ae(N,q,O){for(let l=0;l<16;l++)N[l]=q[l]+O[l]}function j(N,q,O){for(let l=0;l<16;l++)N[l]=q[l]-O[l]}function V(N,q,O){let l,E,fe=0,Se=0,Ke=0,Ge=0,Fe=0,Ze=0,Nt=0,er=0,Vt=0,Ft=0,_t=0,ht=0,et=0,lt=0,st=0,nt=0,Et=0,Gt=0,tr=0,nr=0,Z=0,xt=0,Ar=0,Dr=0,ur=0,Br=0,vr=0,Hr=0,Zi=0,ai=0,Xi=0,qt=O[0],It=O[1],Pt=O[2],Lt=O[3],Mt=O[4],kt=O[5],jt=O[6],zt=O[7],St=O[8],$t=O[9],Ut=O[10],Rt=O[11],dt=O[12],gt=O[13],yt=O[14],Bt=O[15];l=q[0],fe+=l*qt,Se+=l*It,Ke+=l*Pt,Ge+=l*Lt,Fe+=l*Mt,Ze+=l*kt,Nt+=l*jt,er+=l*zt,Vt+=l*St,Ft+=l*$t,_t+=l*Ut,ht+=l*Rt,et+=l*dt,lt+=l*gt,st+=l*yt,nt+=l*Bt,l=q[1],Se+=l*qt,Ke+=l*It,Ge+=l*Pt,Fe+=l*Lt,Ze+=l*Mt,Nt+=l*kt,er+=l*jt,Vt+=l*zt,Ft+=l*St,_t+=l*$t,ht+=l*Ut,et+=l*Rt,lt+=l*dt,st+=l*gt,nt+=l*yt,Et+=l*Bt,l=q[2],Ke+=l*qt,Ge+=l*It,Fe+=l*Pt,Ze+=l*Lt,Nt+=l*Mt,er+=l*kt,Vt+=l*jt,Ft+=l*zt,_t+=l*St,ht+=l*$t,et+=l*Ut,lt+=l*Rt,st+=l*dt,nt+=l*gt,Et+=l*yt,Gt+=l*Bt,l=q[3],Ge+=l*qt,Fe+=l*It,Ze+=l*Pt,Nt+=l*Lt,er+=l*Mt,Vt+=l*kt,Ft+=l*jt,_t+=l*zt,ht+=l*St,et+=l*$t,lt+=l*Ut,st+=l*Rt,nt+=l*dt,Et+=l*gt,Gt+=l*yt,tr+=l*Bt,l=q[4],Fe+=l*qt,Ze+=l*It,Nt+=l*Pt,er+=l*Lt,Vt+=l*Mt,Ft+=l*kt,_t+=l*jt,ht+=l*zt,et+=l*St,lt+=l*$t,st+=l*Ut,nt+=l*Rt,Et+=l*dt,Gt+=l*gt,tr+=l*yt,nr+=l*Bt,l=q[5],Ze+=l*qt,Nt+=l*It,er+=l*Pt,Vt+=l*Lt,Ft+=l*Mt,_t+=l*kt,ht+=l*jt,et+=l*zt,lt+=l*St,st+=l*$t,nt+=l*Ut,Et+=l*Rt,Gt+=l*dt,tr+=l*gt,nr+=l*yt,Z+=l*Bt,l=q[6],Nt+=l*qt,er+=l*It,Vt+=l*Pt,Ft+=l*Lt,_t+=l*Mt,ht+=l*kt,et+=l*jt,lt+=l*zt,st+=l*St,nt+=l*$t,Et+=l*Ut,Gt+=l*Rt,tr+=l*dt,nr+=l*gt,Z+=l*yt,xt+=l*Bt,l=q[7],er+=l*qt,Vt+=l*It,Ft+=l*Pt,_t+=l*Lt,ht+=l*Mt,et+=l*kt,lt+=l*jt,st+=l*zt,nt+=l*St,Et+=l*$t,Gt+=l*Ut,tr+=l*Rt,nr+=l*dt,Z+=l*gt,xt+=l*yt,Ar+=l*Bt,l=q[8],Vt+=l*qt,Ft+=l*It,_t+=l*Pt,ht+=l*Lt,et+=l*Mt,lt+=l*kt,st+=l*jt,nt+=l*zt,Et+=l*St,Gt+=l*$t,tr+=l*Ut,nr+=l*Rt,Z+=l*dt,xt+=l*gt,Ar+=l*yt,Dr+=l*Bt,l=q[9],Ft+=l*qt,_t+=l*It,ht+=l*Pt,et+=l*Lt,lt+=l*Mt,st+=l*kt,nt+=l*jt,Et+=l*zt,Gt+=l*St,tr+=l*$t,nr+=l*Ut,Z+=l*Rt,xt+=l*dt,Ar+=l*gt,Dr+=l*yt,ur+=l*Bt,l=q[10],_t+=l*qt,ht+=l*It,et+=l*Pt,lt+=l*Lt,st+=l*Mt,nt+=l*kt,Et+=l*jt,Gt+=l*zt,tr+=l*St,nr+=l*$t,Z+=l*Ut,xt+=l*Rt,Ar+=l*dt,Dr+=l*gt,ur+=l*yt,Br+=l*Bt,l=q[11],ht+=l*qt,et+=l*It,lt+=l*Pt,st+=l*Lt,nt+=l*Mt,Et+=l*kt,Gt+=l*jt,tr+=l*zt,nr+=l*St,Z+=l*$t,xt+=l*Ut,Ar+=l*Rt,Dr+=l*dt,ur+=l*gt,Br+=l*yt,vr+=l*Bt,l=q[12],et+=l*qt,lt+=l*It,st+=l*Pt,nt+=l*Lt,Et+=l*Mt,Gt+=l*kt,tr+=l*jt,nr+=l*zt,Z+=l*St,xt+=l*$t,Ar+=l*Ut,Dr+=l*Rt,ur+=l*dt,Br+=l*gt,vr+=l*yt,Hr+=l*Bt,l=q[13],lt+=l*qt,st+=l*It,nt+=l*Pt,Et+=l*Lt,Gt+=l*Mt,tr+=l*kt,nr+=l*jt,Z+=l*zt,xt+=l*St,Ar+=l*$t,Dr+=l*Ut,ur+=l*Rt,Br+=l*dt,vr+=l*gt,Hr+=l*yt,Zi+=l*Bt,l=q[14],st+=l*qt,nt+=l*It,Et+=l*Pt,Gt+=l*Lt,tr+=l*Mt,nr+=l*kt,Z+=l*jt,xt+=l*zt,Ar+=l*St,Dr+=l*$t,ur+=l*Ut,Br+=l*Rt,vr+=l*dt,Hr+=l*gt,Zi+=l*yt,ai+=l*Bt,l=q[15],nt+=l*qt,Et+=l*It,Gt+=l*Pt,tr+=l*Lt,nr+=l*Mt,Z+=l*kt,xt+=l*jt,Ar+=l*zt,Dr+=l*St,ur+=l*$t,Br+=l*Ut,vr+=l*Rt,Hr+=l*dt,Zi+=l*gt,ai+=l*yt,Xi+=l*Bt,fe+=38*Et,Se+=38*Gt,Ke+=38*tr,Ge+=38*nr,Fe+=38*Z,Ze+=38*xt,Nt+=38*Ar,er+=38*Dr,Vt+=38*ur,Ft+=38*Br,_t+=38*vr,ht+=38*Hr,et+=38*Zi,lt+=38*ai,st+=38*Xi,E=1,l=fe+E+65535,E=Math.floor(l/65536),fe=l-E*65536,l=Se+E+65535,E=Math.floor(l/65536),Se=l-E*65536,l=Ke+E+65535,E=Math.floor(l/65536),Ke=l-E*65536,l=Ge+E+65535,E=Math.floor(l/65536),Ge=l-E*65536,l=Fe+E+65535,E=Math.floor(l/65536),Fe=l-E*65536,l=Ze+E+65535,E=Math.floor(l/65536),Ze=l-E*65536,l=Nt+E+65535,E=Math.floor(l/65536),Nt=l-E*65536,l=er+E+65535,E=Math.floor(l/65536),er=l-E*65536,l=Vt+E+65535,E=Math.floor(l/65536),Vt=l-E*65536,l=Ft+E+65535,E=Math.floor(l/65536),Ft=l-E*65536,l=_t+E+65535,E=Math.floor(l/65536),_t=l-E*65536,l=ht+E+65535,E=Math.floor(l/65536),ht=l-E*65536,l=et+E+65535,E=Math.floor(l/65536),et=l-E*65536,l=lt+E+65535,E=Math.floor(l/65536),lt=l-E*65536,l=st+E+65535,E=Math.floor(l/65536),st=l-E*65536,l=nt+E+65535,E=Math.floor(l/65536),nt=l-E*65536,fe+=E-1+37*(E-1),E=1,l=fe+E+65535,E=Math.floor(l/65536),fe=l-E*65536,l=Se+E+65535,E=Math.floor(l/65536),Se=l-E*65536,l=Ke+E+65535,E=Math.floor(l/65536),Ke=l-E*65536,l=Ge+E+65535,E=Math.floor(l/65536),Ge=l-E*65536,l=Fe+E+65535,E=Math.floor(l/65536),Fe=l-E*65536,l=Ze+E+65535,E=Math.floor(l/65536),Ze=l-E*65536,l=Nt+E+65535,E=Math.floor(l/65536),Nt=l-E*65536,l=er+E+65535,E=Math.floor(l/65536),er=l-E*65536,l=Vt+E+65535,E=Math.floor(l/65536),Vt=l-E*65536,l=Ft+E+65535,E=Math.floor(l/65536),Ft=l-E*65536,l=_t+E+65535,E=Math.floor(l/65536),_t=l-E*65536,l=ht+E+65535,E=Math.floor(l/65536),ht=l-E*65536,l=et+E+65535,E=Math.floor(l/65536),et=l-E*65536,l=lt+E+65535,E=Math.floor(l/65536),lt=l-E*65536,l=st+E+65535,E=Math.floor(l/65536),st=l-E*65536,l=nt+E+65535,E=Math.floor(l/65536),nt=l-E*65536,fe+=E-1+37*(E-1),N[0]=fe,N[1]=Se,N[2]=Ke,N[3]=Ge,N[4]=Fe,N[5]=Ze,N[6]=Nt,N[7]=er,N[8]=Vt,N[9]=Ft,N[10]=_t,N[11]=ht,N[12]=et,N[13]=lt,N[14]=st,N[15]=nt}function he(N,q){V(N,q,q)}function pe(N,q){const O=H();let l;for(l=0;l<16;l++)O[l]=q[l];for(l=253;l>=0;l--)he(O,O),l!==2&&l!==4&&V(O,O,q);for(l=0;l<16;l++)N[l]=O[l]}function we(N,q){const O=H();let l;for(l=0;l<16;l++)O[l]=q[l];for(l=250;l>=0;l--)he(O,O),l!==1&&V(O,O,q);for(l=0;l<16;l++)N[l]=O[l]}function Te(N,q){const O=H(),l=H(),E=H(),fe=H(),Se=H(),Ke=H(),Ge=H(),Fe=H(),Ze=H();j(O,N[1],N[0]),j(Ze,q[1],q[0]),V(O,O,Ze),Ae(l,N[0],N[1]),Ae(Ze,q[0],q[1]),V(l,l,Ze),V(E,N[3],q[3]),V(E,E,te),V(fe,N[2],q[2]),Ae(fe,fe,fe),j(Se,l,O),j(Ke,fe,E),Ae(Ge,fe,E),Ae(Fe,l,O),V(N[0],Se,Ke),V(N[1],Fe,Ge),V(N[2],Ge,Ke),V(N[3],Se,Fe)}function R(N,q,O){for(let l=0;l<4;l++)Tt(N[l],q[l],O)}function x(N,q){const O=H(),l=H(),E=H();pe(E,q[2]),V(O,q[0],E),V(l,q[1],E),at(N,l),N[31]^=sr(O)<<7}function P(N,q,O){ee(N[0],Ne),ee(N[1],ae),ee(N[2],ae),ee(N[3],Ne);for(let l=255;l>=0;--l){const E=O[l/8|0]>>(l&7)&1;R(N,q,E),Te(q,N),Te(N,N),R(N,q,E)}}function le(N,q){const O=[H(),H(),H(),H()];ee(O[0],je),ee(O[1],se),ee(O[2],ae),V(O[3],je,se),P(N,O,q)}function Re(N){if(N.length!==ne.aP)throw new Error(`ed25519: seed must be ${ne.aP} bytes`);const q=(0,Ee.hash)(N);q[0]&=248,q[31]&=127,q[31]|=64;const O=new Uint8Array(32),l=[H(),H(),H(),H()];le(l,q),x(O,l);const E=new Uint8Array(64);return E.set(N),E.set(O,32),{publicKey:O,secretKey:E}}ne._w=Re;function z(N){const q=(0,me.randomBytes)(32,N),O=Re(q);return(0,pt.wipe)(q),O}Q=z;function Y(N){if(N.length!==ne.KS)throw new Error(`ed25519: secret key must be ${ne.KS} bytes`);return new Uint8Array(N.subarray(32))}Q=Y;const G=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function K(N,q){let O,l,E,fe;for(l=63;l>=32;--l){for(O=0,E=l-32,fe=l-12;E<fe;++E)q[E]+=O-16*q[l]*G[E-(l-32)],O=Math.floor((q[E]+128)/256),q[E]-=O*256;q[E]+=O,q[l]=0}for(O=0,E=0;E<32;E++)q[E]+=O-(q[31]>>4)*G[E],O=q[E]>>8,q[E]&=255;for(E=0;E<32;E++)q[E]-=O*G[E];for(l=0;l<32;l++)q[l+1]+=q[l]>>8,N[l]=q[l]&255}function Qe(N){const q=new Float64Array(64);for(let O=0;O<64;O++)q[O]=N[O];for(let O=0;O<64;O++)N[O]=0;K(N,q)}function ut(N,q){const O=new Float64Array(64),l=[H(),H(),H(),H()],E=(0,Ee.hash)(N.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const fe=new Uint8Array(64);fe.set(E.subarray(32),32);const Se=new Ee.SHA512;Se.update(fe.subarray(32)),Se.update(q);const Ke=Se.digest();Se.clean(),Qe(Ke),le(l,Ke),x(fe,l),Se.reset(),Se.update(fe.subarray(0,32)),Se.update(N.subarray(32)),Se.update(q);const Ge=Se.digest();Qe(Ge);for(let Fe=0;Fe<32;Fe++)O[Fe]=Ke[Fe];for(let Fe=0;Fe<32;Fe++)for(let Ze=0;Ze<32;Ze++)O[Fe+Ze]+=Ge[Fe]*E[Ze];return K(fe.subarray(32),O),fe}ne.Xx=ut;function Zr(N,q){const O=H(),l=H(),E=H(),fe=H(),Se=H(),Ke=H(),Ge=H();return ee(N[2],ae),Or(N[1],q),he(E,N[1]),V(fe,E,oe),j(E,E,N[2]),Ae(fe,N[2],fe),he(Se,fe),he(Ke,Se),V(Ge,Ke,Se),V(O,Ge,E),V(O,O,fe),we(O,O),V(O,O,E),V(O,O,fe),V(O,O,fe),V(N[0],O,fe),he(l,N[0]),V(l,l,fe),Zt(l,E)&&V(N[0],N[0],xe),he(l,N[0]),V(l,l,fe),Zt(l,E)?-1:(sr(N[0])===q[31]>>7&&j(N[0],Ne,N[0]),V(N[3],N[0],N[1]),0)}function qi(N,q,O){const l=new Uint8Array(32),E=[H(),H(),H(),H()],fe=[H(),H(),H(),H()];if(O.length!==ne.jQ)throw new Error(`ed25519: signature must be ${ne.jQ} bytes`);if(Zr(fe,N))return!1;const Se=new Ee.SHA512;Se.update(O.subarray(0,32)),Se.update(N),Se.update(q);const Ke=Se.digest();return Qe(Ke),P(E,fe,Ke),le(fe,O.subarray(32)),Te(E,fe),x(l,E),!ct(O,l)}Q=qi;function Li(N){let q=[H(),H(),H(),H()];if(Zr(q,N))throw new Error("Ed25519: invalid public key");let O=H(),l=H(),E=q[1];Ae(O,ae,E),j(l,ae,E),pe(l,l),V(O,O,l);let fe=new Uint8Array(32);return at(fe,O),fe}Q=Li;function Xt(N){const q=(0,Ee.hash)(N.subarray(0,32));q[0]&=248,q[31]&=127,q[31]|=64;const O=new Uint8Array(q.subarray(0,32));return(0,pt.wipe)(q),O}Q=Xt},21318:function(Qt,ne,ie){"use strict";Object.defineProperty(ne,"__esModule",{value:!0});var Q=ie(6050),me=ie(49644);ne.DIGEST_LENGTH=64,ne.BLOCK_SIZE=128;var Ee=function(){function Ne(){this.digestLength=ne.DIGEST_LENGTH,this.blockSize=ne.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return Ne.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},Ne.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},Ne.prototype.clean=function(){me.wipe(this._buffer),me.wipe(this._tempHi),me.wipe(this._tempLo),this.reset()},Ne.prototype.update=function(ae,oe){if(oe===void 0&&(oe=ae.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var te=0;if(this._bytesHashed+=oe,this._bufferLength>0){for(;this._bufferLength<ne.BLOCK_SIZE&&oe>0;)this._buffer[this._bufferLength++]=ae[te++],oe--;this._bufferLength===this.blockSize&&(H(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(oe>=this.blockSize&&(te=H(this._tempHi,this._tempLo,this._stateHi,this._stateLo,ae,te,oe),oe%=this.blockSize);oe>0;)this._buffer[this._bufferLength++]=ae[te++],oe--;return this},Ne.prototype.finish=function(ae){if(!this._finished){var oe=this._bytesHashed,te=this._bufferLength,je=oe/536870912|0,se=oe<<3,xe=oe%128<112?128:256;this._buffer[te]=128;for(var ee=te+1;ee<xe-8;ee++)this._buffer[ee]=0;Q.writeUint32BE(je,this._buffer,xe-8),Q.writeUint32BE(se,this._buffer,xe-4),H(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,xe),this._finished=!0}for(var ee=0;ee<this.digestLength/8;ee++)Q.writeUint32BE(this._stateHi[ee],ae,ee*8),Q.writeUint32BE(this._stateLo[ee],ae,ee*8+4);return this},Ne.prototype.digest=function(){var ae=new Uint8Array(this.digestLength);return this.finish(ae),ae},Ne.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},Ne.prototype.restoreState=function(ae){return this._stateHi.set(ae.stateHi),this._stateLo.set(ae.stateLo),this._bufferLength=ae.bufferLength,ae.buffer&&this._buffer.set(ae.buffer),this._bytesHashed=ae.bytesHashed,this._finished=!1,this},Ne.prototype.cleanSavedState=function(ae){me.wipe(ae.stateHi),me.wipe(ae.stateLo),ae.buffer&&me.wipe(ae.buffer),ae.bufferLength=0,ae.bytesHashed=0},Ne}();ne.SHA512=Ee;var pt=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function H(Ne,ae,oe,te,je,se,xe){for(var ee=oe[0],We=oe[1],Tt=oe[2],at=oe[3],ct=oe[4],Zt=oe[5],sr=oe[6],Or=oe[7],Ae=te[0],j=te[1],V=te[2],he=te[3],pe=te[4],we=te[5],Te=te[6],R=te[7],x,P,le,Re,z,Y,G,K;xe>=128;){for(var Qe=0;Qe<16;Qe++){var ut=8*Qe+se;Ne[Qe]=Q.readUint32BE(je,ut),ae[Qe]=Q.readUint32BE(je,ut+4)}for(var Qe=0;Qe<80;Qe++){var Zr=ee,qi=We,Li=Tt,Xt=at,N=ct,q=Zt,O=sr,l=Or,E=Ae,fe=j,Se=V,Ke=he,Ge=pe,Fe=we,Ze=Te,Nt=R;if(x=Or,P=R,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=(ct>>>14|pe<<32-14)^(ct>>>18|pe<<32-18)^(pe>>>41-32|ct<<32-(41-32)),P=(pe>>>14|ct<<32-14)^(pe>>>18|ct<<32-18)^(ct>>>41-32|pe<<32-(41-32)),z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,x=ct&Zt^~ct&sr,P=pe&we^~pe&Te,z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,x=pt[Qe*2],P=pt[Qe*2+1],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,x=Ne[Qe%16],P=ae[Qe%16],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,le=G&65535|K<<16,Re=z&65535|Y<<16,x=le,P=Re,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=(ee>>>28|Ae<<32-28)^(Ae>>>34-32|ee<<32-(34-32))^(Ae>>>39-32|ee<<32-(39-32)),P=(Ae>>>28|ee<<32-28)^(ee>>>34-32|Ae<<32-(34-32))^(ee>>>39-32|Ae<<32-(39-32)),z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,x=ee&We^ee&Tt^We&Tt,P=Ae&j^Ae&V^j&V,z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,l=G&65535|K<<16,Nt=z&65535|Y<<16,x=Xt,P=Ke,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=le,P=Re,z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,Xt=G&65535|K<<16,Ke=z&65535|Y<<16,We=Zr,Tt=qi,at=Li,ct=Xt,Zt=N,sr=q,Or=O,ee=l,j=E,V=fe,he=Se,pe=Ke,we=Ge,Te=Fe,R=Ze,Ae=Nt,Qe%16===15)for(var ut=0;ut<16;ut++)x=Ne[ut],P=ae[ut],z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=Ne[(ut+9)%16],P=ae[(ut+9)%16],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,le=Ne[(ut+1)%16],Re=ae[(ut+1)%16],x=(le>>>1|Re<<32-1)^(le>>>8|Re<<32-8)^le>>>7,P=(Re>>>1|le<<32-1)^(Re>>>8|le<<32-8)^(Re>>>7|le<<32-7),z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,le=Ne[(ut+14)%16],Re=ae[(ut+14)%16],x=(le>>>19|Re<<32-19)^(Re>>>61-32|le<<32-(61-32))^le>>>6,P=(Re>>>19|le<<32-19)^(le>>>61-32|Re<<32-(61-32))^(Re>>>6|le<<32-6),z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,Ne[ut]=G&65535|K<<16,ae[ut]=z&65535|Y<<16}x=ee,P=Ae,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[0],P=te[0],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[0]=ee=G&65535|K<<16,te[0]=Ae=z&65535|Y<<16,x=We,P=j,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[1],P=te[1],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[1]=We=G&65535|K<<16,te[1]=j=z&65535|Y<<16,x=Tt,P=V,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[2],P=te[2],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[2]=Tt=G&65535|K<<16,te[2]=V=z&65535|Y<<16,x=at,P=he,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[3],P=te[3],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[3]=at=G&65535|K<<16,te[3]=he=z&65535|Y<<16,x=ct,P=pe,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[4],P=te[4],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[4]=ct=G&65535|K<<16,te[4]=pe=z&65535|Y<<16,x=Zt,P=we,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[5],P=te[5],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[5]=Zt=G&65535|K<<16,te[5]=we=z&65535|Y<<16,x=sr,P=Te,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[6],P=te[6],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[6]=sr=G&65535|K<<16,te[6]=Te=z&65535|Y<<16,x=Or,P=R,z=P&65535,Y=P>>>16,G=x&65535,K=x>>>16,x=oe[7],P=te[7],z+=P&65535,Y+=P>>>16,G+=x&65535,K+=x>>>16,Y+=z>>>16,G+=Y>>>16,K+=G>>>16,oe[7]=Or=G&65535|K<<16,te[7]=R=z&65535|Y<<16,se+=128,xe-=128}return se}function _e(Ne){var ae=new Ee;ae.update(Ne);var oe=ae.digest();return ae.clean(),oe}ne.hash=_e},72165:function(Qt,ne,ie){"use strict";Object.defineProperty(ne,"__esModule",{value:!0}),ne.isBrowserCryptoAvailable=ne.getSubtleCrypto=ne.getBrowerCrypto=void 0;function Q(){return(ie.g===null||ie.g===void 0?void 0:ie.g.crypto)||(ie.g===null||ie.g===void 0?void 0:ie.g.msCrypto)||{}}ne.getBrowerCrypto=Q;function me(){const pt=Q();return pt.subtle||pt.webkitSubtle}ne.getSubtleCrypto=me;function Ee(){return!!Q()&&!!me()}ne.isBrowserCryptoAvailable=Ee},73027:function(Qt,ne,ie){"use strict";var Q=ie(14224);Object.defineProperty(ne,"__esModule",{value:!0}),ne.isBrowser=ne.isNode=ne.isReactNative=void 0;function me(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ne.isReactNative=me;function Ee(){return typeof Q<"u"&&typeof Q.versions<"u"&&typeof Q.versions.node<"u"}ne.isNode=Ee;function pt(){return!me()&&!Ee()}ne.isBrowser=pt},88497:function(Qt,ne,ie){"use strict";Object.defineProperty(ne,"__esModule",{value:!0});const Q=ie(55727);Q.__exportStar(ie(72165),ne),Q.__exportStar(ie(73027),ne)},42995:function(){},63664:function(Qt,ne,ie){"use strict";ie.r(ne),ie.d(ne,{UniversalProvider:function(){return C0},default:function(){return cn}});var Q=ie(72100),me=ie.n(Q);const Ee=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,pt=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,H=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function _e(u,t){if(u==="__proto__"||u==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Ne(u);return}return t}function Ne(u){console.warn(`[destr] Dropping "${u}" key to prevent prototype pollution.`)}function ae(u,t={}){if(typeof u!="string")return u;const r=u.trim();if(u[0]==='"'&&u.at(-1)==='"'&&!u.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!H.test(u)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return u}try{if(Ee.test(u)||pt.test(u)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(u,_e)}return JSON.parse(u)}catch(n){if(t.strict)throw n;return u}}function oe(u,t={}){return ae(u,{...t,strict:!0})}var te=ie(55872).Buffer;function je(u){return!u||typeof u.then!="function"?Promise.resolve(u):u}function se(u,...t){try{return je(u(...t))}catch(r){return Promise.reject(r)}}function xe(u){const t=typeof u;return u===null||t!=="object"&&t!=="function"}function ee(u){const t=Object.getPrototypeOf(u);return!t||t.isPrototypeOf(Object)}function We(u){if(xe(u))return String(u);if(ee(u)||Array.isArray(u))return JSON.stringify(u);if(typeof u.toJSON=="function")return We(u.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Tt(){if(typeof te===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const at="base64:";function ct(u){if(typeof u=="string")return u;Tt();const t=te.from(u).toString("base64");return at+t}function Zt(u){return typeof u!="string"||!u.startsWith(at)?u:(Tt(),te.from(u.slice(at.length),"base64"))}const sr=null;function Or(u,t){if(t=V(t),!t)return u;const r={...u};for(const n of sr)r[n]=(a="",...f)=>u[n](t+a,...f);return r.getKeys=(n="",...a)=>u.getKeys(t+n,...a).then(f=>f.map(g=>g.slice(t.length))),r}function Ae(u){return u?u.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function j(...u){return Ae(u.join(":"))}function V(u){return u=Ae(u),u?u+":":""}function he(u){return u}const pe="memory",we=()=>{const u=new Map;return{name:pe,options:{},hasItem(t){return u.has(t)},getItem(t){return u.get(t)??null},getItemRaw(t){return u.get(t)??null},setItem(t,r){u.set(t,r)},setItemRaw(t,r){u.set(t,r)},removeItem(t){u.delete(t)},getKeys(){return Array.from(u.keys())},clear(){u.clear()},dispose(){u.clear()}}};function Te(u={}){const t={mounts:{"":u.driver||we()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=_=>{for(const A of t.mountpoints)if(_.startsWith(A))return{base:A,relativeKey:_.slice(A.length),driver:t.mounts[A]};return{base:"",relativeKey:_,driver:t.mounts[""]}},n=(_,A)=>t.mountpoints.filter(T=>T.startsWith(_)||A&&_.startsWith(T)).map(T=>({relativeBase:_.length>T.length?_.slice(T.length):void 0,mountpoint:T,driver:t.mounts[T]})),a=(_,A)=>{if(t.watching){A=Ae(A);for(const T of t.watchListeners)T(_,A)}},f=async()=>{if(!t.watching){t.watching=!0;for(const _ in t.mounts)t.unwatch[_]=await P(t.mounts[_],a,_)}},g=async()=>{if(t.watching){for(const _ in t.unwatch)await t.unwatch[_]();t.unwatch={},t.watching=!1}},w=(_,A,T)=>{const k=new Map,J=B=>{let ue=k.get(B.base);return ue||(ue={driver:B.driver,base:B.base,items:[]},k.set(B.base,ue)),ue};for(const B of _){const ue=typeof B=="string",ve=Ae(ue?B:B.key),be=ue?void 0:B.value,$e=ue||!B.options?A:{...A,...B.options},qe=r(ve);J(qe).items.push({key:ve,value:be,relativeKey:qe.relativeKey,options:$e})}return Promise.all([...k.values()].map(B=>T(B))).then(B=>B.flat())},C={hasItem(_,A={}){_=Ae(_);const{relativeKey:T,driver:k}=r(_);return se(k.hasItem,T,A)},getItem(_,A={}){_=Ae(_);const{relativeKey:T,driver:k}=r(_);return se(k.getItem,T,A).then(J=>ae(J))},getItems(_,A){return w(_,A,T=>T.driver.getItems?se(T.driver.getItems,T.items.map(k=>({key:k.relativeKey,options:k.options})),A).then(k=>k.map(J=>({key:j(T.base,J.key),value:ae(J.value)}))):Promise.all(T.items.map(k=>se(T.driver.getItem,k.relativeKey,k.options).then(J=>({key:k.key,value:ae(J)})))))},getItemRaw(_,A={}){_=Ae(_);const{relativeKey:T,driver:k}=r(_);return k.getItemRaw?se(k.getItemRaw,T,A):se(k.getItem,T,A).then(J=>Zt(J))},async setItem(_,A,T={}){if(A===void 0)return C.removeItem(_);_=Ae(_);const{relativeKey:k,driver:J}=r(_);J.setItem&&(await se(J.setItem,k,We(A),T),J.watch||a("update",_))},async setItems(_,A){await w(_,A,async T=>{T.driver.setItems&&await se(T.driver.setItems,T.items.map(k=>({key:k.relativeKey,value:We(k.value),options:k.options})),A),T.driver.setItem&&await Promise.all(T.items.map(k=>se(T.driver.setItem,k.relativeKey,We(k.value),k.options)))})},async setItemRaw(_,A,T={}){if(A===void 0)return C.removeItem(_,T);_=Ae(_);const{relativeKey:k,driver:J}=r(_);if(J.setItemRaw)await se(J.setItemRaw,k,A,T);else if(J.setItem)await se(J.setItem,k,ct(A),T);else return;J.watch||a("update",_)},async removeItem(_,A={}){typeof A=="boolean"&&(A={removeMeta:A}),_=Ae(_);const{relativeKey:T,driver:k}=r(_);k.removeItem&&(await se(k.removeItem,T,A),(A.removeMeta||A.removeMata)&&await se(k.removeItem,T+"$",A),k.watch||a("remove",_))},async getMeta(_,A={}){typeof A=="boolean"&&(A={nativeOnly:A}),_=Ae(_);const{relativeKey:T,driver:k}=r(_),J=Object.create(null);if(k.getMeta&&Object.assign(J,await se(k.getMeta,T,A)),!A.nativeOnly){const B=await se(k.getItem,T+"$",A).then(ue=>ae(ue));B&&typeof B=="object"&&(typeof B.atime=="string"&&(B.atime=new Date(B.atime)),typeof B.mtime=="string"&&(B.mtime=new Date(B.mtime)),Object.assign(J,B))}return J},setMeta(_,A,T={}){return this.setItem(_+"$",A,T)},removeMeta(_,A={}){return this.removeItem(_+"$",A)},async getKeys(_,A={}){_=V(_);const T=n(_,!0);let k=[];const J=[];for(const B of T){const ve=(await se(B.driver.getKeys,B.relativeBase,A)).map(be=>B.mountpoint+Ae(be)).filter(be=>!k.some($e=>be.startsWith($e)));J.push(...ve),k=[B.mountpoint,...k.filter(be=>!be.startsWith(B.mountpoint))]}return _?J.filter(B=>B.startsWith(_)&&!B.endsWith("$")):J.filter(B=>!B.endsWith("$"))},async clear(_,A={}){_=V(_),await Promise.all(n(_,!1).map(async T=>{if(T.driver.clear)return se(T.driver.clear,T.relativeBase,A);if(T.driver.removeItem){const k=await T.driver.getKeys(T.relativeBase||"",A);return Promise.all(k.map(J=>T.driver.removeItem(J,A)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(_=>le(_)))},async watch(_){return await f(),t.watchListeners.push(_),async()=>{t.watchListeners=t.watchListeners.filter(A=>A!==_),t.watchListeners.length===0&&await g()}},async unwatch(){t.watchListeners=[],await g()},mount(_,A){if(_=V(_),_&&t.mounts[_])throw new Error(`already mounted at ${_}`);return _&&(t.mountpoints.push(_),t.mountpoints.sort((T,k)=>k.length-T.length)),t.mounts[_]=A,t.watching&&Promise.resolve(P(A,a,_)).then(T=>{t.unwatch[_]=T}).catch(console.error),C},async unmount(_,A=!0){_=V(_),!(!_||!t.mounts[_])&&(t.watching&&_ in t.unwatch&&(t.unwatch[_](),delete t.unwatch[_]),A&&await le(t.mounts[_]),t.mountpoints=t.mountpoints.filter(T=>T!==_),delete t.mounts[_])},getMount(_=""){_=Ae(_)+":";const A=r(_);return{driver:A.driver,base:A.base}},getMounts(_="",A={}){return _=Ae(_),n(_,A.parents).map(k=>({driver:k.driver,base:k.mountpoint}))}};return C}async function R(u,t){t=normalizeBaseKey(t);const r=await u.getKeys(t),n={};return await Promise.all(r.map(async a=>{n[a.slice(t.length)]=await u.getItem(a)})),n}async function x(u,t,r=""){r=normalizeBaseKey(r),await Promise.all(Object.entries(t).map(n=>u.setItem(r+n[0],n[1])))}function P(u,t,r){return u.watch?u.watch((n,a)=>t(n,r+a)):()=>{}}async function le(u){typeof u.dispose=="function"&&await se(u.dispose)}const Re={azureAppConfiguration:"unstorage/drivers/azure-app-configuration",azureCosmos:"unstorage/drivers/azure-cosmos",azureKeyVault:"unstorage/drivers/azure-key-vault",azureStorageBlob:"unstorage/drivers/azure-storage-blob",azureStorageTable:"unstorage/drivers/azure-storage-table",cloudflareKVBinding:"unstorage/drivers/cloudflare-kv-binding",cloudflareKVHTTP:"unstorage/drivers/cloudflare-kv-http",cloudflareR2Binding:"unstorage/drivers/cloudflare-r2-binding",fs:"unstorage/drivers/fs",fsLite:"unstorage/drivers/fs-lite",github:"unstorage/drivers/github",http:"unstorage/drivers/http",indexedb:"unstorage/drivers/indexedb",localStorage:"unstorage/drivers/localstorage",lruCache:"unstorage/drivers/lru-cache",memory:"unstorage/drivers/memory",mongodb:"unstorage/drivers/mongodb",netlifyBlobs:"unstorage/drivers/netlify-blobs",overlay:"unstorage/drivers/overlay",planetscale:"unstorage/drivers/planetscale",redis:"unstorage/drivers/redis",sessionStorage:"unstorage/drivers/session-storage",vercelKV:"unstorage/drivers/vercel-kv","cloudflare-kv-binding":"unstorage/drivers/cloudflare-kv-binding","cloudflare-kv-http":"unstorage/drivers/cloudflare-kv-http"};function z(u){return new Promise((t,r)=>{u.oncomplete=u.onsuccess=()=>t(u.result),u.onabort=u.onerror=()=>r(u.error)})}function Y(u,t){const r=indexedDB.open(u);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=z(r);return(a,f)=>n.then(g=>f(g.transaction(t,a).objectStore(t)))}let G;function K(){return G||(G=Y("keyval-store","keyval")),G}function Qe(u,t=K()){return t("readonly",r=>z(r.get(u)))}function ut(u,t,r=K()){return r("readwrite",n=>(n.put(t,u),z(n.transaction)))}function Zr(u,t=K()){return t("readwrite",r=>(u.forEach(n=>r.put(n[1],n[0])),z(r.transaction)))}function qi(u,t=K()){return t("readonly",r=>Promise.all(u.map(n=>z(r.get(n)))))}function Li(u,t,r=K()){return r("readwrite",n=>new Promise((a,f)=>{n.get(u).onsuccess=function(){try{n.put(t(this.result),u),a(z(n.transaction))}catch(g){f(g)}}}))}function Xt(u,t=K()){return t("readwrite",r=>(r.delete(u),z(r.transaction)))}function N(u,t=K()){return t("readwrite",r=>(u.forEach(n=>r.delete(n)),z(r.transaction)))}function q(u=K()){return u("readwrite",t=>(t.clear(),z(t.transaction)))}function O(u,t){return u.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},z(u.transaction)}function l(u=K()){return u("readonly",t=>{if(t.getAllKeys)return z(t.getAllKeys());const r=[];return O(t,n=>r.push(n.key)).then(()=>r)})}function E(u=K()){return u("readonly",t=>{if(t.getAll)return z(t.getAll());const r=[];return O(t,n=>r.push(n.value)).then(()=>r)})}function fe(u=K()){return u("readonly",t=>{if(t.getAll&&t.getAllKeys)return Promise.all([z(t.getAllKeys()),z(t.getAll())]).then(([n,a])=>n.map((f,g)=>[f,a[g]]));const r=[];return u("readonly",n=>O(n,a=>r.push([a.key,a.value])).then(()=>r))})}const Se=u=>JSON.stringify(u,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Ke=u=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=u.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function Ge(u){if(typeof u!="string")throw new Error(`Cannot safe json parse value of type ${typeof u}`);try{return Ke(u)}catch{return u}}function Fe(u){return typeof u=="string"?u:Se(u)||""}function Ze(u){return u}const Nt="idb-keyval";var er=(u={})=>{const t=u.base&&u.base.length>0?`${u.base}:`:"",r=a=>t+a;let n;return u.dbName&&u.storeName&&(n=Y(u.dbName,u.storeName)),{name:Nt,options:u,async hasItem(a){return!(typeof await Qe(r(a),n)>"u")},async getItem(a){return await Qe(r(a),n)??null},setItem(a,f){return ut(r(a),f,n)},removeItem(a){return Xt(r(a),n)},getKeys(){return l(n)},clear(){return q(n)}}};const Vt="WALLET_CONNECT_V2_INDEXED_DB",Ft="keyvaluestorage";class _t{constructor(){this.indexedDb=Te({driver:er({dbName:Vt,storeName:Ft})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Fe(r))}async removeItem(t){await this.indexedDb.removeItem(t)}}var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ie.g<"u"?ie.g:typeof self<"u"?self:{},et={exports:{}};(function(){let u;function t(){}u=t,u.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},u.prototype.setItem=function(r,n){this[r]=String(n)},u.prototype.removeItem=function(r){delete this[r]},u.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},u.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},u.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ht<"u"&&ht.localStorage?et.exports=ht.localStorage:typeof window<"u"&&window.localStorage?et.exports=window.localStorage:et.exports=new t})();function lt(u){var t;return[u[0],Ge((t=u[1])!=null?t:"")]}class st{constructor(){this.localStorage=et.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(lt)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return Ge(r)}async setItem(t,r){this.localStorage.setItem(t,Fe(r))}async removeItem(t){this.localStorage.removeItem(t)}}const nt="wc_storage_version",Et=1,Gt=async(u,t,r)=>{const n=nt,a=await t.getItem(n);if(a&&a>=Et){r(t);return}const f=await u.getKeys();if(!f.length){r(t);return}const g=[];for(;f.length;){const w=f.shift();if(!w)continue;const C=w.toLowerCase();if(C.includes("wc@")||C.includes("walletconnect")||C.includes("wc_")||C.includes("wallet_connect")){const _=await u.getItem(w);await t.setItem(w,_),g.push(w)}}await t.setItem(n,Et),r(t),tr(u,g)},tr=async(u,t)=>{t.length&&t.forEach(async r=>{await u.removeItem(r)})};class nr{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new st;this.storage=t;try{const r=new _t;Gt(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}}var Z=ie(46196);class xt{}class Ar extends xt{constructor(t){super()}}const Dr=Z.FIVE_SECONDS,ur={pulse:"heartbeat_pulse"};class Br extends Ar{constructor(t){super(t),this.events=new Q.EventEmitter,this.interval=Dr,this.interval=(t==null?void 0:t.interval)||Dr}static async init(t){const r=new Br(t);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),(0,Z.toMiliseconds)(this.interval))}pulse(){this.events.emit(ur.pulse)}}var vr=ie(86984),Hr=ie.n(vr);const Zi={level:"info"},ai="custom_context",Xi=1e3*1024;class qt{constructor(t){this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class It{constructor(t){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const r=new qt(t);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let r=this.head;for(;r!==null;)t.push(r.value),r=r.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const r=t.value;return t=t.next,{done:!1,value:r}}}}}class Pt{constructor(t,r=Xi){this.level=t??"error",this.levelValue=vr.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new It(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,r){r===vr.levels.values.error?console.error(t):r===vr.levels.values.warn?console.warn(t):r===vr.levels.values.debug?console.debug(t):r===vr.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(Fe({timestamp:new Date().toISOString(),log:t}));const r=typeof t=="string"?JSON.parse(t).level:t.level;r>=this.levelValue&&this.forwardToConsole(t,r)}getLogs(){return this.logs}clearLogs(){this.logs=new It(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const r=this.getLogArray();return r.push(Fe({extraMetadata:t})),new Blob(r,{type:"application/json"})}}class Lt{constructor(t,r=Xi){this.baseChunkLogger=new Pt(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const r=URL.createObjectURL(this.logsToBlob(t)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}}class Mt{constructor(t,r=Xi){this.baseChunkLogger=new Pt(t,r)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}}var kt=Object.defineProperty,jt=Object.defineProperties,zt=Object.getOwnPropertyDescriptors,St=Object.getOwnPropertySymbols,$t=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable,Rt=(u,t,r)=>t in u?kt(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,dt=(u,t)=>{for(var r in t||(t={}))$t.call(t,r)&&Rt(u,r,t[r]);if(St)for(var r of St(t))Ut.call(t,r)&&Rt(u,r,t[r]);return u},gt=(u,t)=>jt(u,zt(t));function yt(u){return gt(dt({},u),{level:(u==null?void 0:u.level)||Zi.level})}function Bt(u,t=ai){return u[t]||""}function Jl(u,t,r=ai){return u[r]=t,u}function hr(u,t=ai){let r="";return typeof u.bindings>"u"?r=Bt(u,t):r=u.bindings().context||"",r}function Wl(u,t,r=ai){const n=hr(u,r);return n.trim()?`${n}/${t}`:t}function lr(u,t,r=ai){const n=Wl(u,t,r),a=u.child({context:n});return Jl(a,n,r)}function Yl(u){var t,r;const n=new Lt((t=u.opts)==null?void 0:t.level,u.maxSizeInBytes);return{logger:Hr()(gt(dt({},u.opts),{level:"trace",browser:gt(dt({},(r=u.opts)==null?void 0:r.browser),{write:a=>n.write(a)})})),chunkLoggerController:n}}function Ql(u){var t;const r=new Mt((t=u.opts)==null?void 0:t.level,u.maxSizeInBytes);return{logger:Hr()(gt(dt({},u.opts),{level:"trace"}),r),chunkLoggerController:r}}function Zl(u){return typeof u.loggerOverride<"u"&&typeof u.loggerOverride!="string"?{logger:u.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Yl(u):Ql(u)}class Xl extends xt{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class dE{constructor(t,r,n){this.core=t,this.logger=r}}class ef extends xt{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class tf{constructor(t,r){this.logger=t,this.core=r}}class rf extends xt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class sf extends xt{constructor(t){super()}}class nf{constructor(t,r,n,a){this.core=t,this.logger=r,this.name=n}}class gE{constructor(){this.map=new Map}}class of extends xt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class yE{constructor(t,r){this.core=t,this.logger=r}}class af extends xt{constructor(t,r){super(),this.core=t,this.logger=r}}class mE{constructor(t,r){this.logger=t,this.core=r}}class cf{constructor(t,r){this.projectId=t,this.logger=r}}class uf{constructor(t,r){this.projectId=t,this.logger=r}}class vE extends null{constructor(){super()}}class hf{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class wE extends null{constructor(){super()}}class lf{constructor(t){this.client=t}}var Ga=ie(61326),ff=ie(54889);const pf="EdDSA",df="JWT",Ja=".",Wa="base64url",gf="utf8",yf="utf8",mf=":",vf="did",wf="key",Ya="base58btc",bf="z",_f="K36",bE=32,Ef=32;function to(u){return globalThis.Buffer!=null?new Uint8Array(u.buffer,u.byteOffset,u.byteLength):u}function _E(u=0){return globalThis.Buffer!=null&&globalThis.Buffer.alloc!=null?asUint8Array(globalThis.Buffer.alloc(u)):new Uint8Array(u)}function Qa(u=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?to(globalThis.Buffer.allocUnsafe(u)):new Uint8Array(u)}function xf(u,t){t||(t=u.reduce((a,f)=>a+f.length,0));const r=Qa(t);let n=0;for(const a of u)r.set(a,n),n+=a.length;return to(r)}var Za=ie(64826);function Xa(u,t,r,n){return{name:u,prefix:t,encoder:{name:u,prefix:t,encode:r},decoder:{decode:n}}}const ec=Xa("utf8","u",u=>"u"+new TextDecoder("utf8").decode(u),u=>new TextEncoder().encode(u.substring(1))),ro=Xa("ascii","a",u=>{let t="a";for(let r=0;r<u.length;r++)t+=String.fromCharCode(u[r]);return t},u=>{u=u.substring(1);const t=Qa(u.length);for(let r=0;r<u.length;r++)t[r]=u.charCodeAt(r);return t});var tc={utf8:ec,"utf-8":ec,hex:Za.gh.base16,latin1:ro,ascii:ro,binary:ro,...Za.gh};function io(u,t="utf8"){const r=tc[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(u.buffer,u.byteOffset,u.byteLength).toString("utf8"):r.encoder.encode(u).substring(1)}function so(u,t="utf8"){const r=tc[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?to(globalThis.Buffer.from(u,"utf-8")):r.decoder.decode(`${r.prefix}${u}`)}function Qs(u){return safeJsonParse(toString(fromString(u,JWT_ENCODING),JSON_ENCODING))}function Zs(u){return io(so(Fe(u),gf),Wa)}function rc(u){const t=so(_f,Ya),r=bf+io(xf([t,u]),Ya);return[vf,wf,r].join(mf)}function xE(u){const[t,r,n]=u.split(DID_DELIMITER);if(t!==DID_PREFIX||r!==DID_METHOD)throw new Error('Issuer must be a DID with method "key"');if(n.slice(0,1)!==MULTICODEC_ED25519_BASE)throw new Error("Issuer must be a key in mulicodec format");const f=fromString(n.slice(1),MULTICODEC_ED25519_ENCODING);if(toString(f.slice(0,2),MULTICODEC_ED25519_ENCODING)!==MULTICODEC_ED25519_HEADER)throw new Error('Issuer must be a public key with type "Ed25519"');const w=f.slice(2);if(w.length!==MULTICODEC_ED25519_LENGTH)throw new Error("Issuer must be a public key with length 32 bytes");return w}function If(u){return io(u,Wa)}function Pf(u){return fromString(u,JWT_ENCODING)}function Sf(u){return so([Zs(u.header),Zs(u.payload)].join(Ja),yf)}function IE(u){const t=toString(u,DATA_ENCODING).split(JWT_DELIMITER),r=Qs(t[0]),n=Qs(t[1]);return{header:r,payload:n}}function Rf(u){return[Zs(u.header),Zs(u.payload),If(u.signature)].join(Ja)}function PE(u){const t=u.split(JWT_DELIMITER),r=Qs(t[0]),n=Qs(t[1]),a=Pf(t[2]),f=fromString(t.slice(0,2).join(JWT_DELIMITER),DATA_ENCODING);return{header:r,payload:n,signature:a,data:f}}function ic(u=(0,ff.randomBytes)(Ef)){return Ga._w(u)}async function Cf(u,t,r,n,a=(0,Z.fromMiliseconds)(Date.now())){const f={alg:pf,typ:df},g=rc(n.publicKey),w=a+r,C={iss:g,sub:u,aud:t,iat:a,exp:w},_=Sf({header:f,payload:C}),A=Ga.Xx(n.secretKey,_);return Rf({header:f,payload:C,signature:A})}async function SE(u){const{header:t,payload:r,data:n,signature:a}=decodeJWT(u);if(t.alg!==JWT_IRIDIUM_ALG||t.typ!==JWT_IRIDIUM_TYP)throw new Error("JWT must use EdDSA algorithm");const f=decodeIss(r.iss);return ed25519.verify(f,n,a)}var RE=ie(42995),y=ie(50373),Of=ie(90032);const Af="PARSE_ERROR",Df="INVALID_REQUEST",Tf="METHOD_NOT_FOUND",Nf="INVALID_PARAMS",sc="INTERNAL_ERROR",no="SERVER_ERROR",Ff=[-32700,-32600,-32601,-32602,-32603],CE=null,_s={[Af]:{code:-32700,message:"Parse error"},[Df]:{code:-32600,message:"Invalid Request"},[Tf]:{code:-32601,message:"Method not found"},[Nf]:{code:-32602,message:"Invalid params"},[sc]:{code:-32603,message:"Internal error"},[no]:{code:-32e3,message:"Server error"}},nc=no;function OE(u){return u<=SERVER_ERROR_CODE_RANGE[0]&&u>=SERVER_ERROR_CODE_RANGE[1]}function oc(u){return Ff.includes(u)}function qf(u){return typeof u=="number"}function ac(u){return Object.keys(_s).includes(u)?_s[u]:_s[nc]}function cc(u){const t=Object.values(_s).find(r=>r.code===u);return t||_s[nc]}function AE(u){if(typeof u.error.code>"u")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof u.error.message>"u")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!qf(u.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${u.error.code}`};if(oc(u.error.code)){const t=cc(u.error.code);if(t.message!==STANDARD_ERROR_MAP[DEFAULT_ERROR].message&&u.error.message===t.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${u.error.code}`}}return{valid:!0}}function uc(u,t,r){return u.message.includes("getaddrinfo ENOTFOUND")||u.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):u}var Lf=ie(88497);const DE=null;function _i(u=3){const t=Date.now()*Math.pow(10,u),r=Math.floor(Math.random()*Math.pow(10,u));return t+r}function Mi(u=6){return BigInt(_i(u))}function es(u,t,r){return{id:r||_i(),jsonrpc:"2.0",method:u,params:t}}function Xs(u,t){return{id:u,jsonrpc:"2.0",result:t}}function en(u,t,r){return{id:u,jsonrpc:"2.0",error:Mf(t,r)}}function Mf(u,t){return typeof u>"u"?ac(sc):(typeof u=="string"&&(u=Object.assign(Object.assign({},ac(no)),{message:u})),typeof t<"u"&&(u.data=t),oc(u.code)&&(u=cc(u.code)),u)}class kf{}class TE extends null{constructor(t){super()}}class jf extends kf{constructor(){super()}}class zf extends jf{constructor(t){super()}}const $f="^https?:",Uf="^wss?:";function Bf(u){const t=u.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function hc(u,t){const r=Bf(u);return typeof r>"u"?!1:new RegExp(t).test(r)}function lc(u){return hc(u,$f)}function fc(u){return hc(u,Uf)}function Hf(u){return new RegExp("wss?://localhost(:d{2,5})?").test(u)}function pc(u){return typeof u=="object"&&"id"in u&&"jsonrpc"in u&&u.jsonrpc==="2.0"}function oo(u){return pc(u)&&"method"in u}function tn(u){return pc(u)&&(Xr(u)||Tr(u))}function Xr(u){return"result"in u}function Tr(u){return"error"in u}function NE(u){return"error"in u&&u.valid===!1}class ci extends zf{constructor(t){super(t),this.events=new Q.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(es(t.method,t.params||[],t.id||Mi().toString()),r)}async requestStrict(t,r){return new Promise(async(n,a)=>{if(!this.connection.connected)try{await this.open()}catch(f){a(f)}this.events.on(`${t.id}`,f=>{Tr(f)?a(f.error):n(f.result)});try{await this.connection.send(t,r)}catch(f){a(f)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),tn(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Kf=()=>typeof WebSocket<"u"?WebSocket:typeof ie.g<"u"&&typeof ie.g.WebSocket<"u"?ie.g.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:ie(85783),Vf=()=>typeof WebSocket<"u"||typeof ie.g<"u"&&typeof ie.g.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",dc=u=>u.split("?")[0],gc=10,Gf=Kf();class Jf{constructor(t){if(this.url=t,this.events=new Q.EventEmitter,this.registering=!1,!fc(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Fe(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!fc(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),a(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const a=new URLSearchParams(t).get("origin"),f=(0,Lf.isReactNative)()?{headers:{origin:a}}:{rejectUnauthorized:!Hf(t)},g=new Gf(t,[],f);Vf()?g.onerror=w=>{const C=w;n(this.emitError(C.error))}:g.on("error",w=>{n(this.emitError(w))}),g.onopen=()=>{this.onOpen(g),r(g)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Ge(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),a=n.message||n.toString(),f=en(t,a);this.events.emit("payload",f)}parseError(t,r=this.url){return uc(t,dc(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>gc&&this.events.setMaxListeners(gc)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${dc(this.url)}`));return this.events.emit("register_error",r),r}}var Wf=ie(5899),Yf=ie.n(Wf),Qf=ie(51538),Zf=ie.n(Qf);function Xf(u,t){if(u.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<u.length;a++){var f=u.charAt(a),g=f.charCodeAt(0);if(r[g]!==255)throw new TypeError(f+" is ambiguous");r[g]=a}var w=u.length,C=u.charAt(0),_=Math.log(w)/Math.log(256),A=Math.log(256)/Math.log(w);function T(B){if(B instanceof Uint8Array||(ArrayBuffer.isView(B)?B=new Uint8Array(B.buffer,B.byteOffset,B.byteLength):Array.isArray(B)&&(B=Uint8Array.from(B))),!(B instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(B.length===0)return"";for(var ue=0,ve=0,be=0,$e=B.length;be!==$e&&B[be]===0;)be++,ue++;for(var qe=($e-be)*A+1>>>0,Ue=new Uint8Array(qe);be!==$e;){for(var ze=B[be],wt=0,rt=qe-1;(ze!==0||wt<ve)&&rt!==-1;rt--,wt++)ze+=256*Ue[rt]>>>0,Ue[rt]=ze%w>>>0,ze=ze/w>>>0;if(ze!==0)throw new Error("Non-zero carry");ve=wt,be++}for(var Ot=qe-ve;Ot!==qe&&Ue[Ot]===0;)Ot++;for(var br=C.repeat(ue);Ot<qe;++Ot)br+=u.charAt(Ue[Ot]);return br}function k(B){if(typeof B!="string")throw new TypeError("Expected String");if(B.length===0)return new Uint8Array;var ue=0;if(B[ue]!==" "){for(var ve=0,be=0;B[ue]===C;)ve++,ue++;for(var $e=(B.length-ue)*_+1>>>0,qe=new Uint8Array($e);B[ue];){var Ue=r[B.charCodeAt(ue)];if(Ue===255)return;for(var ze=0,wt=$e-1;(Ue!==0||ze<be)&&wt!==-1;wt--,ze++)Ue+=w*qe[wt]>>>0,qe[wt]=Ue%256>>>0,Ue=Ue/256>>>0;if(Ue!==0)throw new Error("Non-zero carry");be=ze,ue++}if(B[ue]!==" "){for(var rt=$e-be;rt!==$e&&qe[rt]===0;)rt++;for(var Ot=new Uint8Array(ve+($e-rt)),br=ve;rt!==$e;)Ot[br++]=qe[rt++];return Ot}}}function J(B){var ue=k(B);if(ue)return ue;throw new Error(`Non-${t} character`)}return{encode:T,decodeUnsafe:k,decode:J}}var ep=Xf,tp=ep;const yc=u=>{if(u instanceof Uint8Array&&u.constructor.name==="Uint8Array")return u;if(u instanceof ArrayBuffer)return new Uint8Array(u);if(ArrayBuffer.isView(u))return new Uint8Array(u.buffer,u.byteOffset,u.byteLength);throw new Error("Unknown type, must be binary type")},rp=u=>new TextEncoder().encode(u),ip=u=>new TextDecoder().decode(u);class sp{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class np{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return mc(this,t)}}class op{constructor(t){this.decoders=t}or(t){return mc(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const mc=(u,t)=>new op({...u.decoders||{[u.prefix]:u},...t.decoders||{[t.prefix]:t}});class ap{constructor(t,r,n,a){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new sp(t,r,n),this.decoder=new np(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const rn=({name:u,prefix:t,encode:r,decode:n})=>new ap(u,t,r,n),Es=({prefix:u,name:t,alphabet:r})=>{const{encode:n,decode:a}=tp(r,t);return rn({prefix:u,name:t,encode:n,decode:f=>yc(a(f))})},cp=(u,t,r,n)=>{const a={};for(let A=0;A<t.length;++A)a[t[A]]=A;let f=u.length;for(;u[f-1]==="=";)--f;const g=new Uint8Array(f*r/8|0);let w=0,C=0,_=0;for(let A=0;A<f;++A){const T=a[u[A]];if(T===void 0)throw new SyntaxError(`Non-${n} character`);C=C<<r|T,w+=r,w>=8&&(w-=8,g[_++]=255&C>>w)}if(w>=r||255&C<<8-w)throw new SyntaxError("Unexpected end of data");return g},up=(u,t,r)=>{const n=t[t.length-1]==="=",a=(1<<r)-1;let f="",g=0,w=0;for(let C=0;C<u.length;++C)for(w=w<<8|u[C],g+=8;g>r;)g-=r,f+=t[a&w>>g];if(g&&(f+=t[a&w<<r-g]),n)for(;f.length*r&7;)f+="=";return f},Jt=({name:u,prefix:t,bitsPerChar:r,alphabet:n})=>rn({prefix:t,name:u,encode(a){return up(a,n,r)},decode(a){return cp(a,n,r,u)}}),hp=rn({prefix:"\0",name:"identity",encode:u=>ip(u),decode:u=>rp(u)});var lp=Object.freeze({__proto__:null,identity:hp});const fp=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var pp=Object.freeze({__proto__:null,base2:fp});const dp=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var gp=Object.freeze({__proto__:null,base8:dp});const yp=Es({prefix:"9",name:"base10",alphabet:"0123456789"});var mp=Object.freeze({__proto__:null,base10:yp});const vp=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wp=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var bp=Object.freeze({__proto__:null,base16:vp,base16upper:wp});const _p=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ep=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),xp=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ip=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Pp=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Sp=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Rp=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Cp=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Op=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ap=Object.freeze({__proto__:null,base32:_p,base32upper:Ep,base32pad:xp,base32padupper:Ip,base32hex:Pp,base32hexupper:Sp,base32hexpad:Rp,base32hexpadupper:Cp,base32z:Op});const Dp=Es({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Tp=Es({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Np=Object.freeze({__proto__:null,base36:Dp,base36upper:Tp});const Fp=Es({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qp=Es({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Lp=Object.freeze({__proto__:null,base58btc:Fp,base58flickr:qp});const Mp=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),kp=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jp=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zp=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $p=Object.freeze({__proto__:null,base64:Mp,base64pad:kp,base64url:jp,base64urlpad:zp});const vc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Up=vc.reduce((u,t,r)=>(u[r]=t,u),[]),Bp=vc.reduce((u,t,r)=>(u[t.codePointAt(0)]=r,u),[]);function Hp(u){return u.reduce((t,r)=>(t+=Up[r],t),"")}function Kp(u){const t=[];for(const r of u){const n=Bp[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const Vp=rn({prefix:"\u{1F680}",name:"base256emoji",encode:Hp,decode:Kp});var Gp=Object.freeze({__proto__:null,base256emoji:Vp}),Jp=bc,wc=128,Wp=127,Yp=~Wp,Qp=Math.pow(2,31);function bc(u,t,r){t=t||[],r=r||0;for(var n=r;u>=Qp;)t[r++]=u&255|wc,u/=128;for(;u&Yp;)t[r++]=u&255|wc,u>>>=7;return t[r]=u|0,bc.bytes=r-n+1,t}var Zp=ao,Xp=128,_c=127;function ao(u,n){var r=0,n=n||0,a=0,f=n,g,w=u.length;do{if(f>=w)throw ao.bytes=0,new RangeError("Could not decode varint");g=u[f++],r+=a<28?(g&_c)<<a:(g&_c)*Math.pow(2,a),a+=7}while(g>=Xp);return ao.bytes=f-n,r}var ed=Math.pow(2,7),td=Math.pow(2,14),rd=Math.pow(2,21),id=Math.pow(2,28),sd=Math.pow(2,35),nd=Math.pow(2,42),od=Math.pow(2,49),ad=Math.pow(2,56),cd=Math.pow(2,63),ud=function(u){return u<ed?1:u<td?2:u<rd?3:u<id?4:u<sd?5:u<nd?6:u<od?7:u<ad?8:u<cd?9:10},hd={encode:Jp,decode:Zp,encodingLength:ud},Ec=hd;const xc=(u,t,r=0)=>(Ec.encode(u,t,r),t),Ic=u=>Ec.encodingLength(u),co=(u,t)=>{const r=t.byteLength,n=Ic(u),a=n+Ic(r),f=new Uint8Array(a+r);return xc(u,f,0),xc(r,f,n),f.set(t,a),new ld(u,r,t,f)};class ld{constructor(t,r,n,a){this.code=t,this.size=r,this.digest=n,this.bytes=a}}const Pc=({name:u,code:t,encode:r})=>new fd(u,t,r);class fd{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?co(this.code,r):r.then(n=>co(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Sc=u=>async t=>new Uint8Array(await crypto.subtle.digest(u,t)),pd=Pc({name:"sha2-256",code:18,encode:Sc("SHA-256")}),dd=Pc({name:"sha2-512",code:19,encode:Sc("SHA-512")});var gd=Object.freeze({__proto__:null,sha256:pd,sha512:dd});const Rc=0,yd="identity",Cc=yc;var md=Object.freeze({__proto__:null,identity:{code:Rc,name:yd,encode:Cc,digest:u=>co(Rc,Cc(u))}});new TextEncoder,new TextDecoder;const Oc={...lp,...pp,...gp,...mp,...bp,...Ap,...Np,...Lp,...$p,...Gp};({...gd,...md});function vd(u=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(u):new Uint8Array(u)}function Ac(u,t,r,n){return{name:u,prefix:t,encoder:{name:u,prefix:t,encode:r},decoder:{decode:n}}}const Dc=Ac("utf8","u",u=>"u"+new TextDecoder("utf8").decode(u),u=>new TextEncoder().encode(u.substring(1))),uo=Ac("ascii","a",u=>{let t="a";for(let r=0;r<u.length;r++)t+=String.fromCharCode(u[r]);return t},u=>{u=u.substring(1);const t=vd(u.length);for(let r=0;r<u.length;r++)t[r]=u.charCodeAt(r);return t}),wd={utf8:Dc,"utf-8":Dc,hex:Oc.base16,latin1:uo,ascii:uo,binary:uo,...Oc};function bd(u,t="utf8"){const r=wd[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(u,"utf8"):r.decoder.decode(`${r.prefix}${u}`)}const Tc="wc",_d=2,ho="core",Ei=`${Tc}@2:${ho}:`,Ed={name:ho,logger:"error"},xd={database:":memory:"},Id="crypto",Nc="client_ed25519_seed",Pd=Z.ONE_DAY,Sd="keychain",Rd="0.3",Cd="messages",Od="0.3",Ad=Z.SIX_HOURS,Dd="publisher",Fc="irn",Td="error",qc="wss://relay.walletconnect.com",Lc="wss://relay.walletconnect.org",Nd="relayer",fr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Fd="_subscription",Nr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},qd=Z.ONE_SECOND,LE={database:":memory:"},Ld="2.13.0",Md=1e4,kd="0.3",jd="WALLETCONNECT_CLIENT_ID",ei={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ME=null,zd="subscription",$d="0.3",Ud=Z.FIVE_SECONDS*1e3,Bd="pairing",Hd="0.3",kE=null,xs={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},ts={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Kd="history",Vd="0.3",Gd="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Jd="0.3",jE=null,lo="verify-api",rs="https://verify.walletconnect.com",fo="https://verify.walletconnect.org",Wd=[rs,fo],Yd="echo",Qd="https://echo.walletconnect.com";class Zd{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=Sd,this.version=Rd,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:f}=(0,y.kCb)("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(f)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=lr(r,this.name)}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,(0,y.KCv)(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?(0,y.IPd)(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Xd{constructor(t,r,n){this.core=t,this.logger=r,this.name=Id,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),f=ic(a);return rc(f.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=(0,y.Au2)();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const f=await this.getClientSeed(),g=ic(f),w=(0,y.jdp)();return await Cf(w,a,Pd,g)},this.generateSharedKey=(a,f,g)=>{this.isInitialized();const w=this.getPrivateKey(a),C=(0,y.m$A)(w,f);return this.setSymKey(C,g)},this.setSymKey=async(a,f)=>{this.isInitialized();const g=f||(0,y.YmJ)(a);return await this.keychain.set(g,a),g},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,f,g)=>{this.isInitialized();const w=(0,y.ENt)(g),C=Fe(f);if((0,y.Q8x)(w)){const k=w.senderPublicKey,J=w.receiverPublicKey;a=await this.generateSharedKey(k,J)}const _=this.getSymKey(a),{type:A,senderPublicKey:T}=w;return(0,y.HIp)({type:A,symKey:_,message:C,senderPublicKey:T})},this.decode=async(a,f,g)=>{this.isInitialized();const w=(0,y.Llj)(f,g);if((0,y.Q8x)(w)){const C=w.receiverPublicKey,_=w.senderPublicKey;a=await this.generateSharedKey(C,_)}try{const C=this.getSymKey(a),_=(0,y.peR)({symKey:C,encoded:f});return Ge(_)}catch(C){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(C)}},this.getPayloadType=a=>{const f=(0,y.vBi)(a);return(0,y.WGe)(f.type)},this.getPayloadSenderPublicKey=a=>{const f=(0,y.vBi)(a);return f.senderPublicKey?(0,Of.BB)(f.senderPublicKey,y.AWt):void 0},this.core=t,this.logger=lr(r,this.name),this.keychain=n||new Zd(this.core,this.logger)}get context(){return hr(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Nc)}catch{t=(0,y.jdp)(),await this.keychain.set(Nc,t)}return bd(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}}class eg extends tf{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=Cd,this.version=Od,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const f=(0,y.rjm)(a);let g=this.messages.get(n);return typeof g>"u"&&(g={}),typeof g[f]<"u"||(g[f]=a,this.messages.set(n,g),await this.persist()),f},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const f=this.get(n),g=(0,y.rjm)(a);return typeof f[g]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=lr(t,this.name),this.core=r}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,(0,y.KCv)(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?(0,y.IPd)(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}}class tg extends rf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Q.EventEmitter,this.name=Dd,this.queue=new Map,this.publishTimeout=(0,Z.toMiliseconds)(Z.ONE_MINUTE),this.failedPublishTimeout=(0,Z.toMiliseconds)(Z.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(n,a,f)=>{var g;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:f}});const w=(f==null?void 0:f.ttl)||Ad,C=(0,y._HE)(f),_=(f==null?void 0:f.prompt)||!1,A=(f==null?void 0:f.tag)||0,T=(f==null?void 0:f.id)||Mi().toString(),k={topic:n,message:a,opts:{ttl:w,relay:C,prompt:_,tag:A,id:T}},J=`Failed to publish payload, please try again. id:${T} tag:${A}`,B=Date.now();let ue,ve=1;try{for(;ue===void 0;){if(Date.now()-B>this.publishTimeout)throw new Error(J);this.logger.trace({id:T,attempts:ve},`publisher.publish - attempt ${ve}`),ue=await await(0,y.hFY)(this.rpcPublish(n,a,w,C,_,A,T).catch(be=>this.logger.warn(be)),this.publishTimeout,J),ve++,ue||await new Promise(be=>setTimeout(be,this.failedPublishTimeout))}this.relayer.events.emit(fr.publish,k),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:T,topic:n,message:a,opts:f}})}catch(be){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(be),(g=f==null?void 0:f.internal)!=null&&g.throwOnFailedPublish)throw be;this.queue.set(T,k)}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=t,this.logger=lr(r,this.name),this.registerEventListeners()}get context(){return hr(this.logger)}rpcPublish(t,r,n,a,f,g,w){var C,_,A,T;const k={method:(0,y.cOS)(a.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:f,tag:g},id:w};return(0,y.o8e)((C=k.params)==null?void 0:C.prompt)&&((_=k.params)==null||delete _.prompt),(0,y.o8e)((A=k.params)==null?void 0:A.tag)&&((T=k.params)==null||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:k}),this.relayer.request(k)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:a}=t;await this.publish(r,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(ur.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(fr.connection_stalled);return}this.checkQueue()}),this.relayer.on(fr.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class rg{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const a=n.filter(f=>f!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var ig=Object.defineProperty,sg=Object.defineProperties,ng=Object.getOwnPropertyDescriptors,Mc=Object.getOwnPropertySymbols,og=Object.prototype.hasOwnProperty,ag=Object.prototype.propertyIsEnumerable,kc=(u,t,r)=>t in u?ig(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,Is=(u,t)=>{for(var r in t||(t={}))og.call(t,r)&&kc(u,r,t[r]);if(Mc)for(var r of Mc(t))ag.call(t,r)&&kc(u,r,t[r]);return u},po=(u,t)=>sg(u,ng(t));class cg extends of{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new rg,this.events=new Q.EventEmitter,this.name=zd,this.version=$d,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ei,this.subscribeTimeout=(0,Z.toMiliseconds)(Z.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const f=(0,y._HE)(a),g={topic:n,relay:f};this.pending.set(n,g);const w=await this.rpcSubscribe(n,f);return typeof w=="string"&&(this.onSubscribe(w,g),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}})),w}catch(f){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(f),f}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>{if(this.topics.includes(n))return!0;const a=`${this.pendingSubscriptionWatchLabel}_${n}`;return await new Promise((f,g)=>{const w=new Z.Watch;w.start(a);const C=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(C),w.stop(a),f(!0)),w.elapsed(a)>=Ud&&(clearInterval(C),w.stop(a),g(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=lr(r,this.name),this.clientId=""}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const a=(0,y._HE)(n);await this.rpcUnsubscribe(t,r,a);const f=(0,y.D6H)("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,f),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const n={method:(0,y.cOS)(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await(0,y.hFY)(this.relayer.request(n).catch(a=>this.logger.warn(a)),this.subscribeTimeout)?(0,y.rjm)(t+this.clientId):null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(fr.connection_stalled)}return null}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:(0,y.cOS)(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await(0,y.hFY)(this.relayer.request(n).catch(a=>this.logger.warn(a)),this.subscribeTimeout)}catch{this.relayer.events.emit(fr.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const r=t[0].relay,n={method:(0,y.cOS)(r.protocol).batchFetchMessages,params:{topics:t.map(f=>f.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let a;try{a=await await(0,y.hFY)(this.relayer.request(n).catch(f=>this.logger.warn(f)),this.subscribeTimeout)}catch{this.relayer.events.emit(fr.connection_stalled)}return a}rpcUnsubscribe(t,r,n){const a={method:(0,y.cOS)(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,po(Is({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Is({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r)}addSubscription(t,r){this.subscriptions.set(t,Is({},r)),this.topicMap.set(r.topic,t),this.events.emit(ei.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=(0,y.kCb)("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(ei.deleted,po(Is({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ei.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(n),await this.batchSubscribe(n)}}this.events.emit(ei.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=(0,y.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);(0,y.qt8)(r)&&this.onBatchSubscribe(r.map((n,a)=>po(Is({},t[a]),{id:n})))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const r=await this.rpcBatchFetchMessages(t);r&&r.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(r.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(ur.pulse,async()=>{await this.checkPending()}),this.events.on(ei.created,async t=>{const r=ei.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ei.deleted,async t=>{const r=ei.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var ug=Object.defineProperty,jc=Object.getOwnPropertySymbols,hg=Object.prototype.hasOwnProperty,lg=Object.prototype.propertyIsEnumerable,zc=(u,t,r)=>t in u?ug(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,fg=(u,t)=>{for(var r in t||(t={}))hg.call(t,r)&&zc(u,r,t[r]);if(jc)for(var r of jc(t))lg.call(t,r)&&zc(u,r,t[r]);return u};class pg extends sf{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Q.EventEmitter,this.name=Nd,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=(0,Z.toMiliseconds)(Z.THIRTY_SECONDS+Z.ONE_SECOND),this.request=async r=>{var n,a;this.logger.debug("Publishing Request Payload");const f=r.id||Mi().toString();await this.toEstablishConnection();try{const g=this.provider.request(r);this.requestsInFlight.set(f,{promise:g,request:r}),this.logger.trace({id:f,method:r.method,topic:(n=r.params)==null?void 0:n.topic},"relayer.request - attempt to publish...");const w=await new Promise(async(C,_)=>{const A=()=>{_(new Error(`relayer.request - publish interrupted, id: ${f}`))};this.provider.on(Nr.disconnect,A);const T=await g;this.provider.off(Nr.disconnect,A),C(T)});return this.logger.trace({id:f,method:r.method,topic:(a=r.params)==null?void 0:a.topic},"relayer.request - published"),w}catch(g){throw this.logger.debug(`Failed to Publish Request: ${f}`),g}finally{this.requestsInFlight.delete(f)}},this.resetPingTimeout=()=>{if((0,y.UGU)())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,n,a;(a=(n=(r=this.provider)==null?void 0:r.connection)==null?void 0:n.socket)==null||a.terminate()},this.heartBeatTimeout)}catch(r){this.logger.warn(r)}},this.onPayloadHandler=r=>{this.onProviderPayload(r),this.resetPingTimeout()},this.onConnectHandler=()=>{this.startPingTimeout(),this.events.emit(fr.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(fr.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Nr.payload,this.onPayloadHandler),this.provider.on(Nr.connect,this.onConnectHandler),this.provider.on(Nr.disconnect,this.onDisconnectHandler),this.provider.on(Nr.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?lr(t.logger,this.name):Hr()(yt({level:t.logger||Td})),this.messages=new eg(this.logger,t.core),this.subscriber=new cg(this,this.logger),this.publisher=new tg(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||qc,this.projectId=t.projectId,this.bundleId=(0,y.X_B)(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Lc}...`),await this.restartTransport(Lc)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&this.subscriber.pending.size===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Md)}get context(){return hr(this.logger)}get connected(){var t,r,n;return((n=(r=(t=this.provider)==null?void 0:t.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1}get connecting(){var t,r,n;return((n=(r=(t=this.provider)==null?void 0:t.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"",f;const g=w=>{w.topic===t&&(this.subscriber.off(ei.created,g),f())};return await Promise.all([new Promise(w=>{f=w,this.subscriber.on(ei.created,g)}),new Promise(async w=>{a=await this.subscriber.subscribe(t,r)||a,w()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(t=>t.promise))}catch(t){this.logger.warn(t)}this.hasExperiencedNetworkDisruption||this.connected?await(0,y.hFY)(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(r,n)=>{const a=()=>{this.provider.off(Nr.disconnect,a),n(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Nr.disconnect,a),await(0,y.hFY)(this.provider.connect(),(0,Z.toMiliseconds)(Z.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(f=>{n(f)}),await this.subscriber.start(),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){this.logger.error(r);const n=r;if(this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(n.message))throw r}finally{this.connectionAttemptInProgress=!1}}async restartTransport(t){this.connectionAttemptInProgress||(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await(0,y.Ggh)())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if((t==null?void 0:t.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=t.sort((n,a)=>n.publishedAt-a.publishedAt);this.logger.trace(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(a){this.logger.warn(a)}this.logger.trace(`Batch of ${r.length} message events processed`)}startPingTimeout(){var t,r,n,a,f;if((0,y.UGU)())try{(r=(t=this.provider)==null?void 0:t.connection)!=null&&r.socket&&((f=(a=(n=this.provider)==null?void 0:n.connection)==null?void 0:a.socket)==null||f.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(g){this.logger.warn(g)}}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ci(new Jf((0,y.$0m)({sdkVersion:Ld,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),oo(t)){if(!t.method.endsWith(Fd))return;const r=t.params,{topic:n,message:a,publishedAt:f}=r.data,g={topic:n,message:a,publishedAt:f};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(fg({type:"event",event:r.id},g)),this.events.emit(r.id,g),await this.acknowledgePayload(t),await this.onMessageEvent(g)}else tn(t)&&this.events.emit(fr.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(fr.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Xs(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Nr.payload,this.onPayloadHandler),this.provider.off(Nr.connect,this.onConnectHandler),this.provider.off(Nr.disconnect,this.onDisconnectHandler),this.provider.off(Nr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await(0,y.Ggh)();(0,y.uwg)(async r=>{t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(fr.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t))},(0,Z.toMiliseconds)(qd))}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var dg=Object.defineProperty,$c=Object.getOwnPropertySymbols,gg=Object.prototype.hasOwnProperty,yg=Object.prototype.propertyIsEnumerable,Uc=(u,t,r)=>t in u?dg(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,Bc=(u,t)=>{for(var r in t||(t={}))gg.call(t,r)&&Uc(u,r,t[r]);if($c)for(var r of $c(t))yg.call(t,r)&&Uc(u,r,t[r]);return u};class ki extends nf{constructor(t,r,n,a=Ei,f=void 0){super(t,r,n,a),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=kd,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(g=>{this.getKey&&g!==null&&!(0,y.o8e)(g)?this.map.set(this.getKey(g),g):(0,y.xWS)(g)?this.map.set(g.id,g):(0,y.h1R)(g)&&this.map.set(g.topic,g)}),this.cached=[],this.initialized=!0)},this.set=async(g,w)=>{this.isInitialized(),this.map.has(g)?await this.update(g,w):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:g,value:w}),this.map.set(g,w),await this.persist())},this.get=g=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:g}),this.getData(g)),this.getAll=g=>(this.isInitialized(),g?this.values.filter(w=>Object.keys(g).every(C=>Yf()(w[C],g[C]))):this.values),this.update=async(g,w)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:g,update:w});const C=Bc(Bc({},this.getData(g)),w);this.map.set(g,C),await this.persist()},this.delete=async(g,w)=>{this.isInitialized(),this.map.has(g)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:g,reason:w}),this.map.delete(g),this.addToRecentlyDeleted(g),await this.persist())},this.logger=lr(r,this.name),this.storagePrefix=a,this.getKey=f}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){if(this.recentlyDeleted.includes(t)){const{message:a}=(0,y.kCb)("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(a),new Error(a)}const{message:n}=(0,y.kCb)("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=(0,y.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}}class mg{constructor(t,r){this.core=t,this.logger=r,this.name=Bd,this.version=Hd,this.events=new(me()),this.initialized=!1,this.storagePrefix=Ei,this.ignoredPayloadTypes=[y.rVF],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async n=>{this.isInitialized();const a=(0,y.jdp)(),f=await this.core.crypto.setSymKey(a),g=(0,y.gn4)(Z.FIVE_MINUTES),w={protocol:Fc},C={topic:f,expiry:g,relay:w,active:!1},_=(0,y.Bvr)({protocol:this.core.protocol,version:this.core.version,topic:f,symKey:a,relay:w,expiryTimestamp:g,methods:n==null?void 0:n.methods});return this.core.expirer.set(f,g),await this.pairings.set(f,C),await this.core.relayer.subscribe(f),{topic:f,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:f,relay:g,expiryTimestamp:w,methods:C}=(0,y.heJ)(n.uri);let _;if(this.pairings.keys.includes(a)&&(_=this.pairings.get(a),_.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const A=w||(0,y.gn4)(Z.FIVE_MINUTES),T={topic:a,relay:g,expiry:A,active:!1,methods:C};return this.core.expirer.set(a,A),await this.pairings.set(a,T),n.activatePairing&&await this.activate({topic:a}),this.events.emit(ts.create,T),this.core.crypto.keychain.has(a)||await this.core.crypto.setSymKey(f,a),await this.core.relayer.subscribe(a,{relay:g}),T},this.activate=async({topic:n})=>{this.isInitialized();const a=(0,y.gn4)(Z.THIRTY_DAYS);this.core.expirer.set(n,a),await this.pairings.update(n,{active:!0,expiry:a})},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const f=await this.sendRequest(a,"wc_pairingPing",{}),{done:g,resolve:w,reject:C}=(0,y.H1S)();this.events.once((0,y.E0T)("pairing_ping",f),({error:_})=>{_?C(_):w()}),await g()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",(0,y.D6H)("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,f)=>{const g=es(a,f),w=await this.core.crypto.encode(n,g),C=xs[a].req;return this.core.history.set(n,g),this.core.relayer.publish(n,w,C),g.id},this.sendResult=async(n,a,f)=>{const g=Xs(n,f),w=await this.core.crypto.encode(a,g),C=await this.core.history.get(a,n),_=xs[C.request.method].res;await this.core.relayer.publish(a,w,_),await this.core.history.resolve(g)},this.sendError=async(n,a,f)=>{const g=en(n,f),w=await this.core.crypto.encode(a,g),C=await this.core.history.get(a,n),_=xs[C.request.method]?xs[C.request.method].res:xs.unregistered_method.res;await this.core.relayer.publish(a,w,_),await this.core.history.resolve(g)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,(0,y.D6H)("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>(0,y.BwD)(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:f}=n;switch(f.method){case"wc_pairingPing":return this.onPairingPingRequest(a,f);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,f);default:return this.onUnknownRpcMethodRequest(a,f)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:f}=n,g=(await this.core.history.get(a,f.id)).request.method;switch(g){case"wc_pairingPing":return this.onPairingPingResponse(a,f);default:return this.onUnknownRpcMethodResponse(g)}},this.onPairingPingRequest=async(n,a)=>{const{id:f}=a;try{this.isValidPing({topic:n}),await this.sendResult(f,n,!0),this.events.emit(ts.ping,{id:f,topic:n})}catch(g){await this.sendError(f,n,g),this.logger.error(g)}},this.onPairingPingResponse=(n,a)=>{const{id:f}=a;setTimeout(()=>{Xr(a)?this.events.emit((0,y.E0T)("pairing_ping",f),{}):Tr(a)&&this.events.emit((0,y.E0T)("pairing_ping",f),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:f}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(ts.delete,{id:f,topic:n})}catch(g){await this.sendError(f,n,g),this.logger.error(g)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:f,method:g}=a;try{if(this.registeredMethods.includes(g))return;const w=(0,y.D6H)("WC_METHOD_UNSUPPORTED",g);await this.sendError(f,n,w),this.logger.error(w)}catch(w){await this.sendError(f,n,w),this.logger.error(w)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error((0,y.D6H)("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var a;if(!(0,y.EJd)(n)){const{message:g}=(0,y.kCb)("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(g)}if(!(0,y.jvJ)(n.uri)){const{message:g}=(0,y.kCb)("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(g)}const f=(0,y.heJ)(n.uri);if(!((a=f==null?void 0:f.relay)!=null&&a.protocol)){const{message:g}=(0,y.kCb)("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(g)}if(!(f!=null&&f.symKey)){const{message:g}=(0,y.kCb)("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(g)}if(f!=null&&f.expiryTimestamp&&(0,Z.toMiliseconds)(f==null?void 0:f.expiryTimestamp)<Date.now()){const{message:g}=(0,y.kCb)("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(g)}},this.isValidPing=async n=>{if(!(0,y.EJd)(n)){const{message:f}=(0,y.kCb)("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(f)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!(0,y.EJd)(n)){const{message:f}=(0,y.kCb)("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(f)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!(0,y.M_r)(n,!1)){const{message:a}=(0,y.kCb)("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=(0,y.kCb)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if((0,y.BwD)(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=(0,y.kCb)("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=t,this.logger=lr(r,this.name),this.pairings=new ki(this.core,this.logger,this.name,this.storagePrefix)}get context(){return hr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(fr.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(r,n);try{oo(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):tn(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(f){this.logger.error(f)}})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async t=>{const{topic:r}=(0,y.iPz)(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ts.expire,{topic:r}))})}}class vg extends ef{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Q.EventEmitter,this.name=Kd,this.version=Vd,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,f)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:f}),this.records.has(a.id))return;const g={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:f,expiry:(0,y.gn4)(Z.THIRTY_DAYS)};this.records.set(g.id,g),this.persist(),this.events.emit(Kr.created,g)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=Tr(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.persist(),this.events.emit(Kr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(f=>{if(f.topic===n){if(typeof a<"u"&&f.id!==a)return;this.records.delete(f.id),this.events.emit(Kr.deleted,f)}}),this.persist()},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=lr(r,this.name)}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:es(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=(0,y.kCb)("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Kr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=(0,y.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Kr.created,t=>{const r=Kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t})}),this.events.on(Kr.updated,t=>{const r=Kr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t})}),this.events.on(Kr.deleted,t=>{const r=Kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t})}),this.core.heartbeat.on(ur.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(r=>{(0,Z.toMiliseconds)(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(Kr.deleted,r,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}}class wg extends af{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Q.EventEmitter,this.name=Gd,this.version=Jd,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const f=this.formatTarget(n),g={target:f,expiry:a};this.expirations.set(f,g),this.checkExpiry(f,g),this.events.emit(Fr.created,{target:f,expiration:g})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),f=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Fr.deleted,{target:a,expiration:f})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=lr(r,this.name)}get context(){return hr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return(0,y.Z42)(t);if(typeof t=="number")return(0,y.GqV)(t);const{message:r}=(0,y.kCb)("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=(0,y.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=(0,y.kCb)("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;(0,Z.toMiliseconds)(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Fr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(ur.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.expired,t=>{const r=Fr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.deleted,t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}}}class bg extends cf{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=lo,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||(0,y.b$m)()||!(0,y.jUY)())return;const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(f){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(f)}if(!this.initialized){this.removeIframe(),this.verifyUrl=fo;try{await this.createIframe()}catch(f){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(f),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let f;try{f=await this.fetchAttestation(n.attestationId,a)}catch(g){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(g),f=await this.fetchAttestation(n.attestationId,fo)}return f},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const f=this.startAbortTimer(Z.ONE_SECOND*2),g=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(f),g.status===200?await g.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=f=>{f.data==="verify_ready"&&(this.onInit(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(f=>{const g=document.getElementById(lo);if(g)return this.iframe=g,this.onInit(),f();window.addEventListener("message",a);const w=document.createElement("iframe");w.id=lo,w.src=`${this.verifyUrl}/${this.projectId}`,w.style.display="none",document.body.append(w),this.iframe=w,n=f}),new Promise((f,g)=>setTimeout(()=>{window.removeEventListener("message",a),g("verify iframe load timeout")},(0,Z.toMiliseconds)(Z.FIVE_SECONDS)))])},this.onInit=()=>{this.initialized=!0,this.processQueue()},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let a=n||rs;return Wd.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${rs}`),a=rs),a},this.logger=lr(r,this.name),this.verifyUrl=rs,this.abortController=new AbortController,this.isDevEnv=(0,y.UGU)()&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.IS_VITEST}get context(){return hr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,Z.toMiliseconds)(t))}}class _g extends uf{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=Yd,this.registerDeviceToken=async n=>{const{clientId:a,token:f,notificationType:g,enableEncrypted:w=!1}=n,C=`${Qd}/${this.projectId}/clients`;await Zf()(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:a,type:g,token:f,always_raw:w})})},this.logger=lr(r,this.context)}}var Eg=Object.defineProperty,Hc=Object.getOwnPropertySymbols,xg=Object.prototype.hasOwnProperty,Ig=Object.prototype.propertyIsEnumerable,Kc=(u,t,r)=>t in u?Eg(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,Vc=(u,t)=>{for(var r in t||(t={}))xg.call(t,r)&&Kc(u,r,t[r]);if(Hc)for(var r of Hc(t))Ig.call(t,r)&&Kc(u,r,t[r]);return u};class go extends Xl{constructor(t){var r;super(t),this.protocol=Tc,this.version=_d,this.name=ho,this.events=new Q.EventEmitter,this.initialized=!1,this.on=(g,w)=>this.events.on(g,w),this.once=(g,w)=>this.events.once(g,w),this.off=(g,w)=>this.events.off(g,w),this.removeListener=(g,w)=>this.events.removeListener(g,w),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||qc,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const n=yt({level:typeof(t==null?void 0:t.logger)=="string"&&t.logger?t.logger:Ed.logger}),{logger:a,chunkLoggerController:f}=Zl({opts:n,maxSizeInBytes:t==null?void 0:t.maxLogBlobSizeInBytes,loggerOverride:t==null?void 0:t.logger});this.logChunkController=f,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var g,w;(g=this.logChunkController)!=null&&g.downloadLogsBlobInBrowser&&((w=this.logChunkController)==null||w.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=lr(a,this.name),this.heartbeat=new Br,this.crypto=new Xd(this,this.logger,t==null?void 0:t.keychain),this.history=new vg(this,this.logger),this.expirer=new wg(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new nr(Vc(Vc({},xd),t==null?void 0:t.storageOptions)),this.relayer=new pg({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new mg(this,this.logger),this.verify=new bg(this.projectId||"",this.logger),this.echoClient=new _g(this.projectId||"",this.logger)}static async init(t){const r=new go(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(jd,n),r}get context(){return hr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const Pg=go,Gc="wc",Jc=2,Wc="client",yo=`${Gc}@${Jc}:${Wc}:`,mo={name:Wc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},zE={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire",session_authenticate:"session_authenticate",session_request_expire:"session_request_expire"},$E={database:":memory:"},Yc="WALLETCONNECT_DEEPLINK_CHOICE",UE={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},BE="history",HE="0.3",Sg="proposal",KE=null,Qc="Proposal expired",Rg="session",is=Z.SEVEN_DAYS,Cg="engine",wr={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Z.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Z.ONE_HOUR,prompt:!1,tag:1117}}},vo={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},ui={idle:"IDLE",active:"ACTIVE"},Og="request",Ag=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],Dg="wc",VE=1.5,Tg="auth",Ng="authKeys",Fg="pairingTopics",qg="requests",sn=`${Dg}@${1.5}:${Tg}:`,nn=`${sn}:PUB_KEY`;var Lg=Object.defineProperty,Mg=Object.defineProperties,kg=Object.getOwnPropertyDescriptors,Zc=Object.getOwnPropertySymbols,jg=Object.prototype.hasOwnProperty,zg=Object.prototype.propertyIsEnumerable,Xc=(u,t,r)=>t in u?Lg(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,Ct=(u,t)=>{for(var r in t||(t={}))jg.call(t,r)&&Xc(u,r,t[r]);if(Zc)for(var r of Zc(t))zg.call(t,r)&&Xc(u,r,t[r]);return u},ji=(u,t)=>Mg(u,kg(t));class $g extends lf{constructor(t){super(t),this.name=Cg,this.events=new(me()),this.initialized=!1,this.requestQueue={state:ui.idle,queue:[]},this.sessionRequestQueue={state:ui.idle,queue:[]},this.requestQueueDelay=Z.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(wr)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,Z.toMiliseconds)(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=ji(Ct({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:f,optionalNamespaces:g,sessionProperties:w,relays:C}=n;let _=a,A,T=!1;try{_&&(T=this.client.core.pairing.pairings.get(_).active)}catch(Ue){throw this.client.logger.error(`connect() -> pairing.get(${_}) failed`),Ue}if(!_||!T){const{topic:Ue,uri:ze}=await this.client.core.pairing.create();_=Ue,A=ze}if(!_){const{message:Ue}=(0,y.kCb)("NO_MATCHING_KEY",`connect() pairing topic: ${_}`);throw new Error(Ue)}const k=await this.client.core.crypto.generateKeyPair(),J=wr.wc_sessionPropose.req.ttl||Z.FIVE_MINUTES,B=(0,y.gn4)(J),ue=Ct({requiredNamespaces:f,optionalNamespaces:g,relays:C??[{protocol:Fc}],proposer:{publicKey:k,metadata:this.client.metadata},expiryTimestamp:B},w&&{sessionProperties:w}),{reject:ve,resolve:be,done:$e}=(0,y.H1S)(J,Qc);this.events.once((0,y.E0T)("session_connect"),async({error:Ue,session:ze})=>{if(Ue)ve(Ue);else if(ze){ze.self.publicKey=k;const wt=ji(Ct({},ze),{requiredNamespaces:ue.requiredNamespaces,optionalNamespaces:ue.optionalNamespaces});await this.client.session.set(ze.topic,wt),await this.setExpiry(ze.topic,ze.expiry),_&&await this.client.core.pairing.updateMetadata({topic:_,metadata:ze.peer.metadata}),be(wt)}});const qe=await this.sendRequest({topic:_,method:"wc_sessionPropose",params:ue,throwOnFailedPublish:!0});return await this.setProposal(qe,Ct({id:qe},ue)),{uri:A,approval:$e}},this.pair=async r=>{await this.isInitialized();try{return await this.client.core.pairing.pair(r)}catch(n){throw this.client.logger.error("pair() failed"),n}},this.approve=async r=>{await this.isInitialized();try{await this.isValidApprove(r)}catch($e){throw this.client.logger.error("approve() -> isValidApprove() failed"),$e}const{id:n,relayProtocol:a,namespaces:f,sessionProperties:g,sessionConfig:w}=r;let C;try{C=this.client.proposal.get(n)}catch($e){throw this.client.logger.error(`approve() -> proposal.get(${n}) failed`),$e}let{pairingTopic:_,proposer:A,requiredNamespaces:T,optionalNamespaces:k}=C;_=_||"";const J=await this.client.core.crypto.generateKeyPair(),B=A.publicKey,ue=await this.client.core.crypto.generateSharedKey(J,B),ve=Ct(Ct({relay:{protocol:a??"irn"},namespaces:f,pairingTopic:_,controller:{publicKey:J,metadata:this.client.metadata},expiry:(0,y.gn4)(is)},g&&{sessionProperties:g}),w&&{sessionConfig:w});await this.client.core.relayer.subscribe(ue);const be=ji(Ct({},ve),{topic:ue,requiredNamespaces:T,optionalNamespaces:k,pairingTopic:_,acknowledged:!1,self:ve.controller,peer:{publicKey:A.publicKey,metadata:A.metadata},controller:J});await this.client.session.set(ue,be);try{await this.sendResult({id:n,topic:_,result:{relay:{protocol:a??"irn"},responderPublicKey:J},throwOnFailedPublish:!0}),await this.sendRequest({topic:ue,method:"wc_sessionSettle",params:ve,throwOnFailedPublish:!0})}catch($e){throw this.client.logger.error($e),this.client.session.delete(ue,(0,y.D6H)("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(ue),$e}return await this.client.core.pairing.updateMetadata({topic:_,metadata:A.metadata}),await this.client.proposal.delete(n,(0,y.D6H)("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}),await this.setExpiry(ue,(0,y.gn4)(is)),{topic:ue,acknowledged:()=>new Promise($e=>setTimeout(()=>$e(this.client.session.get(ue)),500))}},this.reject=async r=>{await this.isInitialized();try{await this.isValidReject(r)}catch(g){throw this.client.logger.error("reject() -> isValidReject() failed"),g}const{id:n,reason:a}=r;let f;try{f=this.client.proposal.get(n).pairingTopic}catch(g){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),g}f&&(await this.sendError({id:n,topic:f,error:a}),await this.client.proposal.delete(n,(0,y.D6H)("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized();try{await this.isValidUpdate(r)}catch(T){throw this.client.logger.error("update() -> isValidUpdate() failed"),T}const{topic:n,namespaces:a}=r,{done:f,resolve:g,reject:w}=(0,y.H1S)(),C=_i(),_=Mi().toString(),A=this.client.session.get(n).namespaces;return this.events.once((0,y.E0T)("session_update",C),({error:T})=>{T?w(T):g()}),await this.client.session.update(n,{namespaces:a}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a},throwOnFailedPublish:!0,clientRpcId:C,relayRpcId:_}).catch(T=>{this.client.logger.error(T),this.client.session.update(n,{namespaces:A}),w(T)}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized();try{await this.isValidExtend(r)}catch(C){throw this.client.logger.error("extend() -> isValidExtend() failed"),C}const{topic:n}=r,a=_i(),{done:f,resolve:g,reject:w}=(0,y.H1S)();return this.events.once((0,y.E0T)("session_extend",a),({error:C})=>{C?w(C):g()}),await this.setExpiry(n,(0,y.gn4)(is)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:a,throwOnFailedPublish:!0}).catch(C=>{w(C)}),{acknowledged:f}},this.request=async r=>{await this.isInitialized();try{await this.isValidRequest(r)}catch(J){throw this.client.logger.error("request() -> isValidRequest() failed"),J}const{chainId:n,request:a,topic:f,expiry:g=wr.wc_sessionRequest.req.ttl}=r,w=this.client.session.get(f),C=_i(),_=Mi().toString(),{done:A,resolve:T,reject:k}=(0,y.H1S)(g,"Request expired. Please try again.");return this.events.once((0,y.E0T)("session_request",C),({error:J,result:B})=>{J?k(J):T(B)}),await Promise.all([new Promise(async J=>{await this.sendRequest({clientRpcId:C,relayRpcId:_,topic:f,method:"wc_sessionRequest",params:{request:ji(Ct({},a),{expiryTimestamp:(0,y.gn4)(g)}),chainId:n},expiry:g,throwOnFailedPublish:!0}).catch(B=>k(B)),this.client.events.emit("session_request_sent",{topic:f,request:a,chainId:n,id:C}),J()}),new Promise(async J=>{var B;if(!((B=w.sessionConfig)!=null&&B.disableDeepLink)){const ue=await(0,y.bW6)(this.client.core.storage,Yc);(0,y.HhN)({id:C,topic:f,wcDeepLink:ue})}J()}),A()]).then(J=>J[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:a}=r,{id:f}=a;Xr(a)?await this.sendResult({id:f,topic:n,result:a.result,throwOnFailedPublish:!0}):Tr(a)&&await this.sendError({id:f,topic:n,error:a.error}),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized();try{await this.isValidPing(r)}catch(a){throw this.client.logger.error("ping() -> isValidPing() failed"),a}const{topic:n}=r;if(this.client.session.keys.includes(n)){const a=_i(),f=Mi().toString(),{done:g,resolve:w,reject:C}=(0,y.H1S)();this.events.once((0,y.E0T)("session_ping",a),({error:_})=>{_?C(_):w()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:f}),g()])}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:a,chainId:f}=r,g=Mi().toString();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:f},throwOnFailedPublish:!0,relayRpcId:g})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:(0,y.D6H)("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:a}=(0,y.kCb)("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(a)}},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>(0,y.Ih8)(n,r))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async r=>{this.isInitialized(),this.isValidAuthenticate(r);const{chains:n,statement:a="",uri:f,domain:g,nonce:w,type:C,exp:_,nbf:A,methods:T=[],expiry:k}=r,J=[...r.resources||[]],{topic:B,uri:ue}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"]});this.client.logger.info({message:"Generated new pairing",pairing:{topic:B,uri:ue}});const ve=await this.client.core.crypto.generateKeyPair(),be=(0,y.YmJ)(ve);if(await Promise.all([this.client.auth.authKeys.set(nn,{responseTopic:be,publicKey:ve}),this.client.auth.pairingTopics.set(be,{topic:be,pairingTopic:B})]),await this.client.core.relayer.subscribe(be),this.client.logger.info(`sending request to new pairing topic: ${B}`),T.length>0){const{namespace:_r}=(0,y.DQe)(n[0]);let Ht=(0,y.IkP)(_r,"request",T);(0,y.hA9)(J)&&(Ht=(0,y.qJM)(Ht,J.pop())),J.push(Ht)}const $e=k&&k>wr.wc_sessionAuthenticate.req.ttl?k:wr.wc_sessionAuthenticate.req.ttl,qe={authPayload:{type:C??"caip122",chains:n,statement:a,aud:f,domain:g,version:"1",nonce:w,iat:new Date().toISOString(),exp:_,nbf:A,resources:J},requester:{publicKey:ve,metadata:this.client.metadata},expiryTimestamp:(0,y.gn4)($e)},Ue={eip155:{chains:n,methods:[...new Set(["personal_sign",...T])],events:["chainChanged","accountsChanged"]}},ze={requiredNamespaces:{},optionalNamespaces:Ue,relays:[{protocol:"irn"}],proposer:{publicKey:ve,metadata:this.client.metadata},expiryTimestamp:(0,y.gn4)(wr.wc_sessionPropose.req.ttl)},{done:wt,resolve:rt,reject:Ot}=(0,y.H1S)($e,"Request expired"),br=async({error:_r,session:Ht})=>{if(this.events.off((0,y.E0T)("session_request",Pi),Ss),_r)Ot(_r);else if(Ht){Ht.self.publicKey=ve,await this.client.session.set(Ht.topic,Ht),await this.setExpiry(Ht.topic,Ht.expiry),B&&await this.client.core.pairing.updateMetadata({topic:B,metadata:Ht.peer.metadata});const Ui=this.client.session.get(Ht.topic);await this.deleteProposal($i),rt({session:Ui})}},Ss=async _r=>{if(await this.deletePendingAuthRequest(Pi,{message:"fulfilled",code:0}),_r.error){const ri=(0,y.D6H)("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return _r.error.code===ri.code?void 0:(this.events.off((0,y.E0T)("session_connect"),br),Ot(_r.error.message))}await this.deleteProposal($i),this.events.off((0,y.E0T)("session_connect"),br);const{cacaos:Ht,responder:Ui}=_r.result,Rs=[],ti=[];for(const ri of Ht){await(0,y.c4l)({cacao:ri,projectId:this.client.core.projectId})||(this.client.logger.error(ri,"Signature verification failed"),Ot((0,y.D6H)("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:pr}=ri,Cs=(0,y.hA9)(pr.resources),un=[(0,y.DJo)(pr.iss)],Po=(0,y.NmC)(pr.iss);if(Cs){const ii=(0,y.Y31)(Cs),ns=(0,y.ouN)(Cs);Rs.push(...ii),un.push(...ns)}for(const ii of un)ti.push(`${ii}:${Po}`)}const Er=await this.client.core.crypto.generateSharedKey(ve,Ui.publicKey);let ss;Rs.length>0&&(ss={topic:Er,acknowledged:!0,self:{publicKey:ve,metadata:this.client.metadata},peer:Ui,controller:Ui.publicKey,expiry:(0,y.gn4)(is),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:B,namespaces:(0,y.E12)([...new Set(Rs)],[...new Set(ti)])},await this.client.core.relayer.subscribe(Er),await this.client.session.set(Er,ss),ss=this.client.session.get(Er)),rt({auths:Ht,session:ss})},Pi=_i(),$i=_i();this.events.once((0,y.E0T)("session_connect"),br),this.events.once((0,y.E0T)("session_request",Pi),Ss);try{await Promise.all([this.sendRequest({topic:B,method:"wc_sessionAuthenticate",params:qe,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:Pi}),this.sendRequest({topic:B,method:"wc_sessionPropose",params:ze,expiry:wr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:$i})])}catch(_r){throw this.events.off((0,y.E0T)("session_connect"),br),this.events.off((0,y.E0T)("session_request",Pi),Ss),_r}return await this.setProposal($i,Ct({id:$i},ze)),await this.setAuthRequest(Pi,{request:ji(Ct({},qe),{verifyContext:{}}),pairingTopic:B}),{uri:ue,response:wt}},this.approveSessionAuthenticate=async r=>{this.isInitialized();const{id:n,auths:a}=r,f=this.getPendingAuthRequest(n);if(!f)throw new Error(`Could not find pending auth request with id ${n}`);const g=f.requester.publicKey,w=await this.client.core.crypto.generateKeyPair(),C=(0,y.YmJ)(g),_={type:y.rVF,receiverPublicKey:g,senderPublicKey:w},A=[],T=[];for(const B of a){if(!await(0,y.c4l)({cacao:B,projectId:this.client.core.projectId})){const qe=(0,y.D6H)("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:C,error:qe,encodeOpts:_}),new Error(qe.message)}const{p:ue}=B,ve=(0,y.hA9)(ue.resources),be=[(0,y.DJo)(ue.iss)],$e=(0,y.NmC)(ue.iss);if(ve){const qe=(0,y.Y31)(ve),Ue=(0,y.ouN)(ve);A.push(...qe),be.push(...Ue)}for(const qe of be)T.push(`${qe}:${$e}`)}const k=await this.client.core.crypto.generateSharedKey(w,g);let J;return(A==null?void 0:A.length)>0&&(J={topic:k,acknowledged:!0,self:{publicKey:w,metadata:this.client.metadata},peer:{publicKey:g,metadata:f.requester.metadata},controller:g,expiry:(0,y.gn4)(is),authentication:a,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:"",namespaces:(0,y.E12)([...new Set(A)],[...new Set(T)])},await this.client.core.relayer.subscribe(k),await this.client.session.set(k,J)),await this.sendResult({topic:C,id:n,result:{cacaos:a,responder:{publicKey:w,metadata:this.client.metadata}},encodeOpts:_,throwOnFailedPublish:!0}),await this.client.auth.requests.delete(n,{message:"fullfilled",code:0}),await this.client.core.pairing.activate({topic:f.pairingTopic}),{session:J}},this.rejectSessionAuthenticate=async r=>{await this.isInitialized();const{id:n,reason:a}=r,f=this.getPendingAuthRequest(n);if(!f)throw new Error(`Could not find pending auth request with id ${n}`);const g=f.requester.publicKey,w=await this.client.core.crypto.generateKeyPair(),C=(0,y.YmJ)(g),_={type:y.rVF,receiverPublicKey:g,senderPublicKey:w};await this.sendError({id:n,topic:C,error:a,encodeOpts:_}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,(0,y.D6H)("USER_DISCONNECTED"))},this.formatAuthMessage=r=>{this.isInitialized();const{request:n,iss:a}=r;return(0,y.wvx)(n,a)},this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(f=>{var g,w;return((g=f.peerMetadata)==null?void 0:g.url)&&((w=f.peerMetadata)==null?void 0:w.url)===r.peer.metadata.url&&f.topic&&f.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(f=>this.client.core.pairing.disconnect({topic:f.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async r=>{const{topic:n,expirerHasDeleted:a=!1,emitEvent:f=!0,id:g=0}=r,{self:w}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,(0,y.D6H)("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(w.publicKey)&&await this.client.core.crypto.deleteKeyPair(w.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),a||this.client.core.expirer.del(n),this.client.core.storage.removeItem(Yc).catch(C=>this.client.logger.warn(C)),this.getPendingSessionRequests().forEach(C=>{C.topic===n&&this.deletePendingSessionRequest(C.id,(0,y.D6H)("USER_DISCONNECTED"))}),f&&this.client.events.emit("session_delete",{id:g,topic:n})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,(0,y.D6H)("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")},this.deletePendingSessionRequest=async(r,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(f=>f.id!==r),a&&(this.sessionRequestQueue.state=ui.idle,this.client.events.emit("session_request_expire",{id:r}))},this.deletePendingAuthRequest=async(r,n,a=!1)=>{await Promise.all([this.client.auth.requests.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,n),await this.client.session.update(r,{expiry:n}))},this.setProposal=async(r,n)=>{this.client.core.expirer.set(r,(0,y.gn4)(wr.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,n)},this.setAuthRequest=async(r,n)=>{const{request:a,pairingTopic:f}=n;this.client.core.expirer.set(r,a.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:a.authPayload,requester:a.requester,expiryTimestamp:a.expiryTimestamp,id:r,pairingTopic:f,verifyContext:a.verifyContext})},this.setPendingSessionRequest=async r=>{const{id:n,topic:a,params:f,verifyContext:g}=r,w=f.request.expiryTimestamp||(0,y.gn4)(wr.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,w),await this.client.pendingRequest.set(n,{id:n,topic:a,params:f,verifyContext:g})},this.sendRequest=async r=>{const{topic:n,method:a,params:f,expiry:g,relayRpcId:w,clientRpcId:C,throwOnFailedPublish:_}=r,A=es(a,f,C);if((0,y.jUY)()&&Ag.includes(a)){const J=(0,y.rjm)(JSON.stringify(A));this.client.core.verify.register({attestationId:J})}let T;try{T=await this.client.core.crypto.encode(n,A)}catch(J){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),J}const k=wr[a].req;return g&&(k.ttl=g),w&&(k.id=w),this.client.core.history.set(n,A),_?(k.internal=ji(Ct({},k.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,T,k)):this.client.core.relayer.publish(n,T,k).catch(J=>this.client.logger.error(J)),A.id},this.sendResult=async r=>{const{id:n,topic:a,result:f,throwOnFailedPublish:g,encodeOpts:w}=r,C=Xs(n,f);let _;try{_=await this.client.core.crypto.encode(a,C,w)}catch(k){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${a} failed`),k}let A;try{A=await this.client.core.history.get(a,n)}catch(k){throw this.client.logger.error(`sendResult() -> history.get(${a}, ${n}) failed`),k}const T=wr[A.request.method].res;g?(T.internal=ji(Ct({},T.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,_,T)):this.client.core.relayer.publish(a,_,T).catch(k=>this.client.logger.error(k)),await this.client.core.history.resolve(C)},this.sendError=async r=>{const{id:n,topic:a,error:f,encodeOpts:g}=r,w=en(n,f);let C;try{C=await this.client.core.crypto.encode(a,w,g)}catch(T){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${a} failed`),T}let _;try{_=await this.client.core.history.get(a,n)}catch(T){throw this.client.logger.error(`sendError() -> history.get(${a}, ${n}) failed`),T}const A=wr[_.request.method].res;this.client.core.relayer.publish(a,C,A),await this.client.core.history.resolve(w)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(a=>{let f=!1;(0,y.BwD)(a.expiry)&&(f=!0),this.client.core.crypto.keychain.has(a.topic)||(f=!0),f&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{(0,y.BwD)(a.expiryTimestamp)&&n.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession({topic:a})),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ui.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ui.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ui.idle},this.processRequest=r=>{const{topic:n,payload:a}=r,f=a.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:f}))switch(f){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);case"wc_sessionAuthenticate":return this.onSessionAuthenticateRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${f}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:a}=r,f=(await this.client.core.history.get(n,a.id)).request.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${f}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:a}=(0,y.kCb)("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.shouldIgnorePairingRequest=r=>{const{topic:n,requestMethod:a}=r,f=this.expectedPairingMethodMap.get(n);return!f||f.includes(a)?!1:!!(f.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async(r,n)=>{const{params:a,id:f}=n;try{this.isValidConnect(Ct({},n.params));const g=a.expiryTimestamp||(0,y.gn4)(wr.wc_sessionPropose.req.ttl),w=Ct({id:f,pairingTopic:r,expiryTimestamp:g},a);await this.setProposal(f,w);const C=(0,y.rjm)(JSON.stringify(n)),_=await this.getVerifyContext(C,w.proposer.metadata);this.client.events.emit("session_proposal",{id:f,params:w,verifyContext:_})}catch(g){await this.sendError({id:f,topic:r,error:g}),this.client.logger.error(g)}},this.onSessionProposeResponse=async(r,n)=>{const{id:a}=n;if(Xr(n)){const{result:f}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:f});const g=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:g});const w=g.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:w});const C=f.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:C});const _=await this.client.core.crypto.generateSharedKey(w,C);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:_});const A=await this.client.core.relayer.subscribe(_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:A}),await this.client.core.pairing.activate({topic:r})}else if(Tr(n)){await this.client.proposal.delete(a,(0,y.D6H)("USER_DISCONNECTED"));const f=(0,y.E0T)("session_connect");if(this.events.listenerCount(f)===0)throw new Error(`emitting ${f} without any listeners, 954`);this.events.emit((0,y.E0T)("session_connect"),{error:n.error})}},this.onSessionSettleRequest=async(r,n)=>{const{id:a,params:f}=n;try{this.isValidSessionSettleRequest(f);const{relay:g,controller:w,expiry:C,namespaces:_,sessionProperties:A,pairingTopic:T,sessionConfig:k}=n.params,J=Ct(Ct({topic:r,relay:g,expiry:C,namespaces:_,acknowledged:!0,pairingTopic:T,requiredNamespaces:{},optionalNamespaces:{},controller:w.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:w.publicKey,metadata:w.metadata}},A&&{sessionProperties:A}),k&&{sessionConfig:k});await this.sendResult({id:n.id,topic:r,result:!0,throwOnFailedPublish:!0});const B=(0,y.E0T)("session_connect");if(this.events.listenerCount(B)===0)throw new Error(`emitting ${B} without any listeners 997`);this.events.emit((0,y.E0T)("session_connect"),{session:J}),this.cleanupDuplicatePairings(J)}catch(g){await this.sendError({id:a,topic:r,error:g}),this.client.logger.error(g)}},this.onSessionSettleResponse=async(r,n)=>{const{id:a}=n;Xr(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit((0,y.E0T)("session_approve",a),{})):Tr(n)&&(await this.client.session.delete(r,(0,y.D6H)("USER_DISCONNECTED")),this.events.emit((0,y.E0T)("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:a,id:f}=n;try{const g=`${r}_session_update`,w=y.O6B.get(g);if(w&&this.isRequestOutOfSync(w,f)){this.client.logger.info(`Discarding out of sync request - ${f}`),this.sendError({id:f,topic:r,error:(0,y.D6H)("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Ct({topic:r},a));try{y.O6B.set(g,f),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:f,topic:r,result:!0,throwOnFailedPublish:!0})}catch(C){throw y.O6B.delete(g),C}this.client.events.emit("session_update",{id:f,topic:r,params:a})}catch(g){await this.sendError({id:f,topic:r,error:g}),this.client.logger.error(g)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:a}=n,f=(0,y.E0T)("session_update",a);if(this.events.listenerCount(f)===0)throw new Error(`emitting ${f} without any listeners`);Xr(n)?this.events.emit((0,y.E0T)("session_update",a),{}):Tr(n)&&this.events.emit((0,y.E0T)("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:a}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,(0,y.gn4)(is)),await this.sendResult({id:a,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(f){await this.sendError({id:a,topic:r,error:f}),this.client.logger.error(f)}},this.onSessionExtendResponse=(r,n)=>{const{id:a}=n,f=(0,y.E0T)("session_extend",a);if(this.events.listenerCount(f)===0)throw new Error(`emitting ${f} without any listeners`);Xr(n)?this.events.emit((0,y.E0T)("session_extend",a),{}):Tr(n)&&this.events.emit((0,y.E0T)("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:a}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(f){await this.sendError({id:a,topic:r,error:f}),this.client.logger.error(f)}},this.onSessionPingResponse=(r,n)=>{const{id:a}=n,f=(0,y.E0T)("session_ping",a);if(this.events.listenerCount(f)===0)throw new Error(`emitting ${f} without any listeners`);setTimeout(()=>{Xr(n)?this.events.emit((0,y.E0T)("session_ping",a),{}):Tr(n)&&this.events.emit((0,y.E0T)("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(f=>{this.client.core.relayer.once(fr.publish,async()=>{f(await this.deleteSession({topic:r,id:a}))})}),this.sendResult({id:a,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:(0,y.D6H)("USER_DISCONNECTED")})])}catch(f){this.client.logger.error(f)}},this.onSessionRequest=async(r,n)=>{var a;const{id:f,params:g}=n;try{await this.isValidRequest(Ct({topic:r},g));const w=(0,y.rjm)(JSON.stringify(es("wc_sessionRequest",g,f))),C=this.client.session.get(r),_=await this.getVerifyContext(w,C.peer.metadata),A={id:f,topic:r,params:g,verifyContext:_};await this.setPendingSessionRequest(A),(a=this.client.signConfig)!=null&&a.disableRequestQueue?this.emitSessionRequest(A):(this.addSessionRequestToSessionRequestQueue(A),this.processSessionRequestQueue())}catch(w){await this.sendError({id:f,topic:r,error:w}),this.client.logger.error(w)}},this.onSessionRequestResponse=(r,n)=>{const{id:a}=n,f=(0,y.E0T)("session_request",a);if(this.events.listenerCount(f)===0)throw new Error(`emitting ${f} without any listeners`);Xr(n)?this.events.emit((0,y.E0T)("session_request",a),{result:n.result}):Tr(n)&&this.events.emit((0,y.E0T)("session_request",a),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:a,params:f}=n;try{const g=`${r}_session_event_${f.event.name}`,w=y.O6B.get(g);if(w&&this.isRequestOutOfSync(w,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(Ct({topic:r},f)),this.client.events.emit("session_event",{id:a,topic:r,params:f}),y.O6B.set(g,a)}catch(g){await this.sendError({id:a,topic:r,error:g}),this.client.logger.error(g)}},this.onSessionAuthenticateResponse=(r,n)=>{const{id:a}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:n}),Xr(n)?this.events.emit((0,y.E0T)("session_request",a),{result:n.result}):Tr(n)&&this.events.emit((0,y.E0T)("session_request",a),{error:n.error})},this.onSessionAuthenticateRequest=async(r,n)=>{const{requester:a,authPayload:f,expiryTimestamp:g}=n.params,w=(0,y.rjm)(JSON.stringify(n)),C=await this.getVerifyContext(w,this.client.metadata),_={requester:a,pairingTopic:r,id:n.id,authPayload:f,verifyContext:C,expiryTimestamp:g};await this.setAuthRequest(n.id,{request:_,pairingTopic:r}),this.client.events.emit("session_authenticate",{topic:r,params:n.params,id:n.id})},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ui.idle,this.processSessionRequestQueue()},(0,Z.toMiliseconds)(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:r,error:n})=>{const a=this.client.core.history.pending;a.length>0&&a.filter(f=>f.topic===r&&f.request.method==="wc_sessionRequest").forEach(f=>{const g=f.request.id,w=(0,y.E0T)("session_request",g);if(this.events.listenerCount(w)===0)throw new Error(`emitting ${w} without any listeners`);this.events.emit((0,y.E0T)("session_request",f.request.id),{error:n})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ui.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ui.active,this.emitSessionRequest(r)}catch(n){this.client.logger.error(n)}},this.emitSessionRequest=r=>{this.client.events.emit("session_request",r)},this.onPairingCreated=r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,es("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!(0,y.EJd)(r)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(C)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:f,sessionProperties:g,relays:w}=r;if((0,y.o8e)(n)||await this.isValidPairingTopic(n),!(0,y.PMr)(w,!0)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`connect() relays: ${w}`);throw new Error(C)}!(0,y.o8e)(a)&&(0,y.L5o)(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!(0,y.o8e)(f)&&(0,y.L5o)(f)!==0&&this.validateNamespaces(f,"optionalNamespaces"),(0,y.o8e)(g)||this.validateSessionProps(g,"sessionProperties")},this.validateNamespaces=(r,n)=>{const a=(0,y.naP)(r,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!(0,y.EJd)(r))throw new Error((0,y.kCb)("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:a,relayProtocol:f,sessionProperties:g}=r;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const w=this.client.proposal.get(n),C=(0,y.ing)(a,"approve()");if(C)throw new Error(C.message);const _=(0,y.rFo)(w.requiredNamespaces,a,"approve()");if(_)throw new Error(_.message);if(!(0,y.M_r)(f,!0)){const{message:A}=(0,y.kCb)("MISSING_OR_INVALID",`approve() relayProtocol: ${f}`);throw new Error(A)}(0,y.o8e)(g)||this.validateSessionProps(g,"sessionProperties")},this.isValidReject=async r=>{if(!(0,y.EJd)(r)){const{message:f}=(0,y.kCb)("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(f)}const{id:n,reason:a}=r;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!(0,y.H4H)(a)){const{message:f}=(0,y.kCb)("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidSessionSettleRequest=r=>{if(!(0,y.EJd)(r)){const{message:_}=(0,y.kCb)("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(_)}const{relay:n,controller:a,namespaces:f,expiry:g}=r;if(!(0,y.Z26)(n)){const{message:_}=(0,y.kCb)("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(_)}const w=(0,y.DdM)(a,"onSessionSettleRequest()");if(w)throw new Error(w.message);const C=(0,y.ing)(f,"onSessionSettleRequest()");if(C)throw new Error(C.message);if((0,y.BwD)(g)){const{message:_}=(0,y.kCb)("EXPIRED","onSessionSettleRequest()");throw new Error(_)}},this.isValidUpdate=async r=>{if(!(0,y.EJd)(r)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(C)}const{topic:n,namespaces:a}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const f=this.client.session.get(n),g=(0,y.ing)(a,"update()");if(g)throw new Error(g.message);const w=(0,y.rFo)(f.requiredNamespaces,a,"update()");if(w)throw new Error(w.message)},this.isValidExtend=async r=>{if(!(0,y.EJd)(r)){const{message:a}=(0,y.kCb)("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:n}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!(0,y.EJd)(r)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(C)}const{topic:n,request:a,chainId:f,expiry:g}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:w}=this.client.session.get(n);if(!(0,y.p8o)(w,f)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`request() chainId: ${f}`);throw new Error(C)}if(!(0,y.hHR)(a)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(C)}if(!(0,y.alS)(w,f,a.method)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(C)}if(g&&!(0,y.ONw)(g,vo)){const{message:C}=(0,y.kCb)("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${vo.min} and ${vo.max}`);throw new Error(C)}},this.isValidRespond=async r=>{var n;if(!(0,y.EJd)(r)){const{message:g}=(0,y.kCb)("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(g)}const{topic:a,response:f}=r;try{await this.isValidSessionTopic(a)}catch(g){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),g}if(!(0,y.JTI)(f)){const{message:g}=(0,y.kCb)("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(f)}`);throw new Error(g)}},this.isValidPing=async r=>{if(!(0,y.EJd)(r)){const{message:a}=(0,y.kCb)("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!(0,y.EJd)(r)){const{message:w}=(0,y.kCb)("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(w)}const{topic:n,event:a,chainId:f}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!(0,y.p8o)(g,f)){const{message:w}=(0,y.kCb)("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw new Error(w)}if(!(0,y.nfW)(a)){const{message:w}=(0,y.kCb)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(w)}if(!(0,y.B95)(g,f,a.name)){const{message:w}=(0,y.kCb)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(w)}},this.isValidDisconnect=async r=>{if(!(0,y.EJd)(r)){const{message:a}=(0,y.kCb)("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidAuthenticate=r=>{const{chains:n,uri:a,domain:f,nonce:g}=r;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!(0,y.M_r)(a,!1))throw new Error("uri is required parameter");if(!(0,y.M_r)(f,!1))throw new Error("domain is required parameter");if(!(0,y.M_r)(g,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(C=>(0,y.DQe)(C).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:w}=(0,y.DQe)(n[0]);if(w!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async(r,n)=>{const a={verified:{verifyUrl:n.verifyUrl||rs,validation:"UNKNOWN",origin:n.url||""}};try{const f=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});f&&(a.verified.origin=f.origin,a.verified.isScam=f.isScam,a.verified.validation=f.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(f){this.client.logger.info(f)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(a=>{if(!(0,y.M_r)(a,!1)){const{message:f}=(0,y.kCb)("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(f)}})},this.getPendingAuthRequest=r=>{const n=this.client.auth.requests.get(r);return typeof n=="object"?n:void 0},this.addToRecentlyDeleted=(r,n)=>{if(this.recentlyDeletedMap.set(r,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let a=0;const f=this.recentlyDeletedLimit/2;for(const g of this.recentlyDeletedMap.keys()){if(a++>=f)break;this.recentlyDeletedMap.delete(g)}}},this.checkRecentlyDeleted=r=>{const n=this.recentlyDeletedMap.get(r);if(n){const{message:a}=(0,y.kCb)("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${r}`);throw new Error(a)}}}async isInitialized(){if(!this.initialized){const{message:t}=(0,y.kCb)("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(fr.message,async t=>{const{topic:r,message:n}=t,{publicKey:a}=this.client.auth.authKeys.keys.includes(nn)?this.client.auth.authKeys.get(nn):{responseTopic:void 0,publicKey:void 0},f=await this.client.core.crypto.decode(r,n,{receiverPublicKey:a});try{oo(f)?(this.client.core.history.set(r,f),this.onRelayEventRequest({topic:r,payload:f})):tn(f)?(await this.client.core.history.resolve(f),await this.onRelayEventResponse({topic:r,payload:f}),this.client.core.history.delete(r,f.id)):this.onRelayEventUnknownPayload({topic:r,payload:f})}catch(g){this.client.logger.error(g)}})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async t=>{const{topic:r,id:n}=(0,y.iPz)(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,(0,y.kCb)("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,(0,y.kCb)("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(ts.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(ts.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!(0,y.M_r)(t,!1)){const{message:r}=(0,y.kCb)("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=(0,y.kCb)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if((0,y.BwD)(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=(0,y.kCb)("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!(0,y.M_r)(t,!1)){const{message:r}=(0,y.kCb)("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){const{message:r}=(0,y.kCb)("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if((0,y.BwD)(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:r}=(0,y.kCb)("EXPIRED",`session topic: ${t}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(t)){const{message:r}=(0,y.kCb)("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if((0,y.M_r)(t,!1)){const{message:r}=(0,y.kCb)("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=(0,y.kCb)("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!(0,y.Q01)(t)){const{message:r}=(0,y.kCb)("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=(0,y.kCb)("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if((0,y.BwD)(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:r}=(0,y.kCb)("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class Ug extends ki{constructor(t,r){super(t,r,Sg,yo),this.core=t,this.logger=r}}class Bg extends ki{constructor(t,r){super(t,r,Rg,yo),this.core=t,this.logger=r}}class Hg extends ki{constructor(t,r){super(t,r,Og,yo,n=>n.id),this.core=t,this.logger=r}}class Kg extends ki{constructor(t,r){super(t,r,Ng,sn,()=>nn),this.core=t,this.logger=r}}class Vg extends ki{constructor(t,r){super(t,r,Fg,sn),this.core=t,this.logger=r}}class Gg extends ki{constructor(t,r){super(t,r,qg,sn,n=>n.id),this.core=t,this.logger=r}}class Jg{constructor(t,r){this.core=t,this.logger=r,this.authKeys=new Kg(this.core,this.logger),this.pairingTopics=new Vg(this.core,this.logger),this.requests=new Gg(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class wo extends hf{constructor(t){super(t),this.protocol=Gc,this.version=Jc,this.name=mo.name,this.events=new Q.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.authenticate=async n=>{try{return await this.engine.authenticate(n)}catch(a){throw this.logger.error(a.message),a}},this.formatAuthMessage=n=>{try{return this.engine.formatAuthMessage(n)}catch(a){throw this.logger.error(a.message),a}},this.approveSessionAuthenticate=async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(a){throw this.logger.error(a.message),a}},this.rejectSessionAuthenticate=async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(a){throw this.logger.error(a.message),a}},this.name=(t==null?void 0:t.name)||mo.name,this.metadata=(t==null?void 0:t.metadata)||(0,y.DaH)(),this.signConfig=t==null?void 0:t.signConfig;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Hr()(yt({level:(t==null?void 0:t.logger)||mo.logger}));this.core=(t==null?void 0:t.core)||new Pg(t),this.logger=lr(r,this.name),this.session=new Bg(this.core,this.logger),this.proposal=new Ug(this.core,this.logger),this.pendingRequest=new Hg(this.core,this.logger),this.engine=new $g(this),this.auth=new Jg(this.core,this.logger)}static async init(t){const r=new wo(t);return await r.initialize(),r}get context(){return hr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),await this.auth.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const GE=null,JE=null;var Wg=ie(52830),eu=ie.n(Wg),Yg=Object.defineProperty,Qg=Object.defineProperties,Zg=Object.getOwnPropertyDescriptors,tu=Object.getOwnPropertySymbols,Xg=Object.prototype.hasOwnProperty,e0=Object.prototype.propertyIsEnumerable,ru=(u,t,r)=>t in u?Yg(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,iu=(u,t)=>{for(var r in t||(t={}))Xg.call(t,r)&&ru(u,r,t[r]);if(tu)for(var r of tu(t))e0.call(t,r)&&ru(u,r,t[r]);return u},su=(u,t)=>Qg(u,Zg(t));const t0={Accept:"application/json","Content-Type":"application/json"},r0="POST",nu={headers:t0,method:r0},ou=10;class xi{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Q.EventEmitter,this.isAvailable=!1,this.registering=!1,!lc(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=Fe(t),n=await(await eu()(this.url,su(iu({},nu),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!lc(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),a(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Fe({id:1,jsonrpc:"2.0",method:"test",params:[]});await eu()(t,su(iu({},nu),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Ge(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),a=n.message||n.toString(),f=en(t,a);this.events.emit("payload",f)}parseError(t,r=this.url){return uc(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ou&&this.events.setMaxListeners(ou)}}const au="error",i0="wss://relay.walletconnect.com",s0="wc",n0="universal_provider",cu=`${s0}@2:${n0}:`,o0="https://rpc.walletconnect.com/v1/",hi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Ps=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ie.g<"u"?ie.g:typeof self<"u"?self:{},bo={exports:{}};(function(u,t){(function(){var r,n="4.17.21",a=200,f="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",g="Expected a function",w="Invalid `variable` option passed into `_.template`",C="__lodash_hash_undefined__",_=500,A="__lodash_placeholder__",T=1,k=2,J=4,B=1,ue=2,ve=1,be=2,$e=4,qe=8,Ue=16,ze=32,wt=64,rt=128,Ot=256,br=512,Ss=30,Pi="...",$i=800,_r=16,Ht=1,Ui=2,Rs=3,ti=1/0,Er=9007199254740991,ss=17976931348623157e292,ri=0/0,pr=4294967295,Cs=pr-1,un=pr>>>1,Po=[["ary",rt],["bind",ve],["bindKey",be],["curry",qe],["curryRight",Ue],["flip",br],["partial",ze],["partialRight",wt],["rearg",Ot]],ii="[object Arguments]",ns="[object Array]",O0="[object AsyncFunction]",Os="[object Boolean]",As="[object Date]",A0="[object DOMException]",hn="[object Error]",ln="[object Function]",mu="[object GeneratorFunction]",Vr="[object Map]",Ds="[object Number]",D0="[object Null]",li="[object Object]",vu="[object Promise]",T0="[object Proxy]",Ts="[object RegExp]",Gr="[object Set]",Ns="[object String]",fn="[object Symbol]",N0="[object Undefined]",Fs="[object WeakMap]",F0="[object WeakSet]",qs="[object ArrayBuffer]",os="[object DataView]",So="[object Float32Array]",Ro="[object Float64Array]",Co="[object Int8Array]",Oo="[object Int16Array]",Ao="[object Int32Array]",Do="[object Uint8Array]",To="[object Uint8ClampedArray]",No="[object Uint16Array]",Fo="[object Uint32Array]",q0=/\b__p \+= '';/g,L0=/\b(__p \+=) '' \+/g,M0=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wu=/&(?:amp|lt|gt|quot|#39);/g,bu=/[&<>"']/g,k0=RegExp(wu.source),j0=RegExp(bu.source),z0=/<%-([\s\S]+?)%>/g,$0=/<%([\s\S]+?)%>/g,_u=/<%=([\s\S]+?)%>/g,U0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,B0=/^\w*$/,H0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qo=/[\\^$.*+?()[\]{}|]/g,K0=RegExp(qo.source),Lo=/^\s+/,V0=/\s/,G0=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,J0=/\{\n\/\* \[wrapped with (.+)\] \*/,W0=/,? & /,Y0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Q0=/[()=,{}\[\]\/\s]/,Z0=/\\(\\)?/g,X0=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Eu=/\w*$/,ey=/^[-+]0x[0-9a-f]+$/i,ty=/^0b[01]+$/i,ry=/^\[object .+?Constructor\]$/,iy=/^0o[0-7]+$/i,sy=/^(?:0|[1-9]\d*)$/,ny=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,pn=/($^)/,oy=/['\n\r\u2028\u2029\\]/g,dn="\\ud800-\\udfff",ay="\\u0300-\\u036f",cy="\\ufe20-\\ufe2f",uy="\\u20d0-\\u20ff",xu=ay+cy+uy,Iu="\\u2700-\\u27bf",Pu="a-z\\xdf-\\xf6\\xf8-\\xff",hy="\\xac\\xb1\\xd7\\xf7",ly="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fy="\\u2000-\\u206f",py=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Su="A-Z\\xc0-\\xd6\\xd8-\\xde",Ru="\\ufe0e\\ufe0f",Cu=hy+ly+fy+py,Mo="['\u2019]",dy="["+dn+"]",Ou="["+Cu+"]",gn="["+xu+"]",Au="\\d+",gy="["+Iu+"]",Du="["+Pu+"]",Tu="[^"+dn+Cu+Au+Iu+Pu+Su+"]",ko="\\ud83c[\\udffb-\\udfff]",yy="(?:"+gn+"|"+ko+")",Nu="[^"+dn+"]",jo="(?:\\ud83c[\\udde6-\\uddff]){2}",zo="[\\ud800-\\udbff][\\udc00-\\udfff]",as="["+Su+"]",Fu="\\u200d",qu="(?:"+Du+"|"+Tu+")",my="(?:"+as+"|"+Tu+")",Lu="(?:"+Mo+"(?:d|ll|m|re|s|t|ve))?",Mu="(?:"+Mo+"(?:D|LL|M|RE|S|T|VE))?",ku=yy+"?",ju="["+Ru+"]?",vy="(?:"+Fu+"(?:"+[Nu,jo,zo].join("|")+")"+ju+ku+")*",wy="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",by="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",zu=ju+ku+vy,_y="(?:"+[gy,jo,zo].join("|")+")"+zu,Ey="(?:"+[Nu+gn+"?",gn,jo,zo,dy].join("|")+")",xy=RegExp(Mo,"g"),Iy=RegExp(gn,"g"),$o=RegExp(ko+"(?="+ko+")|"+Ey+zu,"g"),Py=RegExp([as+"?"+Du+"+"+Lu+"(?="+[Ou,as,"$"].join("|")+")",my+"+"+Mu+"(?="+[Ou,as+qu,"$"].join("|")+")",as+"?"+qu+"+"+Lu,as+"+"+Mu,by,wy,Au,_y].join("|"),"g"),Sy=RegExp("["+Fu+dn+xu+Ru+"]"),Ry=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Cy=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Oy=-1,Xe={};Xe[So]=Xe[Ro]=Xe[Co]=Xe[Oo]=Xe[Ao]=Xe[Do]=Xe[To]=Xe[No]=Xe[Fo]=!0,Xe[ii]=Xe[ns]=Xe[qs]=Xe[Os]=Xe[os]=Xe[As]=Xe[hn]=Xe[ln]=Xe[Vr]=Xe[Ds]=Xe[li]=Xe[Ts]=Xe[Gr]=Xe[Ns]=Xe[Fs]=!1;var Ye={};Ye[ii]=Ye[ns]=Ye[qs]=Ye[os]=Ye[Os]=Ye[As]=Ye[So]=Ye[Ro]=Ye[Co]=Ye[Oo]=Ye[Ao]=Ye[Vr]=Ye[Ds]=Ye[li]=Ye[Ts]=Ye[Gr]=Ye[Ns]=Ye[fn]=Ye[Do]=Ye[To]=Ye[No]=Ye[Fo]=!0,Ye[hn]=Ye[ln]=Ye[Fs]=!1;var Ay={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Dy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ty={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ny={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fy=parseFloat,qy=parseInt,$u=typeof Ps=="object"&&Ps&&Ps.Object===Object&&Ps,Ly=typeof self=="object"&&self&&self.Object===Object&&self,Wt=$u||Ly||Function("return this")(),Uo=t&&!t.nodeType&&t,Bi=Uo&&!0&&u&&!u.nodeType&&u,Uu=Bi&&Bi.exports===Uo,Bo=Uu&&$u.process,qr=function(){try{var I=Bi&&Bi.require&&Bi.require("util").types;return I||Bo&&Bo.binding&&Bo.binding("util")}catch{}}(),Bu=qr&&qr.isArrayBuffer,Hu=qr&&qr.isDate,Ku=qr&&qr.isMap,Vu=qr&&qr.isRegExp,Gu=qr&&qr.isSet,Ju=qr&&qr.isTypedArray;function xr(I,F,D){switch(D.length){case 0:return I.call(F);case 1:return I.call(F,D[0]);case 2:return I.call(F,D[0],D[1]);case 3:return I.call(F,D[0],D[1],D[2])}return I.apply(F,D)}function My(I,F,D,re){for(var Ie=-1,Be=I==null?0:I.length;++Ie<Be;){var At=I[Ie];F(re,At,D(At),I)}return re}function Lr(I,F){for(var D=-1,re=I==null?0:I.length;++D<re&&F(I[D],D,I)!==!1;);return I}function ky(I,F){for(var D=I==null?0:I.length;D--&&F(I[D],D,I)!==!1;);return I}function Wu(I,F){for(var D=-1,re=I==null?0:I.length;++D<re;)if(!F(I[D],D,I))return!1;return!0}function Si(I,F){for(var D=-1,re=I==null?0:I.length,Ie=0,Be=[];++D<re;){var At=I[D];F(At,D,I)&&(Be[Ie++]=At)}return Be}function yn(I,F){var D=I==null?0:I.length;return!!D&&cs(I,F,0)>-1}function Ho(I,F,D){for(var re=-1,Ie=I==null?0:I.length;++re<Ie;)if(D(F,I[re]))return!0;return!1}function it(I,F){for(var D=-1,re=I==null?0:I.length,Ie=Array(re);++D<re;)Ie[D]=F(I[D],D,I);return Ie}function Ri(I,F){for(var D=-1,re=F.length,Ie=I.length;++D<re;)I[Ie+D]=F[D];return I}function Ko(I,F,D,re){var Ie=-1,Be=I==null?0:I.length;for(re&&Be&&(D=I[++Ie]);++Ie<Be;)D=F(D,I[Ie],Ie,I);return D}function jy(I,F,D,re){var Ie=I==null?0:I.length;for(re&&Ie&&(D=I[--Ie]);Ie--;)D=F(D,I[Ie],Ie,I);return D}function Vo(I,F){for(var D=-1,re=I==null?0:I.length;++D<re;)if(F(I[D],D,I))return!0;return!1}var zy=Go("length");function $y(I){return I.split("")}function Uy(I){return I.match(Y0)||[]}function Yu(I,F,D){var re;return D(I,function(Ie,Be,At){if(F(Ie,Be,At))return re=Be,!1}),re}function mn(I,F,D,re){for(var Ie=I.length,Be=D+(re?1:-1);re?Be--:++Be<Ie;)if(F(I[Be],Be,I))return Be;return-1}function cs(I,F,D){return F===F?em(I,F,D):mn(I,Qu,D)}function By(I,F,D,re){for(var Ie=D-1,Be=I.length;++Ie<Be;)if(re(I[Ie],F))return Ie;return-1}function Qu(I){return I!==I}function Zu(I,F){var D=I==null?0:I.length;return D?Wo(I,F)/D:ri}function Go(I){return function(F){return F==null?r:F[I]}}function Jo(I){return function(F){return I==null?r:I[F]}}function Xu(I,F,D,re,Ie){return Ie(I,function(Be,At,Je){D=re?(re=!1,Be):F(D,Be,At,Je)}),D}function Hy(I,F){var D=I.length;for(I.sort(F);D--;)I[D]=I[D].value;return I}function Wo(I,F){for(var D,re=-1,Ie=I.length;++re<Ie;){var Be=F(I[re]);Be!==r&&(D=D===r?Be:D+Be)}return D}function Yo(I,F){for(var D=-1,re=Array(I);++D<I;)re[D]=F(D);return re}function Ky(I,F){return it(F,function(D){return[D,I[D]]})}function eh(I){return I&&I.slice(0,sh(I)+1).replace(Lo,"")}function Ir(I){return function(F){return I(F)}}function Qo(I,F){return it(F,function(D){return I[D]})}function Ls(I,F){return I.has(F)}function th(I,F){for(var D=-1,re=I.length;++D<re&&cs(F,I[D],0)>-1;);return D}function rh(I,F){for(var D=I.length;D--&&cs(F,I[D],0)>-1;);return D}function Vy(I,F){for(var D=I.length,re=0;D--;)I[D]===F&&++re;return re}var Gy=Jo(Ay),Jy=Jo(Dy);function Wy(I){return"\\"+Ny[I]}function Yy(I,F){return I==null?r:I[F]}function us(I){return Sy.test(I)}function Qy(I){return Ry.test(I)}function Zy(I){for(var F,D=[];!(F=I.next()).done;)D.push(F.value);return D}function Zo(I){var F=-1,D=Array(I.size);return I.forEach(function(re,Ie){D[++F]=[Ie,re]}),D}function ih(I,F){return function(D){return I(F(D))}}function Ci(I,F){for(var D=-1,re=I.length,Ie=0,Be=[];++D<re;){var At=I[D];(At===F||At===A)&&(I[D]=A,Be[Ie++]=D)}return Be}function vn(I){var F=-1,D=Array(I.size);return I.forEach(function(re){D[++F]=re}),D}function Xy(I){var F=-1,D=Array(I.size);return I.forEach(function(re){D[++F]=[re,re]}),D}function em(I,F,D){for(var re=D-1,Ie=I.length;++re<Ie;)if(I[re]===F)return re;return-1}function tm(I,F,D){for(var re=D+1;re--;)if(I[re]===F)return re;return re}function hs(I){return us(I)?im(I):zy(I)}function Jr(I){return us(I)?sm(I):$y(I)}function sh(I){for(var F=I.length;F--&&V0.test(I.charAt(F)););return F}var rm=Jo(Ty);function im(I){for(var F=$o.lastIndex=0;$o.test(I);)++F;return F}function sm(I){return I.match($o)||[]}function nm(I){return I.match(Py)||[]}var om=function I(F){F=F==null?Wt:ls.defaults(Wt.Object(),F,ls.pick(Wt,Cy));var D=F.Array,re=F.Date,Ie=F.Error,Be=F.Function,At=F.Math,Je=F.Object,Xo=F.RegExp,am=F.String,Mr=F.TypeError,wn=D.prototype,cm=Be.prototype,fs=Je.prototype,bn=F["__core-js_shared__"],_n=cm.toString,Ve=fs.hasOwnProperty,um=0,nh=function(){var e=/[^.]+$/.exec(bn&&bn.keys&&bn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),En=fs.toString,hm=_n.call(Je),lm=Wt._,fm=Xo("^"+_n.call(Ve).replace(qo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xn=Uu?F.Buffer:r,Oi=F.Symbol,In=F.Uint8Array,oh=xn?xn.allocUnsafe:r,Pn=ih(Je.getPrototypeOf,Je),ah=Je.create,ch=fs.propertyIsEnumerable,Sn=wn.splice,uh=Oi?Oi.isConcatSpreadable:r,Ms=Oi?Oi.iterator:r,Hi=Oi?Oi.toStringTag:r,Rn=function(){try{var e=Wi(Je,"defineProperty");return e({},"",{}),e}catch{}}(),pm=F.clearTimeout!==Wt.clearTimeout&&F.clearTimeout,dm=re&&re.now!==Wt.Date.now&&re.now,gm=F.setTimeout!==Wt.setTimeout&&F.setTimeout,Cn=At.ceil,On=At.floor,ea=Je.getOwnPropertySymbols,ym=xn?xn.isBuffer:r,hh=F.isFinite,mm=wn.join,vm=ih(Je.keys,Je),Dt=At.max,rr=At.min,wm=re.now,bm=F.parseInt,lh=At.random,_m=wn.reverse,ta=Wi(F,"DataView"),ks=Wi(F,"Map"),ra=Wi(F,"Promise"),ps=Wi(F,"Set"),js=Wi(F,"WeakMap"),zs=Wi(Je,"create"),An=js&&new js,ds={},Em=Yi(ta),xm=Yi(ks),Im=Yi(ra),Pm=Yi(ps),Sm=Yi(js),Dn=Oi?Oi.prototype:r,$s=Dn?Dn.valueOf:r,fh=Dn?Dn.toString:r;function d(e){if(ft(e)&&!Pe(e)&&!(e instanceof Me)){if(e instanceof kr)return e;if(Ve.call(e,"__wrapped__"))return pl(e)}return new kr(e)}var gs=function(){function e(){}return function(s){if(!ot(s))return{};if(ah)return ah(s);e.prototype=s;var o=new e;return e.prototype=r,o}}();function Tn(){}function kr(e,s){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=r}d.templateSettings={escape:z0,evaluate:$0,interpolate:_u,variable:"",imports:{_:d}},d.prototype=Tn.prototype,d.prototype.constructor=d,kr.prototype=gs(Tn.prototype),kr.prototype.constructor=kr;function Me(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pr,this.__views__=[]}function Rm(){var e=new Me(this.__wrapped__);return e.__actions__=dr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=dr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=dr(this.__views__),e}function Cm(){if(this.__filtered__){var e=new Me(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Om(){var e=this.__wrapped__.value(),s=this.__dir__,o=Pe(e),h=s<0,p=o?e.length:0,m=$v(0,p,this.__views__),v=m.start,b=m.end,S=b-v,L=h?b:v-1,M=this.__iteratees__,U=M.length,X=0,ce=rr(S,this.__takeCount__);if(!o||!h&&p==S&&ce==S)return Lh(e,this.__actions__);var ge=[];e:for(;S--&&X<ce;){L+=s;for(var Oe=-1,ye=e[L];++Oe<U;){var Le=M[Oe],ke=Le.iteratee,Rr=Le.type,cr=ke(ye);if(Rr==Ui)ye=cr;else if(!cr){if(Rr==Ht)continue e;break e}}ge[X++]=ye}return ge}Me.prototype=gs(Tn.prototype),Me.prototype.constructor=Me;function Ki(e){var s=-1,o=e==null?0:e.length;for(this.clear();++s<o;){var h=e[s];this.set(h[0],h[1])}}function Am(){this.__data__=zs?zs(null):{},this.size=0}function Dm(e){var s=this.has(e)&&delete this.__data__[e];return this.size-=s?1:0,s}function Tm(e){var s=this.__data__;if(zs){var o=s[e];return o===C?r:o}return Ve.call(s,e)?s[e]:r}function Nm(e){var s=this.__data__;return zs?s[e]!==r:Ve.call(s,e)}function Fm(e,s){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=zs&&s===r?C:s,this}Ki.prototype.clear=Am,Ki.prototype.delete=Dm,Ki.prototype.get=Tm,Ki.prototype.has=Nm,Ki.prototype.set=Fm;function fi(e){var s=-1,o=e==null?0:e.length;for(this.clear();++s<o;){var h=e[s];this.set(h[0],h[1])}}function qm(){this.__data__=[],this.size=0}function Lm(e){var s=this.__data__,o=Nn(s,e);if(o<0)return!1;var h=s.length-1;return o==h?s.pop():Sn.call(s,o,1),--this.size,!0}function Mm(e){var s=this.__data__,o=Nn(s,e);return o<0?r:s[o][1]}function km(e){return Nn(this.__data__,e)>-1}function jm(e,s){var o=this.__data__,h=Nn(o,e);return h<0?(++this.size,o.push([e,s])):o[h][1]=s,this}fi.prototype.clear=qm,fi.prototype.delete=Lm,fi.prototype.get=Mm,fi.prototype.has=km,fi.prototype.set=jm;function pi(e){var s=-1,o=e==null?0:e.length;for(this.clear();++s<o;){var h=e[s];this.set(h[0],h[1])}}function zm(){this.size=0,this.__data__={hash:new Ki,map:new(ks||fi),string:new Ki}}function $m(e){var s=Kn(this,e).delete(e);return this.size-=s?1:0,s}function Um(e){return Kn(this,e).get(e)}function Bm(e){return Kn(this,e).has(e)}function Hm(e,s){var o=Kn(this,e),h=o.size;return o.set(e,s),this.size+=o.size==h?0:1,this}pi.prototype.clear=zm,pi.prototype.delete=$m,pi.prototype.get=Um,pi.prototype.has=Bm,pi.prototype.set=Hm;function Vi(e){var s=-1,o=e==null?0:e.length;for(this.__data__=new pi;++s<o;)this.add(e[s])}function Km(e){return this.__data__.set(e,C),this}function Vm(e){return this.__data__.has(e)}Vi.prototype.add=Vi.prototype.push=Km,Vi.prototype.has=Vm;function Wr(e){var s=this.__data__=new fi(e);this.size=s.size}function Gm(){this.__data__=new fi,this.size=0}function Jm(e){var s=this.__data__,o=s.delete(e);return this.size=s.size,o}function Wm(e){return this.__data__.get(e)}function Ym(e){return this.__data__.has(e)}function Qm(e,s){var o=this.__data__;if(o instanceof fi){var h=o.__data__;if(!ks||h.length<a-1)return h.push([e,s]),this.size=++o.size,this;o=this.__data__=new pi(h)}return o.set(e,s),this.size=o.size,this}Wr.prototype.clear=Gm,Wr.prototype.delete=Jm,Wr.prototype.get=Wm,Wr.prototype.has=Ym,Wr.prototype.set=Qm;function ph(e,s){var o=Pe(e),h=!o&&Qi(e),p=!o&&!h&&Fi(e),m=!o&&!h&&!p&&ws(e),v=o||h||p||m,b=v?Yo(e.length,am):[],S=b.length;for(var L in e)(s||Ve.call(e,L))&&!(v&&(L=="length"||p&&(L=="offset"||L=="parent")||m&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||mi(L,S)))&&b.push(L);return b}function dh(e){var s=e.length;return s?e[pa(0,s-1)]:r}function Zm(e,s){return Vn(dr(e),Gi(s,0,e.length))}function Xm(e){return Vn(dr(e))}function ia(e,s,o){(o!==r&&!Yr(e[s],o)||o===r&&!(s in e))&&di(e,s,o)}function Us(e,s,o){var h=e[s];(!(Ve.call(e,s)&&Yr(h,o))||o===r&&!(s in e))&&di(e,s,o)}function Nn(e,s){for(var o=e.length;o--;)if(Yr(e[o][0],s))return o;return-1}function ev(e,s,o,h){return Ai(e,function(p,m,v){s(h,p,o(p),v)}),h}function gh(e,s){return e&&ni(s,Kt(s),e)}function tv(e,s){return e&&ni(s,yr(s),e)}function di(e,s,o){s=="__proto__"&&Rn?Rn(e,s,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[s]=o}function sa(e,s){for(var o=-1,h=s.length,p=D(h),m=e==null;++o<h;)p[o]=m?r:ka(e,s[o]);return p}function Gi(e,s,o){return e===e&&(o!==r&&(e=e<=o?e:o),s!==r&&(e=e>=s?e:s)),e}function jr(e,s,o,h,p,m){var v,b=s&T,S=s&k,L=s&J;if(o&&(v=p?o(e,h,p,m):o(e)),v!==r)return v;if(!ot(e))return e;var M=Pe(e);if(M){if(v=Bv(e),!b)return dr(e,v)}else{var U=ir(e),X=U==ln||U==mu;if(Fi(e))return jh(e,b);if(U==li||U==ii||X&&!p){if(v=S||X?{}:sl(e),!b)return S?Tv(e,tv(v,e)):Dv(e,gh(v,e))}else{if(!Ye[U])return p?e:{};v=Hv(e,U,b)}}m||(m=new Wr);var ce=m.get(e);if(ce)return ce;m.set(e,v),Nl(e)?e.forEach(function(ye){v.add(jr(ye,s,o,ye,e,m))}):Dl(e)&&e.forEach(function(ye,Le){v.set(Le,jr(ye,s,o,Le,e,m))});var ge=L?S?Ia:xa:S?yr:Kt,Oe=M?r:ge(e);return Lr(Oe||e,function(ye,Le){Oe&&(Le=ye,ye=e[Le]),Us(v,Le,jr(ye,s,o,Le,e,m))}),v}function rv(e){var s=Kt(e);return function(o){return yh(o,e,s)}}function yh(e,s,o){var h=o.length;if(e==null)return!h;for(e=Je(e);h--;){var p=o[h],m=s[p],v=e[p];if(v===r&&!(p in e)||!m(v))return!1}return!0}function mh(e,s,o){if(typeof e!="function")throw new Mr(g);return Ws(function(){e.apply(r,o)},s)}function Bs(e,s,o,h){var p=-1,m=yn,v=!0,b=e.length,S=[],L=s.length;if(!b)return S;o&&(s=it(s,Ir(o))),h?(m=Ho,v=!1):s.length>=a&&(m=Ls,v=!1,s=new Vi(s));e:for(;++p<b;){var M=e[p],U=o==null?M:o(M);if(M=h||M!==0?M:0,v&&U===U){for(var X=L;X--;)if(s[X]===U)continue e;S.push(M)}else m(s,U,h)||S.push(M)}return S}var Ai=Hh(si),vh=Hh(oa,!0);function iv(e,s){var o=!0;return Ai(e,function(h,p,m){return o=!!s(h,p,m),o}),o}function Fn(e,s,o){for(var h=-1,p=e.length;++h<p;){var m=e[h],v=s(m);if(v!=null&&(b===r?v===v&&!Sr(v):o(v,b)))var b=v,S=m}return S}function sv(e,s,o,h){var p=e.length;for(o=Ce(o),o<0&&(o=-o>p?0:p+o),h=h===r||h>p?p:Ce(h),h<0&&(h+=p),h=o>h?0:ql(h);o<h;)e[o++]=s;return e}function wh(e,s){var o=[];return Ai(e,function(h,p,m){s(h,p,m)&&o.push(h)}),o}function Yt(e,s,o,h,p){var m=-1,v=e.length;for(o||(o=Vv),p||(p=[]);++m<v;){var b=e[m];s>0&&o(b)?s>1?Yt(b,s-1,o,h,p):Ri(p,b):h||(p[p.length]=b)}return p}var na=Kh(),bh=Kh(!0);function si(e,s){return e&&na(e,s,Kt)}function oa(e,s){return e&&bh(e,s,Kt)}function qn(e,s){return Si(s,function(o){return vi(e[o])})}function Ji(e,s){s=Ti(s,e);for(var o=0,h=s.length;e!=null&&o<h;)e=e[oi(s[o++])];return o&&o==h?e:r}function _h(e,s,o){var h=s(e);return Pe(e)?h:Ri(h,o(e))}function or(e){return e==null?e===r?N0:D0:Hi&&Hi in Je(e)?zv(e):Xv(e)}function aa(e,s){return e>s}function nv(e,s){return e!=null&&Ve.call(e,s)}function ov(e,s){return e!=null&&s in Je(e)}function av(e,s,o){return e>=rr(s,o)&&e<Dt(s,o)}function ca(e,s,o){for(var h=o?Ho:yn,p=e[0].length,m=e.length,v=m,b=D(m),S=1/0,L=[];v--;){var M=e[v];v&&s&&(M=it(M,Ir(s))),S=rr(M.length,S),b[v]=!o&&(s||p>=120&&M.length>=120)?new Vi(v&&M):r}M=e[0];var U=-1,X=b[0];e:for(;++U<p&&L.length<S;){var ce=M[U],ge=s?s(ce):ce;if(ce=o||ce!==0?ce:0,!(X?Ls(X,ge):h(L,ge,o))){for(v=m;--v;){var Oe=b[v];if(!(Oe?Ls(Oe,ge):h(e[v],ge,o)))continue e}X&&X.push(ge),L.push(ce)}}return L}function cv(e,s,o,h){return si(e,function(p,m,v){s(h,o(p),m,v)}),h}function Hs(e,s,o){s=Ti(s,e),e=cl(e,s);var h=e==null?e:e[oi($r(s))];return h==null?r:xr(h,e,o)}function Eh(e){return ft(e)&&or(e)==ii}function uv(e){return ft(e)&&or(e)==qs}function hv(e){return ft(e)&&or(e)==As}function Ks(e,s,o,h,p){return e===s?!0:e==null||s==null||!ft(e)&&!ft(s)?e!==e&&s!==s:lv(e,s,o,h,Ks,p)}function lv(e,s,o,h,p,m){var v=Pe(e),b=Pe(s),S=v?ns:ir(e),L=b?ns:ir(s);S=S==ii?li:S,L=L==ii?li:L;var M=S==li,U=L==li,X=S==L;if(X&&Fi(e)){if(!Fi(s))return!1;v=!0,M=!1}if(X&&!M)return m||(m=new Wr),v||ws(e)?tl(e,s,o,h,p,m):kv(e,s,S,o,h,p,m);if(!(o&B)){var ce=M&&Ve.call(e,"__wrapped__"),ge=U&&Ve.call(s,"__wrapped__");if(ce||ge){var Oe=ce?e.value():e,ye=ge?s.value():s;return m||(m=new Wr),p(Oe,ye,o,h,m)}}return X?(m||(m=new Wr),jv(e,s,o,h,p,m)):!1}function fv(e){return ft(e)&&ir(e)==Vr}function ua(e,s,o,h){var p=o.length,m=p,v=!h;if(e==null)return!m;for(e=Je(e);p--;){var b=o[p];if(v&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++p<m;){b=o[p];var S=b[0],L=e[S],M=b[1];if(v&&b[2]){if(L===r&&!(S in e))return!1}else{var U=new Wr;if(h)var X=h(L,M,S,e,s,U);if(!(X===r?Ks(M,L,B|ue,h,U):X))return!1}}return!0}function xh(e){if(!ot(e)||Jv(e))return!1;var s=vi(e)?fm:ry;return s.test(Yi(e))}function pv(e){return ft(e)&&or(e)==Ts}function dv(e){return ft(e)&&ir(e)==Gr}function gv(e){return ft(e)&&Zn(e.length)&&!!Xe[or(e)]}function Ih(e){return typeof e=="function"?e:e==null?mr:typeof e=="object"?Pe(e)?Rh(e[0],e[1]):Sh(e):Vl(e)}function ha(e){if(!Js(e))return vm(e);var s=[];for(var o in Je(e))Ve.call(e,o)&&o!="constructor"&&s.push(o);return s}function yv(e){if(!ot(e))return Zv(e);var s=Js(e),o=[];for(var h in e)h=="constructor"&&(s||!Ve.call(e,h))||o.push(h);return o}function la(e,s){return e<s}function Ph(e,s){var o=-1,h=gr(e)?D(e.length):[];return Ai(e,function(p,m,v){h[++o]=s(p,m,v)}),h}function Sh(e){var s=Sa(e);return s.length==1&&s[0][2]?ol(s[0][0],s[0][1]):function(o){return o===e||ua(o,e,s)}}function Rh(e,s){return Ca(e)&&nl(s)?ol(oi(e),s):function(o){var h=ka(o,e);return h===r&&h===s?ja(o,e):Ks(s,h,B|ue)}}function Ln(e,s,o,h,p){e!==s&&na(s,function(m,v){if(p||(p=new Wr),ot(m))mv(e,s,v,o,Ln,h,p);else{var b=h?h(Aa(e,v),m,v+"",e,s,p):r;b===r&&(b=m),ia(e,v,b)}},yr)}function mv(e,s,o,h,p,m,v){var b=Aa(e,o),S=Aa(s,o),L=v.get(S);if(L){ia(e,o,L);return}var M=m?m(b,S,o+"",e,s,v):r,U=M===r;if(U){var X=Pe(S),ce=!X&&Fi(S),ge=!X&&!ce&&ws(S);M=S,X||ce||ge?Pe(b)?M=b:mt(b)?M=dr(b):ce?(U=!1,M=jh(S,!0)):ge?(U=!1,M=zh(S,!0)):M=[]:Ys(S)||Qi(S)?(M=b,Qi(b)?M=Ll(b):(!ot(b)||vi(b))&&(M=sl(S))):U=!1}U&&(v.set(S,M),p(M,S,h,m,v),v.delete(S)),ia(e,o,M)}function Ch(e,s){var o=e.length;if(o)return s+=s<0?o:0,mi(s,o)?e[s]:r}function Oh(e,s,o){s.length?s=it(s,function(m){return Pe(m)?function(v){return Ji(v,m.length===1?m[0]:m)}:m}):s=[mr];var h=-1;s=it(s,Ir(de()));var p=Ph(e,function(m,v,b){var S=it(s,function(L){return L(m)});return{criteria:S,index:++h,value:m}});return Hy(p,function(m,v){return Av(m,v,o)})}function vv(e,s){return Ah(e,s,function(o,h){return ja(e,h)})}function Ah(e,s,o){for(var h=-1,p=s.length,m={};++h<p;){var v=s[h],b=Ji(e,v);o(b,v)&&Vs(m,Ti(v,e),b)}return m}function wv(e){return function(s){return Ji(s,e)}}function fa(e,s,o,h){var p=h?By:cs,m=-1,v=s.length,b=e;for(e===s&&(s=dr(s)),o&&(b=it(e,Ir(o)));++m<v;)for(var S=0,L=s[m],M=o?o(L):L;(S=p(b,M,S,h))>-1;)b!==e&&Sn.call(b,S,1),Sn.call(e,S,1);return e}function Dh(e,s){for(var o=e?s.length:0,h=o-1;o--;){var p=s[o];if(o==h||p!==m){var m=p;mi(p)?Sn.call(e,p,1):ya(e,p)}}return e}function pa(e,s){return e+On(lh()*(s-e+1))}function bv(e,s,o,h){for(var p=-1,m=Dt(Cn((s-e)/(o||1)),0),v=D(m);m--;)v[h?m:++p]=e,e+=o;return v}function da(e,s){var o="";if(!e||s<1||s>Er)return o;do s%2&&(o+=e),s=On(s/2),s&&(e+=e);while(s);return o}function De(e,s){return Da(al(e,s,mr),e+"")}function _v(e){return dh(bs(e))}function Ev(e,s){var o=bs(e);return Vn(o,Gi(s,0,o.length))}function Vs(e,s,o,h){if(!ot(e))return e;s=Ti(s,e);for(var p=-1,m=s.length,v=m-1,b=e;b!=null&&++p<m;){var S=oi(s[p]),L=o;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(p!=v){var M=b[S];L=h?h(M,S,b):r,L===r&&(L=ot(M)?M:mi(s[p+1])?[]:{})}Us(b,S,L),b=b[S]}return e}var Th=An?function(e,s){return An.set(e,s),e}:mr,xv=Rn?function(e,s){return Rn(e,"toString",{configurable:!0,enumerable:!1,value:$a(s),writable:!0})}:mr;function Iv(e){return Vn(bs(e))}function zr(e,s,o){var h=-1,p=e.length;s<0&&(s=-s>p?0:p+s),o=o>p?p:o,o<0&&(o+=p),p=s>o?0:o-s>>>0,s>>>=0;for(var m=D(p);++h<p;)m[h]=e[h+s];return m}function Pv(e,s){var o;return Ai(e,function(h,p,m){return o=s(h,p,m),!o}),!!o}function Mn(e,s,o){var h=0,p=e==null?h:e.length;if(typeof s=="number"&&s===s&&p<=un){for(;h<p;){var m=h+p>>>1,v=e[m];v!==null&&!Sr(v)&&(o?v<=s:v<s)?h=m+1:p=m}return p}return ga(e,s,mr,o)}function ga(e,s,o,h){var p=0,m=e==null?0:e.length;if(m===0)return 0;s=o(s);for(var v=s!==s,b=s===null,S=Sr(s),L=s===r;p<m;){var M=On((p+m)/2),U=o(e[M]),X=U!==r,ce=U===null,ge=U===U,Oe=Sr(U);if(v)var ye=h||ge;else L?ye=ge&&(h||X):b?ye=ge&&X&&(h||!ce):S?ye=ge&&X&&!ce&&(h||!Oe):ce||Oe?ye=!1:ye=h?U<=s:U<s;ye?p=M+1:m=M}return rr(m,Cs)}function Nh(e,s){for(var o=-1,h=e.length,p=0,m=[];++o<h;){var v=e[o],b=s?s(v):v;if(!o||!Yr(b,S)){var S=b;m[p++]=v===0?0:v}}return m}function Fh(e){return typeof e=="number"?e:Sr(e)?ri:+e}function Pr(e){if(typeof e=="string")return e;if(Pe(e))return it(e,Pr)+"";if(Sr(e))return fh?fh.call(e):"";var s=e+"";return s=="0"&&1/e==-ti?"-0":s}function Di(e,s,o){var h=-1,p=yn,m=e.length,v=!0,b=[],S=b;if(o)v=!1,p=Ho;else if(m>=a){var L=s?null:Lv(e);if(L)return vn(L);v=!1,p=Ls,S=new Vi}else S=s?[]:b;e:for(;++h<m;){var M=e[h],U=s?s(M):M;if(M=o||M!==0?M:0,v&&U===U){for(var X=S.length;X--;)if(S[X]===U)continue e;s&&S.push(U),b.push(M)}else p(S,U,o)||(S!==b&&S.push(U),b.push(M))}return b}function ya(e,s){return s=Ti(s,e),e=cl(e,s),e==null||delete e[oi($r(s))]}function qh(e,s,o,h){return Vs(e,s,o(Ji(e,s)),h)}function kn(e,s,o,h){for(var p=e.length,m=h?p:-1;(h?m--:++m<p)&&s(e[m],m,e););return o?zr(e,h?0:m,h?m+1:p):zr(e,h?m+1:0,h?p:m)}function Lh(e,s){var o=e;return o instanceof Me&&(o=o.value()),Ko(s,function(h,p){return p.func.apply(p.thisArg,Ri([h],p.args))},o)}function ma(e,s,o){var h=e.length;if(h<2)return h?Di(e[0]):[];for(var p=-1,m=D(h);++p<h;)for(var v=e[p],b=-1;++b<h;)b!=p&&(m[p]=Bs(m[p]||v,e[b],s,o));return Di(Yt(m,1),s,o)}function Mh(e,s,o){for(var h=-1,p=e.length,m=s.length,v={};++h<p;){var b=h<m?s[h]:r;o(v,e[h],b)}return v}function va(e){return mt(e)?e:[]}function wa(e){return typeof e=="function"?e:mr}function Ti(e,s){return Pe(e)?e:Ca(e,s)?[e]:fl(He(e))}var Sv=De;function Ni(e,s,o){var h=e.length;return o=o===r?h:o,!s&&o>=h?e:zr(e,s,o)}var kh=pm||function(e){return Wt.clearTimeout(e)};function jh(e,s){if(s)return e.slice();var o=e.length,h=oh?oh(o):new e.constructor(o);return e.copy(h),h}function ba(e){var s=new e.constructor(e.byteLength);return new In(s).set(new In(e)),s}function Rv(e,s){var o=s?ba(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Cv(e){var s=new e.constructor(e.source,Eu.exec(e));return s.lastIndex=e.lastIndex,s}function Ov(e){return $s?Je($s.call(e)):{}}function zh(e,s){var o=s?ba(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function $h(e,s){if(e!==s){var o=e!==r,h=e===null,p=e===e,m=Sr(e),v=s!==r,b=s===null,S=s===s,L=Sr(s);if(!b&&!L&&!m&&e>s||m&&v&&S&&!b&&!L||h&&v&&S||!o&&S||!p)return 1;if(!h&&!m&&!L&&e<s||L&&o&&p&&!h&&!m||b&&o&&p||!v&&p||!S)return-1}return 0}function Av(e,s,o){for(var h=-1,p=e.criteria,m=s.criteria,v=p.length,b=o.length;++h<v;){var S=$h(p[h],m[h]);if(S){if(h>=b)return S;var L=o[h];return S*(L=="desc"?-1:1)}}return e.index-s.index}function Uh(e,s,o,h){for(var p=-1,m=e.length,v=o.length,b=-1,S=s.length,L=Dt(m-v,0),M=D(S+L),U=!h;++b<S;)M[b]=s[b];for(;++p<v;)(U||p<m)&&(M[o[p]]=e[p]);for(;L--;)M[b++]=e[p++];return M}function Bh(e,s,o,h){for(var p=-1,m=e.length,v=-1,b=o.length,S=-1,L=s.length,M=Dt(m-b,0),U=D(M+L),X=!h;++p<M;)U[p]=e[p];for(var ce=p;++S<L;)U[ce+S]=s[S];for(;++v<b;)(X||p<m)&&(U[ce+o[v]]=e[p++]);return U}function dr(e,s){var o=-1,h=e.length;for(s||(s=D(h));++o<h;)s[o]=e[o];return s}function ni(e,s,o,h){var p=!o;o||(o={});for(var m=-1,v=s.length;++m<v;){var b=s[m],S=h?h(o[b],e[b],b,o,e):r;S===r&&(S=e[b]),p?di(o,b,S):Us(o,b,S)}return o}function Dv(e,s){return ni(e,Ra(e),s)}function Tv(e,s){return ni(e,rl(e),s)}function jn(e,s){return function(o,h){var p=Pe(o)?My:ev,m=s?s():{};return p(o,e,de(h,2),m)}}function ys(e){return De(function(s,o){var h=-1,p=o.length,m=p>1?o[p-1]:r,v=p>2?o[2]:r;for(m=e.length>3&&typeof m=="function"?(p--,m):r,v&&ar(o[0],o[1],v)&&(m=p<3?r:m,p=1),s=Je(s);++h<p;){var b=o[h];b&&e(s,b,h,m)}return s})}function Hh(e,s){return function(o,h){if(o==null)return o;if(!gr(o))return e(o,h);for(var p=o.length,m=s?p:-1,v=Je(o);(s?m--:++m<p)&&h(v[m],m,v)!==!1;);return o}}function Kh(e){return function(s,o,h){for(var p=-1,m=Je(s),v=h(s),b=v.length;b--;){var S=v[e?b:++p];if(o(m[S],S,m)===!1)break}return s}}function Nv(e,s,o){var h=s&ve,p=Gs(e);function m(){var v=this&&this!==Wt&&this instanceof m?p:e;return v.apply(h?o:this,arguments)}return m}function Vh(e){return function(s){s=He(s);var o=us(s)?Jr(s):r,h=o?o[0]:s.charAt(0),p=o?Ni(o,1).join(""):s.slice(1);return h[e]()+p}}function ms(e){return function(s){return Ko(Hl(Bl(s).replace(xy,"")),e,"")}}function Gs(e){return function(){var s=arguments;switch(s.length){case 0:return new e;case 1:return new e(s[0]);case 2:return new e(s[0],s[1]);case 3:return new e(s[0],s[1],s[2]);case 4:return new e(s[0],s[1],s[2],s[3]);case 5:return new e(s[0],s[1],s[2],s[3],s[4]);case 6:return new e(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new e(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var o=gs(e.prototype),h=e.apply(o,s);return ot(h)?h:o}}function Fv(e,s,o){var h=Gs(e);function p(){for(var m=arguments.length,v=D(m),b=m,S=vs(p);b--;)v[b]=arguments[b];var L=m<3&&v[0]!==S&&v[m-1]!==S?[]:Ci(v,S);if(m-=L.length,m<o)return Qh(e,s,zn,p.placeholder,r,v,L,r,r,o-m);var M=this&&this!==Wt&&this instanceof p?h:e;return xr(M,this,v)}return p}function Gh(e){return function(s,o,h){var p=Je(s);if(!gr(s)){var m=de(o,3);s=Kt(s),o=function(b){return m(p[b],b,p)}}var v=e(s,o,h);return v>-1?p[m?s[v]:v]:r}}function Jh(e){return yi(function(s){var o=s.length,h=o,p=kr.prototype.thru;for(e&&s.reverse();h--;){var m=s[h];if(typeof m!="function")throw new Mr(g);if(p&&!v&&Hn(m)=="wrapper")var v=new kr([],!0)}for(h=v?h:o;++h<o;){m=s[h];var b=Hn(m),S=b=="wrapper"?Pa(m):r;S&&Oa(S[0])&&S[1]==(rt|qe|ze|Ot)&&!S[4].length&&S[9]==1?v=v[Hn(S[0])].apply(v,S[3]):v=m.length==1&&Oa(m)?v[b]():v.thru(m)}return function(){var L=arguments,M=L[0];if(v&&L.length==1&&Pe(M))return v.plant(M).value();for(var U=0,X=o?s[U].apply(this,L):M;++U<o;)X=s[U].call(this,X);return X}})}function zn(e,s,o,h,p,m,v,b,S,L){var M=s&rt,U=s&ve,X=s&be,ce=s&(qe|Ue),ge=s&br,Oe=X?r:Gs(e);function ye(){for(var Le=arguments.length,ke=D(Le),Rr=Le;Rr--;)ke[Rr]=arguments[Rr];if(ce)var cr=vs(ye),Cr=Vy(ke,cr);if(h&&(ke=Uh(ke,h,p,ce)),m&&(ke=Bh(ke,m,v,ce)),Le-=Cr,ce&&Le<L){var vt=Ci(ke,cr);return Qh(e,s,zn,ye.placeholder,o,ke,vt,b,S,L-Le)}var Qr=U?o:this,bi=X?Qr[e]:e;return Le=ke.length,b?ke=ew(ke,b):ge&&Le>1&&ke.reverse(),M&&S<Le&&(ke.length=S),this&&this!==Wt&&this instanceof ye&&(bi=Oe||Gs(bi)),bi.apply(Qr,ke)}return ye}function Wh(e,s){return function(o,h){return cv(o,e,s(h),{})}}function $n(e,s){return function(o,h){var p;if(o===r&&h===r)return s;if(o!==r&&(p=o),h!==r){if(p===r)return h;typeof o=="string"||typeof h=="string"?(o=Pr(o),h=Pr(h)):(o=Fh(o),h=Fh(h)),p=e(o,h)}return p}}function _a(e){return yi(function(s){return s=it(s,Ir(de())),De(function(o){var h=this;return e(s,function(p){return xr(p,h,o)})})})}function Un(e,s){s=s===r?" ":Pr(s);var o=s.length;if(o<2)return o?da(s,e):s;var h=da(s,Cn(e/hs(s)));return us(s)?Ni(Jr(h),0,e).join(""):h.slice(0,e)}function qv(e,s,o,h){var p=s&ve,m=Gs(e);function v(){for(var b=-1,S=arguments.length,L=-1,M=h.length,U=D(M+S),X=this&&this!==Wt&&this instanceof v?m:e;++L<M;)U[L]=h[L];for(;S--;)U[L++]=arguments[++b];return xr(X,p?o:this,U)}return v}function Yh(e){return function(s,o,h){return h&&typeof h!="number"&&ar(s,o,h)&&(o=h=r),s=wi(s),o===r?(o=s,s=0):o=wi(o),h=h===r?s<o?1:-1:wi(h),bv(s,o,h,e)}}function Bn(e){return function(s,o){return typeof s=="string"&&typeof o=="string"||(s=Ur(s),o=Ur(o)),e(s,o)}}function Qh(e,s,o,h,p,m,v,b,S,L){var M=s&qe,U=M?v:r,X=M?r:v,ce=M?m:r,ge=M?r:m;s|=M?ze:wt,s&=~(M?wt:ze),s&$e||(s&=~(ve|be));var Oe=[e,s,p,ce,U,ge,X,b,S,L],ye=o.apply(r,Oe);return Oa(e)&&ul(ye,Oe),ye.placeholder=h,hl(ye,e,s)}function Ea(e){var s=At[e];return function(o,h){if(o=Ur(o),h=h==null?0:rr(Ce(h),292),h&&hh(o)){var p=(He(o)+"e").split("e"),m=s(p[0]+"e"+(+p[1]+h));return p=(He(m)+"e").split("e"),+(p[0]+"e"+(+p[1]-h))}return s(o)}}var Lv=ps&&1/vn(new ps([,-0]))[1]==ti?function(e){return new ps(e)}:Ha;function Zh(e){return function(s){var o=ir(s);return o==Vr?Zo(s):o==Gr?Xy(s):Ky(s,e(s))}}function gi(e,s,o,h,p,m,v,b){var S=s&be;if(!S&&typeof e!="function")throw new Mr(g);var L=h?h.length:0;if(L||(s&=~(ze|wt),h=p=r),v=v===r?v:Dt(Ce(v),0),b=b===r?b:Ce(b),L-=p?p.length:0,s&wt){var M=h,U=p;h=p=r}var X=S?r:Pa(e),ce=[e,s,o,h,p,M,U,m,v,b];if(X&&Qv(ce,X),e=ce[0],s=ce[1],o=ce[2],h=ce[3],p=ce[4],b=ce[9]=ce[9]===r?S?0:e.length:Dt(ce[9]-L,0),!b&&s&(qe|Ue)&&(s&=~(qe|Ue)),!s||s==ve)var ge=Nv(e,s,o);else s==qe||s==Ue?ge=Fv(e,s,b):(s==ze||s==(ve|ze))&&!p.length?ge=qv(e,s,o,h):ge=zn.apply(r,ce);var Oe=X?Th:ul;return hl(Oe(ge,ce),e,s)}function Xh(e,s,o,h){return e===r||Yr(e,fs[o])&&!Ve.call(h,o)?s:e}function el(e,s,o,h,p,m){return ot(e)&&ot(s)&&(m.set(s,e),Ln(e,s,r,el,m),m.delete(s)),e}function Mv(e){return Ys(e)?r:e}function tl(e,s,o,h,p,m){var v=o&B,b=e.length,S=s.length;if(b!=S&&!(v&&S>b))return!1;var L=m.get(e),M=m.get(s);if(L&&M)return L==s&&M==e;var U=-1,X=!0,ce=o&ue?new Vi:r;for(m.set(e,s),m.set(s,e);++U<b;){var ge=e[U],Oe=s[U];if(h)var ye=v?h(Oe,ge,U,s,e,m):h(ge,Oe,U,e,s,m);if(ye!==r){if(ye)continue;X=!1;break}if(ce){if(!Vo(s,function(Le,ke){if(!Ls(ce,ke)&&(ge===Le||p(ge,Le,o,h,m)))return ce.push(ke)})){X=!1;break}}else if(!(ge===Oe||p(ge,Oe,o,h,m))){X=!1;break}}return m.delete(e),m.delete(s),X}function kv(e,s,o,h,p,m,v){switch(o){case os:if(e.byteLength!=s.byteLength||e.byteOffset!=s.byteOffset)return!1;e=e.buffer,s=s.buffer;case qs:return!(e.byteLength!=s.byteLength||!m(new In(e),new In(s)));case Os:case As:case Ds:return Yr(+e,+s);case hn:return e.name==s.name&&e.message==s.message;case Ts:case Ns:return e==s+"";case Vr:var b=Zo;case Gr:var S=h&B;if(b||(b=vn),e.size!=s.size&&!S)return!1;var L=v.get(e);if(L)return L==s;h|=ue,v.set(e,s);var M=tl(b(e),b(s),h,p,m,v);return v.delete(e),M;case fn:if($s)return $s.call(e)==$s.call(s)}return!1}function jv(e,s,o,h,p,m){var v=o&B,b=xa(e),S=b.length,L=xa(s),M=L.length;if(S!=M&&!v)return!1;for(var U=S;U--;){var X=b[U];if(!(v?X in s:Ve.call(s,X)))return!1}var ce=m.get(e),ge=m.get(s);if(ce&&ge)return ce==s&&ge==e;var Oe=!0;m.set(e,s),m.set(s,e);for(var ye=v;++U<S;){X=b[U];var Le=e[X],ke=s[X];if(h)var Rr=v?h(ke,Le,X,s,e,m):h(Le,ke,X,e,s,m);if(!(Rr===r?Le===ke||p(Le,ke,o,h,m):Rr)){Oe=!1;break}ye||(ye=X=="constructor")}if(Oe&&!ye){var cr=e.constructor,Cr=s.constructor;cr!=Cr&&"constructor"in e&&"constructor"in s&&!(typeof cr=="function"&&cr instanceof cr&&typeof Cr=="function"&&Cr instanceof Cr)&&(Oe=!1)}return m.delete(e),m.delete(s),Oe}function yi(e){return Da(al(e,r,yl),e+"")}function xa(e){return _h(e,Kt,Ra)}function Ia(e){return _h(e,yr,rl)}var Pa=An?function(e){return An.get(e)}:Ha;function Hn(e){for(var s=e.name+"",o=ds[s],h=Ve.call(ds,s)?o.length:0;h--;){var p=o[h],m=p.func;if(m==null||m==e)return p.name}return s}function vs(e){var s=Ve.call(d,"placeholder")?d:e;return s.placeholder}function de(){var e=d.iteratee||Ua;return e=e===Ua?Ih:e,arguments.length?e(arguments[0],arguments[1]):e}function Kn(e,s){var o=e.__data__;return Gv(s)?o[typeof s=="string"?"string":"hash"]:o.map}function Sa(e){for(var s=Kt(e),o=s.length;o--;){var h=s[o],p=e[h];s[o]=[h,p,nl(p)]}return s}function Wi(e,s){var o=Yy(e,s);return xh(o)?o:r}function zv(e){var s=Ve.call(e,Hi),o=e[Hi];try{e[Hi]=r;var h=!0}catch{}var p=En.call(e);return h&&(s?e[Hi]=o:delete e[Hi]),p}var Ra=ea?function(e){return e==null?[]:(e=Je(e),Si(ea(e),function(s){return ch.call(e,s)}))}:Ka,rl=ea?function(e){for(var s=[];e;)Ri(s,Ra(e)),e=Pn(e);return s}:Ka,ir=or;(ta&&ir(new ta(new ArrayBuffer(1)))!=os||ks&&ir(new ks)!=Vr||ra&&ir(ra.resolve())!=vu||ps&&ir(new ps)!=Gr||js&&ir(new js)!=Fs)&&(ir=function(e){var s=or(e),o=s==li?e.constructor:r,h=o?Yi(o):"";if(h)switch(h){case Em:return os;case xm:return Vr;case Im:return vu;case Pm:return Gr;case Sm:return Fs}return s});function $v(e,s,o){for(var h=-1,p=o.length;++h<p;){var m=o[h],v=m.size;switch(m.type){case"drop":e+=v;break;case"dropRight":s-=v;break;case"take":s=rr(s,e+v);break;case"takeRight":e=Dt(e,s-v);break}}return{start:e,end:s}}function Uv(e){var s=e.match(J0);return s?s[1].split(W0):[]}function il(e,s,o){s=Ti(s,e);for(var h=-1,p=s.length,m=!1;++h<p;){var v=oi(s[h]);if(!(m=e!=null&&o(e,v)))break;e=e[v]}return m||++h!=p?m:(p=e==null?0:e.length,!!p&&Zn(p)&&mi(v,p)&&(Pe(e)||Qi(e)))}function Bv(e){var s=e.length,o=new e.constructor(s);return s&&typeof e[0]=="string"&&Ve.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function sl(e){return typeof e.constructor=="function"&&!Js(e)?gs(Pn(e)):{}}function Hv(e,s,o){var h=e.constructor;switch(s){case qs:return ba(e);case Os:case As:return new h(+e);case os:return Rv(e,o);case So:case Ro:case Co:case Oo:case Ao:case Do:case To:case No:case Fo:return zh(e,o);case Vr:return new h;case Ds:case Ns:return new h(e);case Ts:return Cv(e);case Gr:return new h;case fn:return Ov(e)}}function Kv(e,s){var o=s.length;if(!o)return e;var h=o-1;return s[h]=(o>1?"& ":"")+s[h],s=s.join(o>2?", ":" "),e.replace(G0,`{
/* [wrapped with `+s+`] */
`)}function Vv(e){return Pe(e)||Qi(e)||!!(uh&&e&&e[uh])}function mi(e,s){var o=typeof e;return s=s??Er,!!s&&(o=="number"||o!="symbol"&&sy.test(e))&&e>-1&&e%1==0&&e<s}function ar(e,s,o){if(!ot(o))return!1;var h=typeof s;return(h=="number"?gr(o)&&mi(s,o.length):h=="string"&&s in o)?Yr(o[s],e):!1}function Ca(e,s){if(Pe(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||Sr(e)?!0:B0.test(e)||!U0.test(e)||s!=null&&e in Je(s)}function Gv(e){var s=typeof e;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?e!=="__proto__":e===null}function Oa(e){var s=Hn(e),o=d[s];if(typeof o!="function"||!(s in Me.prototype))return!1;if(e===o)return!0;var h=Pa(o);return!!h&&e===h[0]}function Jv(e){return!!nh&&nh in e}var Wv=bn?vi:Va;function Js(e){var s=e&&e.constructor,o=typeof s=="function"&&s.prototype||fs;return e===o}function nl(e){return e===e&&!ot(e)}function ol(e,s){return function(o){return o==null?!1:o[e]===s&&(s!==r||e in Je(o))}}function Yv(e){var s=Yn(e,function(h){return o.size===_&&o.clear(),h}),o=s.cache;return s}function Qv(e,s){var o=e[1],h=s[1],p=o|h,m=p<(ve|be|rt),v=h==rt&&o==qe||h==rt&&o==Ot&&e[7].length<=s[8]||h==(rt|Ot)&&s[7].length<=s[8]&&o==qe;if(!(m||v))return e;h&ve&&(e[2]=s[2],p|=o&ve?0:$e);var b=s[3];if(b){var S=e[3];e[3]=S?Uh(S,b,s[4]):b,e[4]=S?Ci(e[3],A):s[4]}return b=s[5],b&&(S=e[5],e[5]=S?Bh(S,b,s[6]):b,e[6]=S?Ci(e[5],A):s[6]),b=s[7],b&&(e[7]=b),h&rt&&(e[8]=e[8]==null?s[8]:rr(e[8],s[8])),e[9]==null&&(e[9]=s[9]),e[0]=s[0],e[1]=p,e}function Zv(e){var s=[];if(e!=null)for(var o in Je(e))s.push(o);return s}function Xv(e){return En.call(e)}function al(e,s,o){return s=Dt(s===r?e.length-1:s,0),function(){for(var h=arguments,p=-1,m=Dt(h.length-s,0),v=D(m);++p<m;)v[p]=h[s+p];p=-1;for(var b=D(s+1);++p<s;)b[p]=h[p];return b[s]=o(v),xr(e,this,b)}}function cl(e,s){return s.length<2?e:Ji(e,zr(s,0,-1))}function ew(e,s){for(var o=e.length,h=rr(s.length,o),p=dr(e);h--;){var m=s[h];e[h]=mi(m,o)?p[m]:r}return e}function Aa(e,s){if(!(s==="constructor"&&typeof e[s]=="function")&&s!="__proto__")return e[s]}var ul=ll(Th),Ws=gm||function(e,s){return Wt.setTimeout(e,s)},Da=ll(xv);function hl(e,s,o){var h=s+"";return Da(e,Kv(h,tw(Uv(h),o)))}function ll(e){var s=0,o=0;return function(){var h=wm(),p=_r-(h-o);if(o=h,p>0){if(++s>=$i)return arguments[0]}else s=0;return e.apply(r,arguments)}}function Vn(e,s){var o=-1,h=e.length,p=h-1;for(s=s===r?h:s;++o<s;){var m=pa(o,p),v=e[m];e[m]=e[o],e[o]=v}return e.length=s,e}var fl=Yv(function(e){var s=[];return e.charCodeAt(0)===46&&s.push(""),e.replace(H0,function(o,h,p,m){s.push(p?m.replace(Z0,"$1"):h||o)}),s});function oi(e){if(typeof e=="string"||Sr(e))return e;var s=e+"";return s=="0"&&1/e==-ti?"-0":s}function Yi(e){if(e!=null){try{return _n.call(e)}catch{}try{return e+""}catch{}}return""}function tw(e,s){return Lr(Po,function(o){var h="_."+o[0];s&o[1]&&!yn(e,h)&&e.push(h)}),e.sort()}function pl(e){if(e instanceof Me)return e.clone();var s=new kr(e.__wrapped__,e.__chain__);return s.__actions__=dr(e.__actions__),s.__index__=e.__index__,s.__values__=e.__values__,s}function rw(e,s,o){(o?ar(e,s,o):s===r)?s=1:s=Dt(Ce(s),0);var h=e==null?0:e.length;if(!h||s<1)return[];for(var p=0,m=0,v=D(Cn(h/s));p<h;)v[m++]=zr(e,p,p+=s);return v}function iw(e){for(var s=-1,o=e==null?0:e.length,h=0,p=[];++s<o;){var m=e[s];m&&(p[h++]=m)}return p}function sw(){var e=arguments.length;if(!e)return[];for(var s=D(e-1),o=arguments[0],h=e;h--;)s[h-1]=arguments[h];return Ri(Pe(o)?dr(o):[o],Yt(s,1))}var nw=De(function(e,s){return mt(e)?Bs(e,Yt(s,1,mt,!0)):[]}),ow=De(function(e,s){var o=$r(s);return mt(o)&&(o=r),mt(e)?Bs(e,Yt(s,1,mt,!0),de(o,2)):[]}),aw=De(function(e,s){var o=$r(s);return mt(o)&&(o=r),mt(e)?Bs(e,Yt(s,1,mt,!0),r,o):[]});function cw(e,s,o){var h=e==null?0:e.length;return h?(s=o||s===r?1:Ce(s),zr(e,s<0?0:s,h)):[]}function uw(e,s,o){var h=e==null?0:e.length;return h?(s=o||s===r?1:Ce(s),s=h-s,zr(e,0,s<0?0:s)):[]}function hw(e,s){return e&&e.length?kn(e,de(s,3),!0,!0):[]}function lw(e,s){return e&&e.length?kn(e,de(s,3),!0):[]}function fw(e,s,o,h){var p=e==null?0:e.length;return p?(o&&typeof o!="number"&&ar(e,s,o)&&(o=0,h=p),sv(e,s,o,h)):[]}function dl(e,s,o){var h=e==null?0:e.length;if(!h)return-1;var p=o==null?0:Ce(o);return p<0&&(p=Dt(h+p,0)),mn(e,de(s,3),p)}function gl(e,s,o){var h=e==null?0:e.length;if(!h)return-1;var p=h-1;return o!==r&&(p=Ce(o),p=o<0?Dt(h+p,0):rr(p,h-1)),mn(e,de(s,3),p,!0)}function yl(e){var s=e==null?0:e.length;return s?Yt(e,1):[]}function pw(e){var s=e==null?0:e.length;return s?Yt(e,ti):[]}function dw(e,s){var o=e==null?0:e.length;return o?(s=s===r?1:Ce(s),Yt(e,s)):[]}function gw(e){for(var s=-1,o=e==null?0:e.length,h={};++s<o;){var p=e[s];h[p[0]]=p[1]}return h}function ml(e){return e&&e.length?e[0]:r}function yw(e,s,o){var h=e==null?0:e.length;if(!h)return-1;var p=o==null?0:Ce(o);return p<0&&(p=Dt(h+p,0)),cs(e,s,p)}function mw(e){var s=e==null?0:e.length;return s?zr(e,0,-1):[]}var vw=De(function(e){var s=it(e,va);return s.length&&s[0]===e[0]?ca(s):[]}),ww=De(function(e){var s=$r(e),o=it(e,va);return s===$r(o)?s=r:o.pop(),o.length&&o[0]===e[0]?ca(o,de(s,2)):[]}),bw=De(function(e){var s=$r(e),o=it(e,va);return s=typeof s=="function"?s:r,s&&o.pop(),o.length&&o[0]===e[0]?ca(o,r,s):[]});function _w(e,s){return e==null?"":mm.call(e,s)}function $r(e){var s=e==null?0:e.length;return s?e[s-1]:r}function Ew(e,s,o){var h=e==null?0:e.length;if(!h)return-1;var p=h;return o!==r&&(p=Ce(o),p=p<0?Dt(h+p,0):rr(p,h-1)),s===s?tm(e,s,p):mn(e,Qu,p,!0)}function xw(e,s){return e&&e.length?Ch(e,Ce(s)):r}var Iw=De(vl);function vl(e,s){return e&&e.length&&s&&s.length?fa(e,s):e}function Pw(e,s,o){return e&&e.length&&s&&s.length?fa(e,s,de(o,2)):e}function Sw(e,s,o){return e&&e.length&&s&&s.length?fa(e,s,r,o):e}var Rw=yi(function(e,s){var o=e==null?0:e.length,h=sa(e,s);return Dh(e,it(s,function(p){return mi(p,o)?+p:p}).sort($h)),h});function Cw(e,s){var o=[];if(!(e&&e.length))return o;var h=-1,p=[],m=e.length;for(s=de(s,3);++h<m;){var v=e[h];s(v,h,e)&&(o.push(v),p.push(h))}return Dh(e,p),o}function Ta(e){return e==null?e:_m.call(e)}function Ow(e,s,o){var h=e==null?0:e.length;return h?(o&&typeof o!="number"&&ar(e,s,o)?(s=0,o=h):(s=s==null?0:Ce(s),o=o===r?h:Ce(o)),zr(e,s,o)):[]}function Aw(e,s){return Mn(e,s)}function Dw(e,s,o){return ga(e,s,de(o,2))}function Tw(e,s){var o=e==null?0:e.length;if(o){var h=Mn(e,s);if(h<o&&Yr(e[h],s))return h}return-1}function Nw(e,s){return Mn(e,s,!0)}function Fw(e,s,o){return ga(e,s,de(o,2),!0)}function qw(e,s){var o=e==null?0:e.length;if(o){var h=Mn(e,s,!0)-1;if(Yr(e[h],s))return h}return-1}function Lw(e){return e&&e.length?Nh(e):[]}function Mw(e,s){return e&&e.length?Nh(e,de(s,2)):[]}function kw(e){var s=e==null?0:e.length;return s?zr(e,1,s):[]}function jw(e,s,o){return e&&e.length?(s=o||s===r?1:Ce(s),zr(e,0,s<0?0:s)):[]}function zw(e,s,o){var h=e==null?0:e.length;return h?(s=o||s===r?1:Ce(s),s=h-s,zr(e,s<0?0:s,h)):[]}function $w(e,s){return e&&e.length?kn(e,de(s,3),!1,!0):[]}function Uw(e,s){return e&&e.length?kn(e,de(s,3)):[]}var Bw=De(function(e){return Di(Yt(e,1,mt,!0))}),Hw=De(function(e){var s=$r(e);return mt(s)&&(s=r),Di(Yt(e,1,mt,!0),de(s,2))}),Kw=De(function(e){var s=$r(e);return s=typeof s=="function"?s:r,Di(Yt(e,1,mt,!0),r,s)});function Vw(e){return e&&e.length?Di(e):[]}function Gw(e,s){return e&&e.length?Di(e,de(s,2)):[]}function Jw(e,s){return s=typeof s=="function"?s:r,e&&e.length?Di(e,r,s):[]}function Na(e){if(!(e&&e.length))return[];var s=0;return e=Si(e,function(o){if(mt(o))return s=Dt(o.length,s),!0}),Yo(s,function(o){return it(e,Go(o))})}function wl(e,s){if(!(e&&e.length))return[];var o=Na(e);return s==null?o:it(o,function(h){return xr(s,r,h)})}var Ww=De(function(e,s){return mt(e)?Bs(e,s):[]}),Yw=De(function(e){return ma(Si(e,mt))}),Qw=De(function(e){var s=$r(e);return mt(s)&&(s=r),ma(Si(e,mt),de(s,2))}),Zw=De(function(e){var s=$r(e);return s=typeof s=="function"?s:r,ma(Si(e,mt),r,s)}),Xw=De(Na);function e1(e,s){return Mh(e||[],s||[],Us)}function t1(e,s){return Mh(e||[],s||[],Vs)}var r1=De(function(e){var s=e.length,o=s>1?e[s-1]:r;return o=typeof o=="function"?(e.pop(),o):r,wl(e,o)});function bl(e){var s=d(e);return s.__chain__=!0,s}function i1(e,s){return s(e),e}function Gn(e,s){return s(e)}var s1=yi(function(e){var s=e.length,o=s?e[0]:0,h=this.__wrapped__,p=function(m){return sa(m,e)};return s>1||this.__actions__.length||!(h instanceof Me)||!mi(o)?this.thru(p):(h=h.slice(o,+o+(s?1:0)),h.__actions__.push({func:Gn,args:[p],thisArg:r}),new kr(h,this.__chain__).thru(function(m){return s&&!m.length&&m.push(r),m}))});function n1(){return bl(this)}function o1(){return new kr(this.value(),this.__chain__)}function a1(){this.__values__===r&&(this.__values__=Fl(this.value()));var e=this.__index__>=this.__values__.length,s=e?r:this.__values__[this.__index__++];return{done:e,value:s}}function c1(){return this}function u1(e){for(var s,o=this;o instanceof Tn;){var h=pl(o);h.__index__=0,h.__values__=r,s?p.__wrapped__=h:s=h;var p=h;o=o.__wrapped__}return p.__wrapped__=e,s}function h1(){var e=this.__wrapped__;if(e instanceof Me){var s=e;return this.__actions__.length&&(s=new Me(this)),s=s.reverse(),s.__actions__.push({func:Gn,args:[Ta],thisArg:r}),new kr(s,this.__chain__)}return this.thru(Ta)}function l1(){return Lh(this.__wrapped__,this.__actions__)}var f1=jn(function(e,s,o){Ve.call(e,o)?++e[o]:di(e,o,1)});function p1(e,s,o){var h=Pe(e)?Wu:iv;return o&&ar(e,s,o)&&(s=r),h(e,de(s,3))}function d1(e,s){var o=Pe(e)?Si:wh;return o(e,de(s,3))}var g1=Gh(dl),y1=Gh(gl);function m1(e,s){return Yt(Jn(e,s),1)}function v1(e,s){return Yt(Jn(e,s),ti)}function w1(e,s,o){return o=o===r?1:Ce(o),Yt(Jn(e,s),o)}function _l(e,s){var o=Pe(e)?Lr:Ai;return o(e,de(s,3))}function El(e,s){var o=Pe(e)?ky:vh;return o(e,de(s,3))}var b1=jn(function(e,s,o){Ve.call(e,o)?e[o].push(s):di(e,o,[s])});function _1(e,s,o,h){e=gr(e)?e:bs(e),o=o&&!h?Ce(o):0;var p=e.length;return o<0&&(o=Dt(p+o,0)),Xn(e)?o<=p&&e.indexOf(s,o)>-1:!!p&&cs(e,s,o)>-1}var E1=De(function(e,s,o){var h=-1,p=typeof s=="function",m=gr(e)?D(e.length):[];return Ai(e,function(v){m[++h]=p?xr(s,v,o):Hs(v,s,o)}),m}),x1=jn(function(e,s,o){di(e,o,s)});function Jn(e,s){var o=Pe(e)?it:Ph;return o(e,de(s,3))}function I1(e,s,o,h){return e==null?[]:(Pe(s)||(s=s==null?[]:[s]),o=h?r:o,Pe(o)||(o=o==null?[]:[o]),Oh(e,s,o))}var P1=jn(function(e,s,o){e[o?0:1].push(s)},function(){return[[],[]]});function S1(e,s,o){var h=Pe(e)?Ko:Xu,p=arguments.length<3;return h(e,de(s,4),o,p,Ai)}function R1(e,s,o){var h=Pe(e)?jy:Xu,p=arguments.length<3;return h(e,de(s,4),o,p,vh)}function C1(e,s){var o=Pe(e)?Si:wh;return o(e,Qn(de(s,3)))}function O1(e){var s=Pe(e)?dh:_v;return s(e)}function A1(e,s,o){(o?ar(e,s,o):s===r)?s=1:s=Ce(s);var h=Pe(e)?Zm:Ev;return h(e,s)}function D1(e){var s=Pe(e)?Xm:Iv;return s(e)}function T1(e){if(e==null)return 0;if(gr(e))return Xn(e)?hs(e):e.length;var s=ir(e);return s==Vr||s==Gr?e.size:ha(e).length}function N1(e,s,o){var h=Pe(e)?Vo:Pv;return o&&ar(e,s,o)&&(s=r),h(e,de(s,3))}var F1=De(function(e,s){if(e==null)return[];var o=s.length;return o>1&&ar(e,s[0],s[1])?s=[]:o>2&&ar(s[0],s[1],s[2])&&(s=[s[0]]),Oh(e,Yt(s,1),[])}),Wn=dm||function(){return Wt.Date.now()};function q1(e,s){if(typeof s!="function")throw new Mr(g);return e=Ce(e),function(){if(--e<1)return s.apply(this,arguments)}}function xl(e,s,o){return s=o?r:s,s=e&&s==null?e.length:s,gi(e,rt,r,r,r,r,s)}function Il(e,s){var o;if(typeof s!="function")throw new Mr(g);return e=Ce(e),function(){return--e>0&&(o=s.apply(this,arguments)),e<=1&&(s=r),o}}var Fa=De(function(e,s,o){var h=ve;if(o.length){var p=Ci(o,vs(Fa));h|=ze}return gi(e,h,s,o,p)}),Pl=De(function(e,s,o){var h=ve|be;if(o.length){var p=Ci(o,vs(Pl));h|=ze}return gi(s,h,e,o,p)});function Sl(e,s,o){s=o?r:s;var h=gi(e,qe,r,r,r,r,r,s);return h.placeholder=Sl.placeholder,h}function Rl(e,s,o){s=o?r:s;var h=gi(e,Ue,r,r,r,r,r,s);return h.placeholder=Rl.placeholder,h}function Cl(e,s,o){var h,p,m,v,b,S,L=0,M=!1,U=!1,X=!0;if(typeof e!="function")throw new Mr(g);s=Ur(s)||0,ot(o)&&(M=!!o.leading,U="maxWait"in o,m=U?Dt(Ur(o.maxWait)||0,s):m,X="trailing"in o?!!o.trailing:X);function ce(vt){var Qr=h,bi=p;return h=p=r,L=vt,v=e.apply(bi,Qr),v}function ge(vt){return L=vt,b=Ws(Le,s),M?ce(vt):v}function Oe(vt){var Qr=vt-S,bi=vt-L,Gl=s-Qr;return U?rr(Gl,m-bi):Gl}function ye(vt){var Qr=vt-S,bi=vt-L;return S===r||Qr>=s||Qr<0||U&&bi>=m}function Le(){var vt=Wn();if(ye(vt))return ke(vt);b=Ws(Le,Oe(vt))}function ke(vt){return b=r,X&&h?ce(vt):(h=p=r,v)}function Rr(){b!==r&&kh(b),L=0,h=S=p=b=r}function cr(){return b===r?v:ke(Wn())}function Cr(){var vt=Wn(),Qr=ye(vt);if(h=arguments,p=this,S=vt,Qr){if(b===r)return ge(S);if(U)return kh(b),b=Ws(Le,s),ce(S)}return b===r&&(b=Ws(Le,s)),v}return Cr.cancel=Rr,Cr.flush=cr,Cr}var L1=De(function(e,s){return mh(e,1,s)}),M1=De(function(e,s,o){return mh(e,Ur(s)||0,o)});function k1(e){return gi(e,br)}function Yn(e,s){if(typeof e!="function"||s!=null&&typeof s!="function")throw new Mr(g);var o=function(){var h=arguments,p=s?s.apply(this,h):h[0],m=o.cache;if(m.has(p))return m.get(p);var v=e.apply(this,h);return o.cache=m.set(p,v)||m,v};return o.cache=new(Yn.Cache||pi),o}Yn.Cache=pi;function Qn(e){if(typeof e!="function")throw new Mr(g);return function(){var s=arguments;switch(s.length){case 0:return!e.call(this);case 1:return!e.call(this,s[0]);case 2:return!e.call(this,s[0],s[1]);case 3:return!e.call(this,s[0],s[1],s[2])}return!e.apply(this,s)}}function j1(e){return Il(2,e)}var z1=Sv(function(e,s){s=s.length==1&&Pe(s[0])?it(s[0],Ir(de())):it(Yt(s,1),Ir(de()));var o=s.length;return De(function(h){for(var p=-1,m=rr(h.length,o);++p<m;)h[p]=s[p].call(this,h[p]);return xr(e,this,h)})}),qa=De(function(e,s){var o=Ci(s,vs(qa));return gi(e,ze,r,s,o)}),Ol=De(function(e,s){var o=Ci(s,vs(Ol));return gi(e,wt,r,s,o)}),$1=yi(function(e,s){return gi(e,Ot,r,r,r,s)});function U1(e,s){if(typeof e!="function")throw new Mr(g);return s=s===r?s:Ce(s),De(e,s)}function B1(e,s){if(typeof e!="function")throw new Mr(g);return s=s==null?0:Dt(Ce(s),0),De(function(o){var h=o[s],p=Ni(o,0,s);return h&&Ri(p,h),xr(e,this,p)})}function H1(e,s,o){var h=!0,p=!0;if(typeof e!="function")throw new Mr(g);return ot(o)&&(h="leading"in o?!!o.leading:h,p="trailing"in o?!!o.trailing:p),Cl(e,s,{leading:h,maxWait:s,trailing:p})}function K1(e){return xl(e,1)}function V1(e,s){return qa(wa(s),e)}function G1(){if(!arguments.length)return[];var e=arguments[0];return Pe(e)?e:[e]}function J1(e){return jr(e,J)}function W1(e,s){return s=typeof s=="function"?s:r,jr(e,J,s)}function Y1(e){return jr(e,T|J)}function Q1(e,s){return s=typeof s=="function"?s:r,jr(e,T|J,s)}function Z1(e,s){return s==null||yh(e,s,Kt(s))}function Yr(e,s){return e===s||e!==e&&s!==s}var X1=Bn(aa),eb=Bn(function(e,s){return e>=s}),Qi=Eh(function(){return arguments}())?Eh:function(e){return ft(e)&&Ve.call(e,"callee")&&!ch.call(e,"callee")},Pe=D.isArray,tb=Bu?Ir(Bu):uv;function gr(e){return e!=null&&Zn(e.length)&&!vi(e)}function mt(e){return ft(e)&&gr(e)}function rb(e){return e===!0||e===!1||ft(e)&&or(e)==Os}var Fi=ym||Va,ib=Hu?Ir(Hu):hv;function sb(e){return ft(e)&&e.nodeType===1&&!Ys(e)}function nb(e){if(e==null)return!0;if(gr(e)&&(Pe(e)||typeof e=="string"||typeof e.splice=="function"||Fi(e)||ws(e)||Qi(e)))return!e.length;var s=ir(e);if(s==Vr||s==Gr)return!e.size;if(Js(e))return!ha(e).length;for(var o in e)if(Ve.call(e,o))return!1;return!0}function ob(e,s){return Ks(e,s)}function ab(e,s,o){o=typeof o=="function"?o:r;var h=o?o(e,s):r;return h===r?Ks(e,s,r,o):!!h}function La(e){if(!ft(e))return!1;var s=or(e);return s==hn||s==A0||typeof e.message=="string"&&typeof e.name=="string"&&!Ys(e)}function cb(e){return typeof e=="number"&&hh(e)}function vi(e){if(!ot(e))return!1;var s=or(e);return s==ln||s==mu||s==O0||s==T0}function Al(e){return typeof e=="number"&&e==Ce(e)}function Zn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Er}function ot(e){var s=typeof e;return e!=null&&(s=="object"||s=="function")}function ft(e){return e!=null&&typeof e=="object"}var Dl=Ku?Ir(Ku):fv;function ub(e,s){return e===s||ua(e,s,Sa(s))}function hb(e,s,o){return o=typeof o=="function"?o:r,ua(e,s,Sa(s),o)}function lb(e){return Tl(e)&&e!=+e}function fb(e){if(Wv(e))throw new Ie(f);return xh(e)}function pb(e){return e===null}function db(e){return e==null}function Tl(e){return typeof e=="number"||ft(e)&&or(e)==Ds}function Ys(e){if(!ft(e)||or(e)!=li)return!1;var s=Pn(e);if(s===null)return!0;var o=Ve.call(s,"constructor")&&s.constructor;return typeof o=="function"&&o instanceof o&&_n.call(o)==hm}var Ma=Vu?Ir(Vu):pv;function gb(e){return Al(e)&&e>=-Er&&e<=Er}var Nl=Gu?Ir(Gu):dv;function Xn(e){return typeof e=="string"||!Pe(e)&&ft(e)&&or(e)==Ns}function Sr(e){return typeof e=="symbol"||ft(e)&&or(e)==fn}var ws=Ju?Ir(Ju):gv;function yb(e){return e===r}function mb(e){return ft(e)&&ir(e)==Fs}function vb(e){return ft(e)&&or(e)==F0}var wb=Bn(la),bb=Bn(function(e,s){return e<=s});function Fl(e){if(!e)return[];if(gr(e))return Xn(e)?Jr(e):dr(e);if(Ms&&e[Ms])return Zy(e[Ms]());var s=ir(e),o=s==Vr?Zo:s==Gr?vn:bs;return o(e)}function wi(e){if(!e)return e===0?e:0;if(e=Ur(e),e===ti||e===-ti){var s=e<0?-1:1;return s*ss}return e===e?e:0}function Ce(e){var s=wi(e),o=s%1;return s===s?o?s-o:s:0}function ql(e){return e?Gi(Ce(e),0,pr):0}function Ur(e){if(typeof e=="number")return e;if(Sr(e))return ri;if(ot(e)){var s=typeof e.valueOf=="function"?e.valueOf():e;e=ot(s)?s+"":s}if(typeof e!="string")return e===0?e:+e;e=eh(e);var o=ty.test(e);return o||iy.test(e)?qy(e.slice(2),o?2:8):ey.test(e)?ri:+e}function Ll(e){return ni(e,yr(e))}function _b(e){return e?Gi(Ce(e),-Er,Er):e===0?e:0}function He(e){return e==null?"":Pr(e)}var Eb=ys(function(e,s){if(Js(s)||gr(s)){ni(s,Kt(s),e);return}for(var o in s)Ve.call(s,o)&&Us(e,o,s[o])}),Ml=ys(function(e,s){ni(s,yr(s),e)}),eo=ys(function(e,s,o,h){ni(s,yr(s),e,h)}),xb=ys(function(e,s,o,h){ni(s,Kt(s),e,h)}),Ib=yi(sa);function Pb(e,s){var o=gs(e);return s==null?o:gh(o,s)}var Sb=De(function(e,s){e=Je(e);var o=-1,h=s.length,p=h>2?s[2]:r;for(p&&ar(s[0],s[1],p)&&(h=1);++o<h;)for(var m=s[o],v=yr(m),b=-1,S=v.length;++b<S;){var L=v[b],M=e[L];(M===r||Yr(M,fs[L])&&!Ve.call(e,L))&&(e[L]=m[L])}return e}),Rb=De(function(e){return e.push(r,el),xr(kl,r,e)});function Cb(e,s){return Yu(e,de(s,3),si)}function Ob(e,s){return Yu(e,de(s,3),oa)}function Ab(e,s){return e==null?e:na(e,de(s,3),yr)}function Db(e,s){return e==null?e:bh(e,de(s,3),yr)}function Tb(e,s){return e&&si(e,de(s,3))}function Nb(e,s){return e&&oa(e,de(s,3))}function Fb(e){return e==null?[]:qn(e,Kt(e))}function qb(e){return e==null?[]:qn(e,yr(e))}function ka(e,s,o){var h=e==null?r:Ji(e,s);return h===r?o:h}function Lb(e,s){return e!=null&&il(e,s,nv)}function ja(e,s){return e!=null&&il(e,s,ov)}var Mb=Wh(function(e,s,o){s!=null&&typeof s.toString!="function"&&(s=En.call(s)),e[s]=o},$a(mr)),kb=Wh(function(e,s,o){s!=null&&typeof s.toString!="function"&&(s=En.call(s)),Ve.call(e,s)?e[s].push(o):e[s]=[o]},de),jb=De(Hs);function Kt(e){return gr(e)?ph(e):ha(e)}function yr(e){return gr(e)?ph(e,!0):yv(e)}function zb(e,s){var o={};return s=de(s,3),si(e,function(h,p,m){di(o,s(h,p,m),h)}),o}function $b(e,s){var o={};return s=de(s,3),si(e,function(h,p,m){di(o,p,s(h,p,m))}),o}var Ub=ys(function(e,s,o){Ln(e,s,o)}),kl=ys(function(e,s,o,h){Ln(e,s,o,h)}),Bb=yi(function(e,s){var o={};if(e==null)return o;var h=!1;s=it(s,function(m){return m=Ti(m,e),h||(h=m.length>1),m}),ni(e,Ia(e),o),h&&(o=jr(o,T|k|J,Mv));for(var p=s.length;p--;)ya(o,s[p]);return o});function Hb(e,s){return jl(e,Qn(de(s)))}var Kb=yi(function(e,s){return e==null?{}:vv(e,s)});function jl(e,s){if(e==null)return{};var o=it(Ia(e),function(h){return[h]});return s=de(s),Ah(e,o,function(h,p){return s(h,p[0])})}function Vb(e,s,o){s=Ti(s,e);var h=-1,p=s.length;for(p||(p=1,e=r);++h<p;){var m=e==null?r:e[oi(s[h])];m===r&&(h=p,m=o),e=vi(m)?m.call(e):m}return e}function Gb(e,s,o){return e==null?e:Vs(e,s,o)}function Jb(e,s,o,h){return h=typeof h=="function"?h:r,e==null?e:Vs(e,s,o,h)}var zl=Zh(Kt),$l=Zh(yr);function Wb(e,s,o){var h=Pe(e),p=h||Fi(e)||ws(e);if(s=de(s,4),o==null){var m=e&&e.constructor;p?o=h?new m:[]:ot(e)?o=vi(m)?gs(Pn(e)):{}:o={}}return(p?Lr:si)(e,function(v,b,S){return s(o,v,b,S)}),o}function Yb(e,s){return e==null?!0:ya(e,s)}function Qb(e,s,o){return e==null?e:qh(e,s,wa(o))}function Zb(e,s,o,h){return h=typeof h=="function"?h:r,e==null?e:qh(e,s,wa(o),h)}function bs(e){return e==null?[]:Qo(e,Kt(e))}function Xb(e){return e==null?[]:Qo(e,yr(e))}function e_(e,s,o){return o===r&&(o=s,s=r),o!==r&&(o=Ur(o),o=o===o?o:0),s!==r&&(s=Ur(s),s=s===s?s:0),Gi(Ur(e),s,o)}function t_(e,s,o){return s=wi(s),o===r?(o=s,s=0):o=wi(o),e=Ur(e),av(e,s,o)}function r_(e,s,o){if(o&&typeof o!="boolean"&&ar(e,s,o)&&(s=o=r),o===r&&(typeof s=="boolean"?(o=s,s=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&s===r?(e=0,s=1):(e=wi(e),s===r?(s=e,e=0):s=wi(s)),e>s){var h=e;e=s,s=h}if(o||e%1||s%1){var p=lh();return rr(e+p*(s-e+Fy("1e-"+((p+"").length-1))),s)}return pa(e,s)}var i_=ms(function(e,s,o){return s=s.toLowerCase(),e+(o?Ul(s):s)});function Ul(e){return za(He(e).toLowerCase())}function Bl(e){return e=He(e),e&&e.replace(ny,Gy).replace(Iy,"")}function s_(e,s,o){e=He(e),s=Pr(s);var h=e.length;o=o===r?h:Gi(Ce(o),0,h);var p=o;return o-=s.length,o>=0&&e.slice(o,p)==s}function n_(e){return e=He(e),e&&j0.test(e)?e.replace(bu,Jy):e}function o_(e){return e=He(e),e&&K0.test(e)?e.replace(qo,"\\$&"):e}var a_=ms(function(e,s,o){return e+(o?"-":"")+s.toLowerCase()}),c_=ms(function(e,s,o){return e+(o?" ":"")+s.toLowerCase()}),u_=Vh("toLowerCase");function h_(e,s,o){e=He(e),s=Ce(s);var h=s?hs(e):0;if(!s||h>=s)return e;var p=(s-h)/2;return Un(On(p),o)+e+Un(Cn(p),o)}function l_(e,s,o){e=He(e),s=Ce(s);var h=s?hs(e):0;return s&&h<s?e+Un(s-h,o):e}function f_(e,s,o){e=He(e),s=Ce(s);var h=s?hs(e):0;return s&&h<s?Un(s-h,o)+e:e}function p_(e,s,o){return o||s==null?s=0:s&&(s=+s),bm(He(e).replace(Lo,""),s||0)}function d_(e,s,o){return(o?ar(e,s,o):s===r)?s=1:s=Ce(s),da(He(e),s)}function g_(){var e=arguments,s=He(e[0]);return e.length<3?s:s.replace(e[1],e[2])}var y_=ms(function(e,s,o){return e+(o?"_":"")+s.toLowerCase()});function m_(e,s,o){return o&&typeof o!="number"&&ar(e,s,o)&&(s=o=r),o=o===r?pr:o>>>0,o?(e=He(e),e&&(typeof s=="string"||s!=null&&!Ma(s))&&(s=Pr(s),!s&&us(e))?Ni(Jr(e),0,o):e.split(s,o)):[]}var v_=ms(function(e,s,o){return e+(o?" ":"")+za(s)});function w_(e,s,o){return e=He(e),o=o==null?0:Gi(Ce(o),0,e.length),s=Pr(s),e.slice(o,o+s.length)==s}function b_(e,s,o){var h=d.templateSettings;o&&ar(e,s,o)&&(s=r),e=He(e),s=eo({},s,h,Xh);var p=eo({},s.imports,h.imports,Xh),m=Kt(p),v=Qo(p,m),b,S,L=0,M=s.interpolate||pn,U="__p += '",X=Xo((s.escape||pn).source+"|"+M.source+"|"+(M===_u?X0:pn).source+"|"+(s.evaluate||pn).source+"|$","g"),ce="//# sourceURL="+(Ve.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Oy+"]")+`
`;e.replace(X,function(ye,Le,ke,Rr,cr,Cr){return ke||(ke=Rr),U+=e.slice(L,Cr).replace(oy,Wy),Le&&(b=!0,U+=`' +
__e(`+Le+`) +
'`),cr&&(S=!0,U+=`';
`+cr+`;
__p += '`),ke&&(U+=`' +
((__t = (`+ke+`)) == null ? '' : __t) +
'`),L=Cr+ye.length,ye}),U+=`';
`;var ge=Ve.call(s,"variable")&&s.variable;if(!ge)U=`with (obj) {
`+U+`
}
`;else if(Q0.test(ge))throw new Ie(w);U=(S?U.replace(q0,""):U).replace(L0,"$1").replace(M0,"$1;"),U="function("+(ge||"obj")+`) {
`+(ge?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(S?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var Oe=Kl(function(){return Be(m,ce+"return "+U).apply(r,v)});if(Oe.source=U,La(Oe))throw Oe;return Oe}function __(e){return He(e).toLowerCase()}function E_(e){return He(e).toUpperCase()}function x_(e,s,o){if(e=He(e),e&&(o||s===r))return eh(e);if(!e||!(s=Pr(s)))return e;var h=Jr(e),p=Jr(s),m=th(h,p),v=rh(h,p)+1;return Ni(h,m,v).join("")}function I_(e,s,o){if(e=He(e),e&&(o||s===r))return e.slice(0,sh(e)+1);if(!e||!(s=Pr(s)))return e;var h=Jr(e),p=rh(h,Jr(s))+1;return Ni(h,0,p).join("")}function P_(e,s,o){if(e=He(e),e&&(o||s===r))return e.replace(Lo,"");if(!e||!(s=Pr(s)))return e;var h=Jr(e),p=th(h,Jr(s));return Ni(h,p).join("")}function S_(e,s){var o=Ss,h=Pi;if(ot(s)){var p="separator"in s?s.separator:p;o="length"in s?Ce(s.length):o,h="omission"in s?Pr(s.omission):h}e=He(e);var m=e.length;if(us(e)){var v=Jr(e);m=v.length}if(o>=m)return e;var b=o-hs(h);if(b<1)return h;var S=v?Ni(v,0,b).join(""):e.slice(0,b);if(p===r)return S+h;if(v&&(b+=S.length-b),Ma(p)){if(e.slice(b).search(p)){var L,M=S;for(p.global||(p=Xo(p.source,He(Eu.exec(p))+"g")),p.lastIndex=0;L=p.exec(M);)var U=L.index;S=S.slice(0,U===r?b:U)}}else if(e.indexOf(Pr(p),b)!=b){var X=S.lastIndexOf(p);X>-1&&(S=S.slice(0,X))}return S+h}function R_(e){return e=He(e),e&&k0.test(e)?e.replace(wu,rm):e}var C_=ms(function(e,s,o){return e+(o?" ":"")+s.toUpperCase()}),za=Vh("toUpperCase");function Hl(e,s,o){return e=He(e),s=o?r:s,s===r?Qy(e)?nm(e):Uy(e):e.match(s)||[]}var Kl=De(function(e,s){try{return xr(e,r,s)}catch(o){return La(o)?o:new Ie(o)}}),O_=yi(function(e,s){return Lr(s,function(o){o=oi(o),di(e,o,Fa(e[o],e))}),e});function A_(e){var s=e==null?0:e.length,o=de();return e=s?it(e,function(h){if(typeof h[1]!="function")throw new Mr(g);return[o(h[0]),h[1]]}):[],De(function(h){for(var p=-1;++p<s;){var m=e[p];if(xr(m[0],this,h))return xr(m[1],this,h)}})}function D_(e){return rv(jr(e,T))}function $a(e){return function(){return e}}function T_(e,s){return e==null||e!==e?s:e}var N_=Jh(),F_=Jh(!0);function mr(e){return e}function Ua(e){return Ih(typeof e=="function"?e:jr(e,T))}function q_(e){return Sh(jr(e,T))}function L_(e,s){return Rh(e,jr(s,T))}var M_=De(function(e,s){return function(o){return Hs(o,e,s)}}),k_=De(function(e,s){return function(o){return Hs(e,o,s)}});function Ba(e,s,o){var h=Kt(s),p=qn(s,h);o==null&&!(ot(s)&&(p.length||!h.length))&&(o=s,s=e,e=this,p=qn(s,Kt(s)));var m=!(ot(o)&&"chain"in o)||!!o.chain,v=vi(e);return Lr(p,function(b){var S=s[b];e[b]=S,v&&(e.prototype[b]=function(){var L=this.__chain__;if(m||L){var M=e(this.__wrapped__),U=M.__actions__=dr(this.__actions__);return U.push({func:S,args:arguments,thisArg:e}),M.__chain__=L,M}return S.apply(e,Ri([this.value()],arguments))})}),e}function j_(){return Wt._===this&&(Wt._=lm),this}function Ha(){}function z_(e){return e=Ce(e),De(function(s){return Ch(s,e)})}var $_=_a(it),U_=_a(Wu),B_=_a(Vo);function Vl(e){return Ca(e)?Go(oi(e)):wv(e)}function H_(e){return function(s){return e==null?r:Ji(e,s)}}var K_=Yh(),V_=Yh(!0);function Ka(){return[]}function Va(){return!1}function G_(){return{}}function J_(){return""}function W_(){return!0}function Y_(e,s){if(e=Ce(e),e<1||e>Er)return[];var o=pr,h=rr(e,pr);s=de(s),e-=pr;for(var p=Yo(h,s);++o<e;)s(o);return p}function Q_(e){return Pe(e)?it(e,oi):Sr(e)?[e]:dr(fl(He(e)))}function Z_(e){var s=++um;return He(e)+s}var X_=$n(function(e,s){return e+s},0),eE=Ea("ceil"),tE=$n(function(e,s){return e/s},1),rE=Ea("floor");function iE(e){return e&&e.length?Fn(e,mr,aa):r}function sE(e,s){return e&&e.length?Fn(e,de(s,2),aa):r}function nE(e){return Zu(e,mr)}function oE(e,s){return Zu(e,de(s,2))}function aE(e){return e&&e.length?Fn(e,mr,la):r}function cE(e,s){return e&&e.length?Fn(e,de(s,2),la):r}var uE=$n(function(e,s){return e*s},1),hE=Ea("round"),lE=$n(function(e,s){return e-s},0);function fE(e){return e&&e.length?Wo(e,mr):0}function pE(e,s){return e&&e.length?Wo(e,de(s,2)):0}return d.after=q1,d.ary=xl,d.assign=Eb,d.assignIn=Ml,d.assignInWith=eo,d.assignWith=xb,d.at=Ib,d.before=Il,d.bind=Fa,d.bindAll=O_,d.bindKey=Pl,d.castArray=G1,d.chain=bl,d.chunk=rw,d.compact=iw,d.concat=sw,d.cond=A_,d.conforms=D_,d.constant=$a,d.countBy=f1,d.create=Pb,d.curry=Sl,d.curryRight=Rl,d.debounce=Cl,d.defaults=Sb,d.defaultsDeep=Rb,d.defer=L1,d.delay=M1,d.difference=nw,d.differenceBy=ow,d.differenceWith=aw,d.drop=cw,d.dropRight=uw,d.dropRightWhile=hw,d.dropWhile=lw,d.fill=fw,d.filter=d1,d.flatMap=m1,d.flatMapDeep=v1,d.flatMapDepth=w1,d.flatten=yl,d.flattenDeep=pw,d.flattenDepth=dw,d.flip=k1,d.flow=N_,d.flowRight=F_,d.fromPairs=gw,d.functions=Fb,d.functionsIn=qb,d.groupBy=b1,d.initial=mw,d.intersection=vw,d.intersectionBy=ww,d.intersectionWith=bw,d.invert=Mb,d.invertBy=kb,d.invokeMap=E1,d.iteratee=Ua,d.keyBy=x1,d.keys=Kt,d.keysIn=yr,d.map=Jn,d.mapKeys=zb,d.mapValues=$b,d.matches=q_,d.matchesProperty=L_,d.memoize=Yn,d.merge=Ub,d.mergeWith=kl,d.method=M_,d.methodOf=k_,d.mixin=Ba,d.negate=Qn,d.nthArg=z_,d.omit=Bb,d.omitBy=Hb,d.once=j1,d.orderBy=I1,d.over=$_,d.overArgs=z1,d.overEvery=U_,d.overSome=B_,d.partial=qa,d.partialRight=Ol,d.partition=P1,d.pick=Kb,d.pickBy=jl,d.property=Vl,d.propertyOf=H_,d.pull=Iw,d.pullAll=vl,d.pullAllBy=Pw,d.pullAllWith=Sw,d.pullAt=Rw,d.range=K_,d.rangeRight=V_,d.rearg=$1,d.reject=C1,d.remove=Cw,d.rest=U1,d.reverse=Ta,d.sampleSize=A1,d.set=Gb,d.setWith=Jb,d.shuffle=D1,d.slice=Ow,d.sortBy=F1,d.sortedUniq=Lw,d.sortedUniqBy=Mw,d.split=m_,d.spread=B1,d.tail=kw,d.take=jw,d.takeRight=zw,d.takeRightWhile=$w,d.takeWhile=Uw,d.tap=i1,d.throttle=H1,d.thru=Gn,d.toArray=Fl,d.toPairs=zl,d.toPairsIn=$l,d.toPath=Q_,d.toPlainObject=Ll,d.transform=Wb,d.unary=K1,d.union=Bw,d.unionBy=Hw,d.unionWith=Kw,d.uniq=Vw,d.uniqBy=Gw,d.uniqWith=Jw,d.unset=Yb,d.unzip=Na,d.unzipWith=wl,d.update=Qb,d.updateWith=Zb,d.values=bs,d.valuesIn=Xb,d.without=Ww,d.words=Hl,d.wrap=V1,d.xor=Yw,d.xorBy=Qw,d.xorWith=Zw,d.zip=Xw,d.zipObject=e1,d.zipObjectDeep=t1,d.zipWith=r1,d.entries=zl,d.entriesIn=$l,d.extend=Ml,d.extendWith=eo,Ba(d,d),d.add=X_,d.attempt=Kl,d.camelCase=i_,d.capitalize=Ul,d.ceil=eE,d.clamp=e_,d.clone=J1,d.cloneDeep=Y1,d.cloneDeepWith=Q1,d.cloneWith=W1,d.conformsTo=Z1,d.deburr=Bl,d.defaultTo=T_,d.divide=tE,d.endsWith=s_,d.eq=Yr,d.escape=n_,d.escapeRegExp=o_,d.every=p1,d.find=g1,d.findIndex=dl,d.findKey=Cb,d.findLast=y1,d.findLastIndex=gl,d.findLastKey=Ob,d.floor=rE,d.forEach=_l,d.forEachRight=El,d.forIn=Ab,d.forInRight=Db,d.forOwn=Tb,d.forOwnRight=Nb,d.get=ka,d.gt=X1,d.gte=eb,d.has=Lb,d.hasIn=ja,d.head=ml,d.identity=mr,d.includes=_1,d.indexOf=yw,d.inRange=t_,d.invoke=jb,d.isArguments=Qi,d.isArray=Pe,d.isArrayBuffer=tb,d.isArrayLike=gr,d.isArrayLikeObject=mt,d.isBoolean=rb,d.isBuffer=Fi,d.isDate=ib,d.isElement=sb,d.isEmpty=nb,d.isEqual=ob,d.isEqualWith=ab,d.isError=La,d.isFinite=cb,d.isFunction=vi,d.isInteger=Al,d.isLength=Zn,d.isMap=Dl,d.isMatch=ub,d.isMatchWith=hb,d.isNaN=lb,d.isNative=fb,d.isNil=db,d.isNull=pb,d.isNumber=Tl,d.isObject=ot,d.isObjectLike=ft,d.isPlainObject=Ys,d.isRegExp=Ma,d.isSafeInteger=gb,d.isSet=Nl,d.isString=Xn,d.isSymbol=Sr,d.isTypedArray=ws,d.isUndefined=yb,d.isWeakMap=mb,d.isWeakSet=vb,d.join=_w,d.kebabCase=a_,d.last=$r,d.lastIndexOf=Ew,d.lowerCase=c_,d.lowerFirst=u_,d.lt=wb,d.lte=bb,d.max=iE,d.maxBy=sE,d.mean=nE,d.meanBy=oE,d.min=aE,d.minBy=cE,d.stubArray=Ka,d.stubFalse=Va,d.stubObject=G_,d.stubString=J_,d.stubTrue=W_,d.multiply=uE,d.nth=xw,d.noConflict=j_,d.noop=Ha,d.now=Wn,d.pad=h_,d.padEnd=l_,d.padStart=f_,d.parseInt=p_,d.random=r_,d.reduce=S1,d.reduceRight=R1,d.repeat=d_,d.replace=g_,d.result=Vb,d.round=hE,d.runInContext=I,d.sample=O1,d.size=T1,d.snakeCase=y_,d.some=N1,d.sortedIndex=Aw,d.sortedIndexBy=Dw,d.sortedIndexOf=Tw,d.sortedLastIndex=Nw,d.sortedLastIndexBy=Fw,d.sortedLastIndexOf=qw,d.startCase=v_,d.startsWith=w_,d.subtract=lE,d.sum=fE,d.sumBy=pE,d.template=b_,d.times=Y_,d.toFinite=wi,d.toInteger=Ce,d.toLength=ql,d.toLower=__,d.toNumber=Ur,d.toSafeInteger=_b,d.toString=He,d.toUpper=E_,d.trim=x_,d.trimEnd=I_,d.trimStart=P_,d.truncate=S_,d.unescape=R_,d.uniqueId=Z_,d.upperCase=C_,d.upperFirst=za,d.each=_l,d.eachRight=El,d.first=ml,Ba(d,function(){var e={};return si(d,function(s,o){Ve.call(d.prototype,o)||(e[o]=s)}),e}(),{chain:!1}),d.VERSION=n,Lr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),Lr(["drop","take"],function(e,s){Me.prototype[e]=function(o){o=o===r?1:Dt(Ce(o),0);var h=this.__filtered__&&!s?new Me(this):this.clone();return h.__filtered__?h.__takeCount__=rr(o,h.__takeCount__):h.__views__.push({size:rr(o,pr),type:e+(h.__dir__<0?"Right":"")}),h},Me.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Lr(["filter","map","takeWhile"],function(e,s){var o=s+1,h=o==Ht||o==Rs;Me.prototype[e]=function(p){var m=this.clone();return m.__iteratees__.push({iteratee:de(p,3),type:o}),m.__filtered__=m.__filtered__||h,m}}),Lr(["head","last"],function(e,s){var o="take"+(s?"Right":"");Me.prototype[e]=function(){return this[o](1).value()[0]}}),Lr(["initial","tail"],function(e,s){var o="drop"+(s?"":"Right");Me.prototype[e]=function(){return this.__filtered__?new Me(this):this[o](1)}}),Me.prototype.compact=function(){return this.filter(mr)},Me.prototype.find=function(e){return this.filter(e).head()},Me.prototype.findLast=function(e){return this.reverse().find(e)},Me.prototype.invokeMap=De(function(e,s){return typeof e=="function"?new Me(this):this.map(function(o){return Hs(o,e,s)})}),Me.prototype.reject=function(e){return this.filter(Qn(de(e)))},Me.prototype.slice=function(e,s){e=Ce(e);var o=this;return o.__filtered__&&(e>0||s<0)?new Me(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),s!==r&&(s=Ce(s),o=s<0?o.dropRight(-s):o.take(s-e)),o)},Me.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Me.prototype.toArray=function(){return this.take(pr)},si(Me.prototype,function(e,s){var o=/^(?:filter|find|map|reject)|While$/.test(s),h=/^(?:head|last)$/.test(s),p=d[h?"take"+(s=="last"?"Right":""):s],m=h||/^find/.test(s);p&&(d.prototype[s]=function(){var v=this.__wrapped__,b=h?[1]:arguments,S=v instanceof Me,L=b[0],M=S||Pe(v),U=function(Le){var ke=p.apply(d,Ri([Le],b));return h&&X?ke[0]:ke};M&&o&&typeof L=="function"&&L.length!=1&&(S=M=!1);var X=this.__chain__,ce=!!this.__actions__.length,ge=m&&!X,Oe=S&&!ce;if(!m&&M){v=Oe?v:new Me(this);var ye=e.apply(v,b);return ye.__actions__.push({func:Gn,args:[U],thisArg:r}),new kr(ye,X)}return ge&&Oe?e.apply(this,b):(ye=this.thru(U),ge?h?ye.value()[0]:ye.value():ye)})}),Lr(["pop","push","shift","sort","splice","unshift"],function(e){var s=wn[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",h=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var p=arguments;if(h&&!this.__chain__){var m=this.value();return s.apply(Pe(m)?m:[],p)}return this[o](function(v){return s.apply(Pe(v)?v:[],p)})}}),si(Me.prototype,function(e,s){var o=d[s];if(o){var h=o.name+"";Ve.call(ds,h)||(ds[h]=[]),ds[h].push({name:s,func:o})}}),ds[zn(r,be).name]=[{name:"wrapper",func:r}],Me.prototype.clone=Rm,Me.prototype.reverse=Cm,Me.prototype.value=Om,d.prototype.at=s1,d.prototype.chain=n1,d.prototype.commit=o1,d.prototype.next=a1,d.prototype.plant=u1,d.prototype.reverse=h1,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=l1,d.prototype.first=d.prototype.head,Ms&&(d.prototype[Ms]=c1),d},ls=om();Bi?((Bi.exports=ls)._=ls,Uo._=ls):Wt._=ls}).call(Ps)})(bo,bo.exports);var a0=Object.defineProperty,c0=Object.defineProperties,u0=Object.getOwnPropertyDescriptors,uu=Object.getOwnPropertySymbols,h0=Object.prototype.hasOwnProperty,l0=Object.prototype.propertyIsEnumerable,hu=(u,t,r)=>t in u?a0(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,on=(u,t)=>{for(var r in t||(t={}))h0.call(t,r)&&hu(u,r,t[r]);if(uu)for(var r of uu(t))l0.call(t,r)&&hu(u,r,t[r]);return u},f0=(u,t)=>c0(u,u0(t));function Ii(u,t,r){var n;const a=(0,y.DQe)(u);return((n=t.rpcMap)==null?void 0:n[a.reference])||`${o0}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function zi(u){return u.includes(":")?u.split(":")[1]:u}function lu(u){return u.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function p0(u,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(u));if(!r.length)return[];const n=[];return r.forEach(a=>{const f=t.namespaces[a].accounts;n.push(...f)}),n}function _o(u={},t={}){const r=fu(u),n=fu(t);return bo.exports.merge(r,n)}function fu(u){var t,r,n,a;const f={};if(!(0,y.L5o)(u))return f;for(const[g,w]of Object.entries(u)){const C=(0,y.gpE)(g)?[g]:w.chains,_=w.methods||[],A=w.events||[],T=w.rpcMap||{},k=(0,y.Maj)(g);f[k]=f0(on(on({},f[k]),w),{chains:(0,y.eGA)(C,(t=f[k])==null?void 0:t.chains),methods:(0,y.eGA)(_,(r=f[k])==null?void 0:r.methods),events:(0,y.eGA)(A,(n=f[k])==null?void 0:n.events),rpcMap:on(on({},T),(a=f[k])==null?void 0:a.rpcMap)})}return f}function d0(u){return u.includes(":")?u.split(":")[2]:u}function pu(u){const t={};for(const[r,n]of Object.entries(u)){const a=n.methods||[],f=n.events||[],g=n.accounts||[],w=(0,y.gpE)(r)?[r]:n.chains?n.chains:lu(n.accounts);t[r]={chains:w,methods:a,events:f,accounts:g}}return t}function Eo(u){return typeof u=="number"?u:u.includes("0x")?parseInt(u,16):(u=u.includes(":")?u.split(":")[1]:u,isNaN(Number(u))?u:Number(u))}const du={},tt=u=>du[u],xo=(u,t)=>{du[u]=t};class g0{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=zi(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ii(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new xi(n,tt("disableProviderPing")))}}class y0{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||Ii(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new xi(n,tt("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=parseInt(zi(r));t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const f=parseInt(a,16);if(this.isChainApproved(f))this.setDefaultChain(`${f}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${f}`);else throw new Error(`Failed to switch to chain 'eip155:${f}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class m0{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=zi(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ii(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new xi(n,tt("disableProviderPing")))}}class v0{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=zi(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ii(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new xi(n,tt("disableProviderPing")))}}class w0{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),a=zi(r);t[a]=this.createHttpProvider(a,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new xi(n,tt("disableProviderPing")))}}class b0{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=zi(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ii(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new xi(n,tt("disableProviderPing")))}}class _0{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=zi(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ii(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new xi(n,tt("disableProviderPing")))}}class E0{constructor(t){this.name="near",this.namespace=t.namespace,this.events=tt("events"),this.client=tt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||Ii(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ii(t,this.namespace);return typeof n>"u"?void 0:new ci(new xi(n,tt("disableProviderPing")))}}var x0=Object.defineProperty,I0=Object.defineProperties,P0=Object.getOwnPropertyDescriptors,gu=Object.getOwnPropertySymbols,S0=Object.prototype.hasOwnProperty,R0=Object.prototype.propertyIsEnumerable,yu=(u,t,r)=>t in u?x0(u,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[t]=r,an=(u,t)=>{for(var r in t||(t={}))S0.call(t,r)&&yu(u,r,t[r]);if(gu)for(var r of gu(t))R0.call(t,r)&&yu(u,r,t[r]);return u},Io=(u,t)=>I0(u,P0(t));class cn{constructor(t){this.events=new(me()),this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Hr()(yt({level:(t==null?void 0:t.logger)||au})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new cn(t);return await r.initialize(),r}async request(t,r,n){const[a,f]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(a).request({request:an({},t),chainId:`${a}:${f}`,topic:this.session.topic,expiry:n})}sendAsync(t,r,n,a){const f=new Date().getTime();this.request(t,n,a).then(g=>r(null,Xs(f,g))).catch(g=>r(g,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:(0,y.D6H)("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}async authenticate(t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(t),await this.cleanupPendingPairings();const{uri:r,response:n}=await this.client.authenticate(t);r&&(this.uri=r,this.events.emit("display_uri",r));const a=await n();if(this.session=a.session,this.session){const f=pu(this.session.namespaces);this.namespaces=_o(this.namespaces,f),this.persist("namespaces",this.namespaces),this.onConnect()}return a}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(f=>{this.session=f;const g=pu(f.namespaces);this.namespaces=_o(this.namespaces,g),this.persist("namespaces",this.namespaces)}).catch(f=>{if(f.message!==Qc)throw f;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,a]=this.validateChain(t);this.getProvider(n).setDefaultChain(a,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if((0,y.qt8)(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await wo.init({logger:this.providerOpts.logger||au,relayUrl:this.providerOpts.relayUrl||i0,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>(0,y.Maj)(r)))];xo("client",this.client),xo("events",this.events),xo("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=p0(r,this.session),a=lu(n),f=_o(this.namespaces,this.optionalNamespaces),g=Io(an({},f[r]),{accounts:n,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new y0({namespace:g});break;case"solana":this.rpcProviders[r]=new m0({namespace:g});break;case"cosmos":this.rpcProviders[r]=new v0({namespace:g});break;case"polkadot":this.rpcProviders[r]=new g0({namespace:g});break;case"cip34":this.rpcProviders[r]=new w0({namespace:g});break;case"elrond":this.rpcProviders[r]=new b0({namespace:g});break;case"multiversx":this.rpcProviders[r]=new _0({namespace:g});break;case"near":this.rpcProviders[r]=new E0({namespace:g});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const a=n.data;a&&(0,y.qt8)(a)&&this.events.emit("accountsChanged",a.map(d0))}else if(n.name==="chainChanged"){const a=r.chainId,f=r.event.data,g=(0,y.Maj)(a),w=Eo(a)!==Eo(f)?`${g}:${Eo(f)}`:a;this.onChainChanged(w)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:a}=r,f=(n=this.client)==null?void 0:n.session.get(t);this.session=Io(an({},f),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Io(an({},(0,y.D6H)("USER_DISCONNECTED")),{data:t.topic}))}),this.on(hi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(g=>(0,y.Maj)(g)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const a=(0,y.Maj)(Object.keys(this.namespaces)[0]),f=this.rpcProviders[a].getDefaultChain();return[a,f]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){if(!this.namespaces)return;const[n,a]=this.validateChain(t);a&&(r||this.getProvider(n).setDefaultChain(a),this.namespaces[n]?this.namespaces[n].defaultChain=a:this.namespaces[`${n}:${a}`]?this.namespaces[`${n}:${a}`].defaultChain=a:this.namespaces[`${n}:${a}`]={defaultChain:a},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",a))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${cu}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${cu}/${t}`)}}const C0=cn},52830:function(Qt,ne){var ie=typeof self<"u"?self:this,Q=function(){function Ee(){this.fetch=!1,this.DOMException=ie.DOMException}return Ee.prototype=ie,new Ee}();(function(Ee){var pt=function(H){var _e={searchParams:"URLSearchParams"in Ee,iterable:"Symbol"in Ee&&"iterator"in Symbol,blob:"FileReader"in Ee&&"Blob"in Ee&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Ee,arrayBuffer:"ArrayBuffer"in Ee};function Ne(R){return R&&DataView.prototype.isPrototypeOf(R)}if(_e.arrayBuffer)var ae=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],oe=ArrayBuffer.isView||function(R){return R&&ae.indexOf(Object.prototype.toString.call(R))>-1};function te(R){if(typeof R!="string"&&(R=String(R)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(R))throw new TypeError("Invalid character in header field name");return R.toLowerCase()}function je(R){return typeof R!="string"&&(R=String(R)),R}function se(R){var x={next:function(){var P=R.shift();return{done:P===void 0,value:P}}};return _e.iterable&&(x[Symbol.iterator]=function(){return x}),x}function xe(R){this.map={},R instanceof xe?R.forEach(function(x,P){this.append(P,x)},this):Array.isArray(R)?R.forEach(function(x){this.append(x[0],x[1])},this):R&&Object.getOwnPropertyNames(R).forEach(function(x){this.append(x,R[x])},this)}xe.prototype.append=function(R,x){R=te(R),x=je(x);var P=this.map[R];this.map[R]=P?P+", "+x:x},xe.prototype.delete=function(R){delete this.map[te(R)]},xe.prototype.get=function(R){return R=te(R),this.has(R)?this.map[R]:null},xe.prototype.has=function(R){return this.map.hasOwnProperty(te(R))},xe.prototype.set=function(R,x){this.map[te(R)]=je(x)},xe.prototype.forEach=function(R,x){for(var P in this.map)this.map.hasOwnProperty(P)&&R.call(x,this.map[P],P,this)},xe.prototype.keys=function(){var R=[];return this.forEach(function(x,P){R.push(P)}),se(R)},xe.prototype.values=function(){var R=[];return this.forEach(function(x){R.push(x)}),se(R)},xe.prototype.entries=function(){var R=[];return this.forEach(function(x,P){R.push([P,x])}),se(R)},_e.iterable&&(xe.prototype[Symbol.iterator]=xe.prototype.entries);function ee(R){if(R.bodyUsed)return Promise.reject(new TypeError("Already read"));R.bodyUsed=!0}function We(R){return new Promise(function(x,P){R.onload=function(){x(R.result)},R.onerror=function(){P(R.error)}})}function Tt(R){var x=new FileReader,P=We(x);return x.readAsArrayBuffer(R),P}function at(R){var x=new FileReader,P=We(x);return x.readAsText(R),P}function ct(R){for(var x=new Uint8Array(R),P=new Array(x.length),le=0;le<x.length;le++)P[le]=String.fromCharCode(x[le]);return P.join("")}function Zt(R){if(R.slice)return R.slice(0);var x=new Uint8Array(R.byteLength);return x.set(new Uint8Array(R)),x.buffer}function sr(){return this.bodyUsed=!1,this._initBody=function(R){this._bodyInit=R,R?typeof R=="string"?this._bodyText=R:_e.blob&&Blob.prototype.isPrototypeOf(R)?this._bodyBlob=R:_e.formData&&FormData.prototype.isPrototypeOf(R)?this._bodyFormData=R:_e.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)?this._bodyText=R.toString():_e.arrayBuffer&&_e.blob&&Ne(R)?(this._bodyArrayBuffer=Zt(R.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):_e.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(R)||oe(R))?this._bodyArrayBuffer=Zt(R):this._bodyText=R=Object.prototype.toString.call(R):this._bodyText="",this.headers.get("content-type")||(typeof R=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):_e.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},_e.blob&&(this.blob=function(){var R=ee(this);if(R)return R;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?ee(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Tt)}),this.text=function(){var R=ee(this);if(R)return R;if(this._bodyBlob)return at(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ct(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},_e.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var Or=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Ae(R){var x=R.toUpperCase();return Or.indexOf(x)>-1?x:R}function j(R,x){x=x||{};var P=x.body;if(R instanceof j){if(R.bodyUsed)throw new TypeError("Already read");this.url=R.url,this.credentials=R.credentials,x.headers||(this.headers=new xe(R.headers)),this.method=R.method,this.mode=R.mode,this.signal=R.signal,!P&&R._bodyInit!=null&&(P=R._bodyInit,R.bodyUsed=!0)}else this.url=String(R);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new xe(x.headers)),this.method=Ae(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(P)}j.prototype.clone=function(){return new j(this,{body:this._bodyInit})};function V(R){var x=new FormData;return R.trim().split("&").forEach(function(P){if(P){var le=P.split("="),Re=le.shift().replace(/\+/g," "),z=le.join("=").replace(/\+/g," ");x.append(decodeURIComponent(Re),decodeURIComponent(z))}}),x}function he(R){var x=new xe,P=R.replace(/\r?\n[\t ]+/g," ");return P.split(/\r?\n/).forEach(function(le){var Re=le.split(":"),z=Re.shift().trim();if(z){var Y=Re.join(":").trim();x.append(z,Y)}}),x}sr.call(j.prototype);function pe(R,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new xe(x.headers),this.url=x.url||"",this._initBody(R)}sr.call(pe.prototype),pe.prototype.clone=function(){return new pe(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new xe(this.headers),url:this.url})},pe.error=function(){var R=new pe(null,{status:0,statusText:""});return R.type="error",R};var we=[301,302,303,307,308];pe.redirect=function(R,x){if(we.indexOf(x)===-1)throw new RangeError("Invalid status code");return new pe(null,{status:x,headers:{location:R}})},H.DOMException=Ee.DOMException;try{new H.DOMException}catch{H.DOMException=function(x,P){this.message=x,this.name=P;var le=Error(x);this.stack=le.stack},H.DOMException.prototype=Object.create(Error.prototype),H.DOMException.prototype.constructor=H.DOMException}function Te(R,x){return new Promise(function(P,le){var Re=new j(R,x);if(Re.signal&&Re.signal.aborted)return le(new H.DOMException("Aborted","AbortError"));var z=new XMLHttpRequest;function Y(){z.abort()}z.onload=function(){var G={status:z.status,statusText:z.statusText,headers:he(z.getAllResponseHeaders()||"")};G.url="responseURL"in z?z.responseURL:G.headers.get("X-Request-URL");var K="response"in z?z.response:z.responseText;P(new pe(K,G))},z.onerror=function(){le(new TypeError("Network request failed"))},z.ontimeout=function(){le(new TypeError("Network request failed"))},z.onabort=function(){le(new H.DOMException("Aborted","AbortError"))},z.open(Re.method,Re.url,!0),Re.credentials==="include"?z.withCredentials=!0:Re.credentials==="omit"&&(z.withCredentials=!1),"responseType"in z&&_e.blob&&(z.responseType="blob"),Re.headers.forEach(function(G,K){z.setRequestHeader(K,G)}),Re.signal&&(Re.signal.addEventListener("abort",Y),z.onreadystatechange=function(){z.readyState===4&&Re.signal.removeEventListener("abort",Y)}),z.send(typeof Re._bodyInit>"u"?null:Re._bodyInit)})}return Te.polyfill=!0,Ee.fetch||(Ee.fetch=Te,Ee.Headers=xe,Ee.Request=j,Ee.Response=pe),H.Headers=xe,H.Request=j,H.Response=pe,H.fetch=Te,Object.defineProperty(H,"__esModule",{value:!0}),H}({})})(Q),Q.fetch.ponyfill=!0,delete Q.fetch.polyfill;var me=Q;ne=me.fetch,ne.default=me.fetch,ne.fetch=me.fetch,ne.Headers=me.Headers,ne.Request=me.Request,ne.Response=me.Response,Qt.exports=ne},51538:function(Qt,ne,ie){Qt.exports=self.fetch||(self.fetch=ie(9868).default||ie(9868))},57828:function(Qt){"use strict";function ne(Q){try{return JSON.stringify(Q)}catch{return'"[Circular]"'}}Qt.exports=ie;function ie(Q,me,Ee){var pt=Ee&&Ee.stringify||ne,H=1;if(typeof Q=="object"&&Q!==null){var _e=me.length+H;if(_e===1)return Q;var Ne=new Array(_e);Ne[0]=pt(Q);for(var ae=1;ae<_e;ae++)Ne[ae]=pt(me[ae]);return Ne.join(" ")}if(typeof Q!="string")return Q;var oe=me.length;if(oe===0)return Q;for(var te="",je=1-H,se=-1,xe=Q&&Q.length||0,ee=0;ee<xe;){if(Q.charCodeAt(ee)===37&&ee+1<xe){switch(se=se>-1?se:0,Q.charCodeAt(ee+1)){case 100:case 102:if(je>=oe||me[je]==null)break;se<ee&&(te+=Q.slice(se,ee)),te+=Number(me[je]),se=ee+2,ee++;break;case 105:if(je>=oe||me[je]==null)break;se<ee&&(te+=Q.slice(se,ee)),te+=Math.floor(Number(me[je])),se=ee+2,ee++;break;case 79:case 111:case 106:if(je>=oe||me[je]===void 0)break;se<ee&&(te+=Q.slice(se,ee));var We=typeof me[je];if(We==="string"){te+="'"+me[je]+"'",se=ee+2,ee++;break}if(We==="function"){te+=me[je].name||"<anonymous>",se=ee+2,ee++;break}te+=pt(me[je]),se=ee+2,ee++;break;case 115:if(je>=oe)break;se<ee&&(te+=Q.slice(se,ee)),te+=String(me[je]),se=ee+2,ee++;break;case 37:se<ee&&(te+=Q.slice(se,ee)),te+="%",se=ee+2,ee++,je--;break}++je}++ee}return se===-1?Q:(se<xe&&(te+=Q.slice(se)),te)}},9868:function(Qt,ne,ie){"use strict";ie.r(ne),ie.d(ne,{default:function(){return Q}});function Q(me,Ee){return Ee=Ee||{},new Promise(function(pt,H){var _e=new XMLHttpRequest,Ne=[],ae=[],oe={},te=function(){return{ok:(_e.status/100|0)==2,statusText:_e.statusText,status:_e.status,url:_e.responseURL,text:function(){return Promise.resolve(_e.responseText)},json:function(){return Promise.resolve(_e.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([_e.response]))},clone:te,headers:{keys:function(){return Ne},entries:function(){return ae},get:function(se){return oe[se.toLowerCase()]},has:function(se){return se.toLowerCase()in oe}}}};for(var je in _e.open(Ee.method||"get",me,!0),_e.onload=function(){_e.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(se,xe,ee){Ne.push(xe=xe.toLowerCase()),ae.push([xe,ee]),oe[xe]=oe[xe]?oe[xe]+","+ee:ee}),pt(te())},_e.onerror=H,_e.withCredentials=Ee.credentials=="include",Ee.headers)_e.setRequestHeader(je,Ee.headers[je]);_e.send(Ee.body||null)})}},85783:function(Qt){"use strict";Qt.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},86984:function(Qt,ne,ie){"use strict";const Q=ie(57828);Qt.exports=H;const me=Ae().console||{},Ee={mapHttpRequest:We,mapHttpResponse:We,wrapRequestSerializer:Tt,wrapResponseSerializer:Tt,wrapErrorSerializer:Tt,req:We,res:We,err:xe};function pt(j,V){return Array.isArray(j)?j.filter(function(pe){return pe!=="!stdSerializers.err"}):j===!0?Object.keys(V):!1}function H(j){j=j||{},j.browser=j.browser||{};const V=j.browser.transmit;if(V&&typeof V.send!="function")throw Error("pino: transmit option must have a send function");const he=j.browser.write||me;j.browser.write&&(j.browser.asObject=!0);const pe=j.serializers||{},we=pt(j.browser.serialize,pe);let Te=j.browser.serialize;Array.isArray(j.browser.serialize)&&j.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Te=!1);const R=["error","fatal","warn","info","debug","trace"];typeof he=="function"&&(he.error=he.fatal=he.warn=he.info=he.debug=he.trace=he),j.enabled===!1&&(j.level="silent");const x=j.level||"info",P=Object.create(he);P.log||(P.log=at),Object.defineProperty(P,"levelVal",{get:Re}),Object.defineProperty(P,"level",{get:z,set:Y});const le={transmit:V,serialize:we,asObject:j.browser.asObject,levels:R,timestamp:ee(j)};P.levels=H.levels,P.level=x,P.setMaxListeners=P.getMaxListeners=P.emit=P.addListener=P.on=P.prependListener=P.once=P.prependOnceListener=P.removeListener=P.removeAllListeners=P.listeners=P.listenerCount=P.eventNames=P.write=P.flush=at,P.serializers=pe,P._serialize=we,P._stdErrSerialize=Te,P.child=G,V&&(P._logEvent=se());function Re(){return this.level==="silent"?1/0:this.levels.values[this.level]}function z(){return this._level}function Y(K){if(K!=="silent"&&!this.levels.values[K])throw Error("unknown level "+K);this._level=K,_e(le,P,"error","log"),_e(le,P,"fatal","error"),_e(le,P,"warn","error"),_e(le,P,"info","log"),_e(le,P,"debug","log"),_e(le,P,"trace","log")}function G(K,Qe){if(!K)throw new Error("missing bindings for child Pino");Qe=Qe||{},we&&K.serializers&&(Qe.serializers=K.serializers);const ut=Qe.serializers;if(we&&ut){var Zr=Object.assign({},pe,ut),qi=j.browser.serialize===!0?Object.keys(Zr):we;delete K.serializers,oe([K],qi,Zr,this._stdErrSerialize)}function Li(Xt){this._childLevel=(Xt._childLevel|0)+1,this.error=te(Xt,K,"error"),this.fatal=te(Xt,K,"fatal"),this.warn=te(Xt,K,"warn"),this.info=te(Xt,K,"info"),this.debug=te(Xt,K,"debug"),this.trace=te(Xt,K,"trace"),Zr&&(this.serializers=Zr,this._serialize=qi),V&&(this._logEvent=se([].concat(Xt._logEvent.bindings,K)))}return Li.prototype=this,new Li(this)}return P}H.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},H.stdSerializers=Ee,H.stdTimeFunctions=Object.assign({},{nullTime:ct,epochTime:Zt,unixTime:sr,isoTime:Or});function _e(j,V,he,pe){const we=Object.getPrototypeOf(V);V[he]=V.levelVal>V.levels.values[he]?at:we[he]?we[he]:me[he]||me[pe]||at,Ne(j,V,he)}function Ne(j,V,he){!j.transmit&&V[he]===at||(V[he]=function(pe){return function(){const Te=j.timestamp(),R=new Array(arguments.length),x=Object.getPrototypeOf&&Object.getPrototypeOf(this)===me?me:this;for(var P=0;P<R.length;P++)R[P]=arguments[P];if(j.serialize&&!j.asObject&&oe(R,this._serialize,this.serializers,this._stdErrSerialize),j.asObject?pe.call(x,ae(this,he,R,Te)):pe.apply(x,R),j.transmit){const le=j.transmit.level||V.level,Re=H.levels.values[le],z=H.levels.values[he];if(z<Re)return;je(this,{ts:Te,methodLevel:he,methodValue:z,transmitLevel:le,transmitValue:H.levels.values[j.transmit.level||V.level],send:j.transmit.send,val:V.levelVal},R)}}}(V[he]))}function ae(j,V,he,pe){j._serialize&&oe(he,j._serialize,j.serializers,j._stdErrSerialize);const we=he.slice();let Te=we[0];const R={};pe&&(R.time=pe),R.level=H.levels.values[V];let x=(j._childLevel|0)+1;if(x<1&&(x=1),Te!==null&&typeof Te=="object"){for(;x--&&typeof we[0]=="object";)Object.assign(R,we.shift());Te=we.length?Q(we.shift(),we):void 0}else typeof Te=="string"&&(Te=Q(we.shift(),we));return Te!==void 0&&(R.msg=Te),R}function oe(j,V,he,pe){for(const we in j)if(pe&&j[we]instanceof Error)j[we]=H.stdSerializers.err(j[we]);else if(typeof j[we]=="object"&&!Array.isArray(j[we]))for(const Te in j[we])V&&V.indexOf(Te)>-1&&Te in he&&(j[we][Te]=he[Te](j[we][Te]))}function te(j,V,he){return function(){const pe=new Array(1+arguments.length);pe[0]=V;for(var we=1;we<pe.length;we++)pe[we]=arguments[we-1];return j[he].apply(this,pe)}}function je(j,V,he){const pe=V.send,we=V.ts,Te=V.methodLevel,R=V.methodValue,x=V.val,P=j._logEvent.bindings;oe(he,j._serialize||Object.keys(j.serializers),j.serializers,j._stdErrSerialize===void 0?!0:j._stdErrSerialize),j._logEvent.ts=we,j._logEvent.messages=he.filter(function(le){return P.indexOf(le)===-1}),j._logEvent.level.label=Te,j._logEvent.level.value=R,pe(Te,j._logEvent,x),j._logEvent=se(P)}function se(j){return{ts:0,messages:[],bindings:j||[],level:{label:"",value:0}}}function xe(j){const V={type:j.constructor.name,msg:j.message,stack:j.stack};for(const he in j)V[he]===void 0&&(V[he]=j[he]);return V}function ee(j){return typeof j.timestamp=="function"?j.timestamp:j.timestamp===!1?ct:Zt}function We(){return{}}function Tt(j){return j}function at(){}function ct(){return!1}function Zt(){return Date.now()}function sr(){return Math.round(Date.now()/1e3)}function Or(){return new Date(Date.now()).toISOString()}function Ae(){function j(V){return typeof V<"u"&&V}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return j(self)||j(window)||j(this)||{}}}}}]);
